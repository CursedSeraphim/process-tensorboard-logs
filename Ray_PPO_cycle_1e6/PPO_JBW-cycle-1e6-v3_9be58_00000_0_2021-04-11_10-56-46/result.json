{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 4000, "timers": {"sample_time_ms": 12322.803, "sample_throughput": 324.601, "learn_time_ms": 12824.047, "learn_throughput": 311.914, "update_time_ms": 3.317}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.0438244473189116, "policy_loss": -0.04650052991928533, "vf_loss": 1.0878858156502247, "vf_explained_var": 0.20249471068382263, "kl": 0.01219577927258797, "entropy": 1.0857578292489052, "entropy_coeff": 0.0}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-57-39", "timestamp": 1618138659, "time_this_iter_s": 25.156525135040283, "time_total_s": 25.156525135040283, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3373e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33a9050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.156525135040283, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.17777777777778, "ram_util_percent": 26.99722222222222}, "trial_id": "9be58_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 8000, "timers": {"sample_time_ms": 10159.22, "sample_throughput": 393.731, "learn_time_ms": 12755.284, "learn_throughput": 313.596, "update_time_ms": 3.471}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 1.063835283741355, "policy_loss": -0.05362264165887609, "vf_loss": 1.1138133965432644, "vf_explained_var": 0.3356572985649109, "kl": 0.01822261171764694, "entropy": 1.0654070861637592, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-58-00", "timestamp": 1618138680, "time_this_iter_s": 20.69073987007141, "time_total_s": 45.847265005111694, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3ddd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.847265005111694, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 58.72000000000001, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 83.0, "episode_reward_min": 83.0, "episode_reward_mean": 83.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6395297570582599, "mean_raw_obs_processing_ms": 0.07885120856882125, "mean_inference_ms": 1.6754884618926509, "mean_action_processing_ms": 0.04798715764825994}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"sample_time_ms": 9847.968, "sample_throughput": 406.175, "learn_time_ms": 12703.197, "learn_throughput": 314.881, "update_time_ms": 3.265}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.8775839768350124, "policy_loss": -0.0641450698603876, "vf_loss": 0.9377862140536308, "vf_explained_var": 0.29359307885169983, "kl": 0.01971418218454346, "entropy": 1.0197087079286575, "entropy_coeff": 0.0}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-58-22", "timestamp": 1618138702, "time_this_iter_s": 21.83271360397339, "time_total_s": 67.67997860908508, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b45990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 67.67997860908508, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.79032258064517, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 83.0, "episode_reward_min": 83.0, "episode_reward_mean": 83.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6395297570582599, "mean_raw_obs_processing_ms": 0.07885120856882125, "mean_inference_ms": 1.6754884618926509, "mean_action_processing_ms": 0.04798715764825994}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 16000, "timers": {"sample_time_ms": 9372.121, "sample_throughput": 426.798, "learn_time_ms": 12699.008, "learn_throughput": 314.985, "update_time_ms": 3.132}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 2.915389657020569, "policy_loss": -0.050778126023942605, "vf_loss": 2.9626527950167656, "vf_explained_var": 0.30452147126197815, "kl": 0.017575014935573563, "entropy": 0.9886323362588882, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 1, "training_iteration": 4, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-58-42", "timestamp": 1618138722, "time_this_iter_s": 20.641354084014893, "time_total_s": 88.32133269309998, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b453d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 88.32133269309998, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 58.64666666666667, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 322.0, "episode_reward_min": 322.0, "episode_reward_mean": 322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5312444543750291, "mean_raw_obs_processing_ms": 0.0788701795874867, "mean_inference_ms": 1.672381049698278, "mean_action_processing_ms": 0.0477776361235344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 20000, "timers": {"sample_time_ms": 9398.963, "sample_throughput": 425.579, "learn_time_ms": 12703.461, "learn_throughput": 314.875, "update_time_ms": 3.04}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.4198225922882557, "policy_loss": -0.0552212541224435, "vf_loss": 3.4713615477085114, "vf_explained_var": 0.2980377674102783, "kl": 0.01841140683973208, "entropy": 0.918516369536519, "entropy_coeff": 0.0}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 2, "training_iteration": 5, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-59-05", "timestamp": 1618138745, "time_this_iter_s": 22.23932647705078, "time_total_s": 110.56065917015076, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 110.56065917015076, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.86451612903226, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 322.0, "episode_reward_min": 322.0, "episode_reward_mean": 322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5312444543750291, "mean_raw_obs_processing_ms": 0.0788701795874867, "mean_inference_ms": 1.672381049698278, "mean_action_processing_ms": 0.0477776361235344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"sample_time_ms": 9302.336, "sample_throughput": 430.0, "learn_time_ms": 12701.534, "learn_throughput": 314.923, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.088234655559063, "policy_loss": -0.06427123369940091, "vf_loss": 3.1492780670523643, "vf_explained_var": 0.5991644859313965, "kl": 0.01613927324069664, "entropy": 0.9016471244394779, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 2, "training_iteration": 6, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-59-26", "timestamp": 1618138766, "time_this_iter_s": 21.52340340614319, "time_total_s": 132.08406257629395, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4edd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 132.08406257629395, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.80967741935484, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 322.0, "episode_reward_min": 322.0, "episode_reward_mean": 322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5312444543750291, "mean_raw_obs_processing_ms": 0.0788701795874867, "mean_inference_ms": 1.672381049698278, "mean_action_processing_ms": 0.0477776361235344}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 28000, "timers": {"sample_time_ms": 9370.486, "sample_throughput": 426.872, "learn_time_ms": 12721.013, "learn_throughput": 314.44, "update_time_ms": 3.111}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 2.8810635581612587, "policy_loss": -0.04895340354414657, "vf_loss": 2.9268684536218643, "vf_explained_var": 0.27248015999794006, "kl": 0.01574264155351557, "entropy": 0.8632948826998472, "entropy_coeff": 0.0}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 2, "training_iteration": 7, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_10-59-49", "timestamp": 1618138789, "time_this_iter_s": 22.625324249267578, "time_total_s": 154.70938682556152, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33563d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4dc90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 154.70938682556152, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.5125, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 614.0, "episode_reward_min": 614.0, "episode_reward_mean": 614.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [614.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5184648141336159, "mean_raw_obs_processing_ms": 0.07946254096885445, "mean_inference_ms": 1.676267856531026, "mean_action_processing_ms": 0.04797267010836209}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 32000, "timers": {"sample_time_ms": 9365.894, "sample_throughput": 427.081, "learn_time_ms": 12722.78, "learn_throughput": 314.397, "update_time_ms": 3.123}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.656284399330616, "policy_loss": -0.05532045444124378, "vf_loss": 3.7081248462200165, "vf_explained_var": 0.440707266330719, "kl": 0.01740018927375786, "entropy": 0.83796570263803, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 3, "training_iteration": 8, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-00-11", "timestamp": 1618138811, "time_this_iter_s": 22.080305099487305, "time_total_s": 176.78969192504883, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68ced50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 176.78969192504883, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.56875000000001, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 614.0, "episode_reward_min": 614.0, "episode_reward_mean": 614.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [614.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5184648141336159, "mean_raw_obs_processing_ms": 0.07946254096885445, "mean_inference_ms": 1.676267856531026, "mean_action_processing_ms": 0.04797267010836209}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"sample_time_ms": 9408.103, "sample_throughput": 425.165, "learn_time_ms": 12714.068, "learn_throughput": 314.612, "update_time_ms": 3.112}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.397350639104843, "policy_loss": -0.050348371849395335, "vf_loss": 5.444361783564091, "vf_explained_var": 0.34285059571266174, "kl": 0.016686152113834396, "entropy": 0.7717363182455301, "entropy_coeff": 0.0}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 3, "training_iteration": 9, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-00-33", "timestamp": 1618138833, "time_this_iter_s": 22.40172290802002, "time_total_s": 199.19141483306885, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ddd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3373110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 199.19141483306885, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.334374999999994, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 871.0, "episode_reward_min": 871.0, "episode_reward_mean": 871.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5352472961552426, "mean_raw_obs_processing_ms": 0.07970948621143785, "mean_inference_ms": 1.6765765841491629, "mean_action_processing_ms": 0.04801494247159202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 40000, "timers": {"sample_time_ms": 9435.356, "sample_throughput": 423.937, "learn_time_ms": 12691.805, "learn_throughput": 315.164, "update_time_ms": 3.206}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.373392552137375, "policy_loss": -0.06030925427330658, "vf_loss": 6.430069983005524, "vf_explained_var": 0.3240755796432495, "kl": 0.018158817663788795, "entropy": 0.7329981792718172, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 4, "training_iteration": 10, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-00-56", "timestamp": 1618138856, "time_this_iter_s": 22.184144496917725, "time_total_s": 221.37555932998657, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b45910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 221.37555932998657, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 58.065625000000004, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 871.0, "episode_reward_min": 871.0, "episode_reward_mean": 871.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5352472961552426, "mean_raw_obs_processing_ms": 0.07970948621143785, "mean_inference_ms": 1.6765765841491629, "mean_action_processing_ms": 0.04801494247159202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 44000, "timers": {"sample_time_ms": 9198.743, "sample_throughput": 434.842, "learn_time_ms": 12666.102, "learn_throughput": 315.804, "update_time_ms": 3.205}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.461291015148163, "policy_loss": -0.060281143902102485, "vf_loss": 6.517979219555855, "vf_explained_var": 0.3079495131969452, "kl": 0.017964536207728088, "entropy": 0.7087073754519224, "entropy_coeff": 0.0}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 4, "training_iteration": 11, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-01-18", "timestamp": 1618138878, "time_this_iter_s": 22.532590627670288, "time_total_s": 243.90814995765686, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b45090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 243.90814995765686, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 58.865625, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 871.0, "episode_reward_min": 871.0, "episode_reward_mean": 871.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5352472961552426, "mean_raw_obs_processing_ms": 0.07970948621143785, "mean_inference_ms": 1.6765765841491629, "mean_action_processing_ms": 0.04801494247159202}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"sample_time_ms": 9208.158, "sample_throughput": 434.397, "learn_time_ms": 12623.794, "learn_throughput": 316.862, "update_time_ms": 3.151}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 3.7068690583109856, "policy_loss": -0.044612238300032914, "vf_loss": 3.748247802257538, "vf_explained_var": 0.5364149808883667, "kl": 0.016167618508916348, "entropy": 0.744209548458457, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 4, "training_iteration": 12, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-01-39", "timestamp": 1618138899, "time_this_iter_s": 20.361640691757202, "time_total_s": 264.26979064941406, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcf10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 264.26979064941406, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.97586206896552, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 850.0, "episode_reward_min": 850.0, "episode_reward_mean": 850.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5156549223867583, "mean_raw_obs_processing_ms": 0.07974655132440785, "mean_inference_ms": 1.6678637425369174, "mean_action_processing_ms": 0.04772818920000299}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 52000, "timers": {"sample_time_ms": 9161.94, "sample_throughput": 436.589, "learn_time_ms": 12591.963, "learn_throughput": 317.663, "update_time_ms": 3.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.563537135720253, "policy_loss": -0.04815435330965556, "vf_loss": 5.608002871274948, "vf_explained_var": 0.457121342420578, "kl": 0.018442223110469058, "entropy": 0.6685411762446165, "entropy_coeff": 0.0}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 5, "training_iteration": 13, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-02-00", "timestamp": 1618138920, "time_this_iter_s": 21.05812907218933, "time_total_s": 285.3279197216034, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b45050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 285.3279197216034, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 58.04666666666667, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 850.0, "episode_reward_min": 850.0, "episode_reward_mean": 850.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5156549223867583, "mean_raw_obs_processing_ms": 0.07974655132440785, "mean_inference_ms": 1.6678637425369174, "mean_action_processing_ms": 0.04772818920000299}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 56000, "timers": {"sample_time_ms": 9195.394, "sample_throughput": 435.0, "learn_time_ms": 12544.688, "learn_throughput": 318.86, "update_time_ms": 3.742}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 4.359024293720722, "policy_loss": -0.046879337227437645, "vf_loss": 4.402673088014126, "vf_explained_var": 0.4161584973335266, "kl": 0.01615237194346264, "entropy": 0.6127725597470999, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 5, "training_iteration": 14, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-02-20", "timestamp": 1618138940, "time_this_iter_s": 20.500316381454468, "time_total_s": 305.82823610305786, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b45850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3373dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 305.82823610305786, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 58.33793103448275, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 997.0, "episode_reward_min": 997.0, "episode_reward_mean": 997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49264637109182335, "mean_raw_obs_processing_ms": 0.07962318275835539, "mean_inference_ms": 1.661382737381216, "mean_action_processing_ms": 0.04754493070485975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"sample_time_ms": 9101.946, "sample_throughput": 439.466, "learn_time_ms": 12493.215, "learn_throughput": 320.174, "update_time_ms": 3.842}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.4076597690582275, "policy_loss": -0.04637913694023155, "vf_loss": 5.450943812727928, "vf_explained_var": 0.41115105152130127, "kl": 0.015476017782930285, "entropy": 0.5858040992170572, "entropy_coeff": 0.0}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 6, "training_iteration": 15, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-02-41", "timestamp": 1618138961, "time_this_iter_s": 20.78692889213562, "time_total_s": 326.6151649951935, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 326.6151649951935, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.28666666666666, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 997.0, "episode_reward_min": 997.0, "episode_reward_mean": 997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49264637109182335, "mean_raw_obs_processing_ms": 0.07962318275835539, "mean_inference_ms": 1.661382737381216, "mean_action_processing_ms": 0.04754493070485975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 64000, "timers": {"sample_time_ms": 9064.237, "sample_throughput": 441.295, "learn_time_ms": 12449.31, "learn_throughput": 321.303, "update_time_ms": 3.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.903505727648735, "policy_loss": -0.04225415253313258, "vf_loss": 8.942538276314735, "vf_explained_var": 0.5421670079231262, "kl": 0.016108450625324622, "entropy": 0.5716182552278042, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 6, "training_iteration": 16, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-03-02", "timestamp": 1618138982, "time_this_iter_s": 20.70534658432007, "time_total_s": 347.32051157951355, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 347.32051157951355, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 58.173333333333325, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 997.0, "episode_reward_min": 997.0, "episode_reward_mean": 997.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [997.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49264637109182335, "mean_raw_obs_processing_ms": 0.07962318275835539, "mean_inference_ms": 1.661382737381216, "mean_action_processing_ms": 0.04754493070485975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 68000, "timers": {"sample_time_ms": 8870.87, "sample_throughput": 450.914, "learn_time_ms": 12386.939, "learn_throughput": 322.921, "update_time_ms": 3.765}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.139442592859268, "policy_loss": -0.051059074292425066, "vf_loss": 7.187590539455414, "vf_explained_var": 0.5027618408203125, "kl": 0.014555106434272602, "entropy": 0.6194729711860418, "entropy_coeff": 0.0}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 6, "training_iteration": 17, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-03-22", "timestamp": 1618139002, "time_this_iter_s": 20.06959581375122, "time_total_s": 367.39010739326477, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b45d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 367.39010739326477, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.51071428571429, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 878.0, "episode_reward_min": 878.0, "episode_reward_mean": 878.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [878.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45046463149916544, "mean_raw_obs_processing_ms": 0.07959416560952136, "mean_inference_ms": 1.652881646526848, "mean_action_processing_ms": 0.047258462454351766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"sample_time_ms": 8700.725, "sample_throughput": 459.732, "learn_time_ms": 12341.802, "learn_throughput": 324.102, "update_time_ms": 3.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.783903643488884, "policy_loss": -0.03734153136610985, "vf_loss": 6.818470790982246, "vf_explained_var": 0.43180301785469055, "kl": 0.013871724891941994, "entropy": 0.6082569435238838, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 7, "training_iteration": 18, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-03-42", "timestamp": 1618139022, "time_this_iter_s": 19.924874305725098, "time_total_s": 387.31498169898987, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 387.31498169898987, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 58.20344827586207, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 878.0, "episode_reward_min": 878.0, "episode_reward_mean": 878.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [878.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45046463149916544, "mean_raw_obs_processing_ms": 0.07959416560952136, "mean_inference_ms": 1.652881646526848, "mean_action_processing_ms": 0.047258462454351766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 76000, "timers": {"sample_time_ms": 8505.019, "sample_throughput": 470.311, "learn_time_ms": 12314.696, "learn_throughput": 324.815, "update_time_ms": 3.746}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.445670001208782, "policy_loss": -0.03825610294006765, "vf_loss": 5.48040235042572, "vf_explained_var": 0.6077662110328674, "kl": 0.017618658865103498, "entropy": 0.5584615003317595, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 7, "training_iteration": 19, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-04-02", "timestamp": 1618139042, "time_this_iter_s": 20.16966724395752, "time_total_s": 407.4846489429474, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b45a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 407.4846489429474, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.86071428571427, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 672.0, "episode_reward_min": 672.0, "episode_reward_mean": 672.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [672.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4250825735165524, "mean_raw_obs_processing_ms": 0.07955055934420449, "mean_inference_ms": 1.6478773751894644, "mean_action_processing_ms": 0.04709324084708554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 80000, "timers": {"sample_time_ms": 8311.832, "sample_throughput": 481.242, "learn_time_ms": 12284.801, "learn_throughput": 325.606, "update_time_ms": 3.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 5.889592811465263, "policy_loss": -0.032543021137826145, "vf_loss": 5.919589474797249, "vf_explained_var": 0.5390768051147461, "kl": 0.01273141780984588, "entropy": 0.5671288818120956, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 8, "training_iteration": 20, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-04-22", "timestamp": 1618139062, "time_this_iter_s": 19.95216155052185, "time_total_s": 427.43681049346924, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d97d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 427.43681049346924, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.82758620689656, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 672.0, "episode_reward_min": 672.0, "episode_reward_mean": 672.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [672.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4250825735165524, "mean_raw_obs_processing_ms": 0.07955055934420449, "mean_inference_ms": 1.6478773751894644, "mean_action_processing_ms": 0.04709324084708554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"sample_time_ms": 8154.454, "sample_throughput": 490.529, "learn_time_ms": 12254.918, "learn_throughput": 326.4, "update_time_ms": 3.599}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.034365296363831, "policy_loss": -0.043412719445768744, "vf_loss": 6.074835419654846, "vf_explained_var": 0.4984918236732483, "kl": 0.014713105541886762, "entropy": 0.4826854318380356, "entropy_coeff": 0.0}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 8, "training_iteration": 21, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-04-43", "timestamp": 1618139083, "time_this_iter_s": 20.65903615951538, "time_total_s": 448.0958466529846, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 448.0958466529846, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.916666666666664, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 672.0, "episode_reward_min": 672.0, "episode_reward_mean": 672.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [672.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4250825735165524, "mean_raw_obs_processing_ms": 0.07955055934420449, "mean_inference_ms": 1.6478773751894644, "mean_action_processing_ms": 0.04709324084708554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 88000, "timers": {"sample_time_ms": 8143.547, "sample_throughput": 491.186, "learn_time_ms": 12255.005, "learn_throughput": 326.397, "update_time_ms": 3.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.116530656814575, "policy_loss": -0.04072007234208286, "vf_loss": 8.154800459742546, "vf_explained_var": 0.48684364557266235, "kl": 0.012251470208866522, "entropy": 0.4734121970832348, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 8, "training_iteration": 22, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-05-03", "timestamp": 1618139103, "time_this_iter_s": 20.2557852268219, "time_total_s": 468.3516318798065, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e07d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 468.3516318798065, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 58.35, "ram_util_percent": 27.046428571428574}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1188.0, "episode_reward_min": 1188.0, "episode_reward_mean": 1188.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1188.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4207797623762865, "mean_raw_obs_processing_ms": 0.07975303735815026, "mean_inference_ms": 1.645687190054904, "mean_action_processing_ms": 0.04703870728057856}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 92000, "timers": {"sample_time_ms": 8233.694, "sample_throughput": 485.809, "learn_time_ms": 12252.229, "learn_throughput": 326.471, "update_time_ms": 3.11}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 9.267797648906708, "policy_loss": -0.05591959855519235, "vf_loss": 9.320166498422623, "vf_explained_var": 0.33146932721138, "kl": 0.017753507621819153, "entropy": 0.4391875509172678, "entropy_coeff": 0.0}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 9, "training_iteration": 23, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-05-25", "timestamp": 1618139125, "time_this_iter_s": 21.928439140319824, "time_total_s": 490.28007102012634, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 490.28007102012634, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.603125000000006, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1188.0, "episode_reward_min": 1188.0, "episode_reward_mean": 1188.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1188.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4207797623762865, "mean_raw_obs_processing_ms": 0.07975303735815026, "mean_inference_ms": 1.645687190054904, "mean_action_processing_ms": 0.04703870728057856}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"sample_time_ms": 8302.281, "sample_throughput": 481.795, "learn_time_ms": 12262.85, "learn_throughput": 326.188, "update_time_ms": 3.056}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.143290236592293, "policy_loss": -0.04013818968087435, "vf_loss": 7.180379867553711, "vf_explained_var": 0.3839605748653412, "kl": 0.015242873487295583, "entropy": 0.41259945929050446, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 9, "training_iteration": 24, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-05-46", "timestamp": 1618139146, "time_this_iter_s": 21.292325973510742, "time_total_s": 511.5723969936371, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 511.5723969936371, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 58.07, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1417.0, "episode_reward_min": 1417.0, "episode_reward_mean": 1417.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1417.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4311857592483646, "mean_raw_obs_processing_ms": 0.07992619458494747, "mean_inference_ms": 1.6447141827791318, "mean_action_processing_ms": 0.04700078931904163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 100000, "timers": {"sample_time_ms": 8413.403, "sample_throughput": 475.432, "learn_time_ms": 12273.718, "learn_throughput": 325.9, "update_time_ms": 2.969}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.629695162177086, "policy_loss": -0.043242601241217926, "vf_loss": 7.670125797390938, "vf_explained_var": 0.4569748640060425, "kl": 0.014059801585972309, "entropy": 0.3886243561282754, "entropy_coeff": 0.0}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 10, "training_iteration": 25, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-06-08", "timestamp": 1618139168, "time_this_iter_s": 22.009734869003296, "time_total_s": 533.5821318626404, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 533.5821318626404, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 57.628125, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1417.0, "episode_reward_min": 1417.0, "episode_reward_mean": 1417.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1417.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4311857592483646, "mean_raw_obs_processing_ms": 0.07992619458494747, "mean_inference_ms": 1.6447141827791318, "mean_action_processing_ms": 0.04700078931904163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 104000, "timers": {"sample_time_ms": 8346.968, "sample_throughput": 479.216, "learn_time_ms": 12278.62, "learn_throughput": 325.77, "update_time_ms": 2.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.418162316083908, "policy_loss": -0.04088520960067399, "vf_loss": 7.456404492259026, "vf_explained_var": 0.516657829284668, "kl": 0.013215264567406848, "entropy": 0.412507557310164, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 10, "training_iteration": 26, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-06-28", "timestamp": 1618139188, "time_this_iter_s": 20.089707612991333, "time_total_s": 553.6718394756317, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d22d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 553.6718394756317, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 57.96071428571428, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1417.0, "episode_reward_min": 1417.0, "episode_reward_mean": 1417.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1417.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4311857592483646, "mean_raw_obs_processing_ms": 0.07992619458494747, "mean_inference_ms": 1.6447141827791318, "mean_action_processing_ms": 0.04700078931904163}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"sample_time_ms": 8342.783, "sample_throughput": 479.456, "learn_time_ms": 12310.758, "learn_throughput": 324.919, "update_time_ms": 2.997}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.28443293273449, "policy_loss": -0.031940164597472176, "vf_loss": 8.314018666744232, "vf_explained_var": 0.40450236201286316, "kl": 0.0117721181595698, "entropy": 0.42445556726306677, "entropy_coeff": 0.0}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 10, "training_iteration": 27, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-06-49", "timestamp": 1618139209, "time_this_iter_s": 20.34784173965454, "time_total_s": 574.0196812152863, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33b1090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 574.0196812152863, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 58.46551724137931, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 957.0, "episode_reward_min": 957.0, "episode_reward_mean": 957.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [957.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.42499467399107327, "mean_raw_obs_processing_ms": 0.08027959994535964, "mean_inference_ms": 1.6421043607062773, "mean_action_processing_ms": 0.04691017790448065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 112000, "timers": {"sample_time_ms": 8590.557, "sample_throughput": 465.628, "learn_time_ms": 12298.17, "learn_throughput": 325.252, "update_time_ms": 2.947}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 9.512362718582153, "policy_loss": -0.04194675962207839, "vf_loss": 9.55108568072319, "vf_explained_var": 0.605171799659729, "kl": 0.016118704807013273, "entropy": 0.36361437290906906, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 11, "training_iteration": 28, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-07-11", "timestamp": 1618139231, "time_this_iter_s": 22.276143312454224, "time_total_s": 596.2958245277405, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3d610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4dc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 596.2958245277405, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.965625, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 957.0, "episode_reward_min": 957.0, "episode_reward_mean": 957.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [957.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.42499467399107327, "mean_raw_obs_processing_ms": 0.08027959994535964, "mean_inference_ms": 1.6421043607062773, "mean_action_processing_ms": 0.04691017790448065}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 116000, "timers": {"sample_time_ms": 9015.802, "sample_throughput": 443.665, "learn_time_ms": 12294.488, "learn_throughput": 325.349, "update_time_ms": 2.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 8.839447543025017, "policy_loss": -0.039366989745758474, "vf_loss": 8.876208022236824, "vf_explained_var": 0.27419090270996094, "kl": 0.01303334758267738, "entropy": 0.31063096038997173, "entropy_coeff": 0.0}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 11, "training_iteration": 29, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-07-35", "timestamp": 1618139255, "time_this_iter_s": 24.388845920562744, "time_total_s": 620.6846704483032, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3373290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3dd90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 620.6846704483032, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.682857142857145, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1666.0, "episode_reward_min": 1666.0, "episode_reward_mean": 1666.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1666.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4663144730236939, "mean_raw_obs_processing_ms": 0.08047027286532053, "mean_inference_ms": 1.6413342490696785, "mean_action_processing_ms": 0.04686824961565567}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"sample_time_ms": 9295.101, "sample_throughput": 430.334, "learn_time_ms": 12296.291, "learn_throughput": 325.301, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 7.21260991692543, "policy_loss": -0.039016233233269304, "vf_loss": 7.247824922204018, "vf_explained_var": 0.3489927649497986, "kl": 0.01900634405319579, "entropy": 0.3072688695974648, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 12, "training_iteration": 30, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-07-58", "timestamp": 1618139278, "time_this_iter_s": 22.763529777526855, "time_total_s": 643.4482002258301, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68c7e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 643.4482002258301, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.765625, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1666.0, "episode_reward_min": 1666.0, "episode_reward_mean": 1666.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1666.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4663144730236939, "mean_raw_obs_processing_ms": 0.08047027286532053, "mean_inference_ms": 1.6413342490696785, "mean_action_processing_ms": 0.04686824961565567}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 124000, "timers": {"sample_time_ms": 9558.982, "sample_throughput": 418.455, "learn_time_ms": 12289.553, "learn_throughput": 325.48, "update_time_ms": 2.975}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 4.549375645816326, "policy_loss": -0.026581923782941885, "vf_loss": 4.5738465040922165, "vf_explained_var": 0.3313799500465393, "kl": 0.010554868029430509, "entropy": 0.28374099684879184, "entropy_coeff": 0.0}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 12, "training_iteration": 31, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-08-22", "timestamp": 1618139302, "time_this_iter_s": 23.231414318084717, "time_total_s": 666.6796145439148, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3db90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 666.6796145439148, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 57.491176470588236, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1666.0, "episode_reward_min": 1666.0, "episode_reward_mean": 1666.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1666.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4663144730236939, "mean_raw_obs_processing_ms": 0.08047027286532053, "mean_inference_ms": 1.6413342490696785, "mean_action_processing_ms": 0.04686824961565567}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 128000, "timers": {"sample_time_ms": 9582.627, "sample_throughput": 417.422, "learn_time_ms": 12285.185, "learn_throughput": 325.595, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 9.950141310691833, "policy_loss": -0.041269166860729456, "vf_loss": 9.988073706626892, "vf_explained_var": 0.4422106444835663, "kl": 0.016684607791830786, "entropy": 0.3047130201011896, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 12, "training_iteration": 32, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-08-42", "timestamp": 1618139322, "time_this_iter_s": 20.44689106941223, "time_total_s": 687.126505613327, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 687.126505613327, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 58.09655172413791, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1558.0, "episode_reward_min": 1558.0, "episode_reward_mean": 1558.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1558.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47730555685251713, "mean_raw_obs_processing_ms": 0.08077709096186861, "mean_inference_ms": 1.6407642710134027, "mean_action_processing_ms": 0.046855244627251845}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"sample_time_ms": 9537.135, "sample_throughput": 419.413, "learn_time_ms": 12279.378, "learn_throughput": 325.749, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 6.371509447693825, "policy_loss": -0.03320785117102787, "vf_loss": 6.4021027982234955, "vf_explained_var": 0.4643106758594513, "kl": 0.013072244852082804, "entropy": 0.27817780058830976, "entropy_coeff": 0.0}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 13, "training_iteration": 33, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-09-03", "timestamp": 1618139343, "time_this_iter_s": 21.413891315460205, "time_total_s": 708.5403969287872, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 708.5403969287872, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.84999999999999, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1558.0, "episode_reward_min": 1558.0, "episode_reward_mean": 1558.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1558.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47730555685251713, "mean_raw_obs_processing_ms": 0.08077709096186861, "mean_inference_ms": 1.6407642710134027, "mean_action_processing_ms": 0.046855244627251845}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 136000, "timers": {"sample_time_ms": 9457.448, "sample_throughput": 422.947, "learn_time_ms": 12267.957, "learn_throughput": 326.053, "update_time_ms": 2.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 10.447446286678314, "policy_loss": -0.0967260479228571, "vf_loss": 10.530260026454926, "vf_explained_var": 0.47393882274627686, "kl": 0.06956132140476257, "entropy": 0.36036812514066696, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 13, "training_iteration": 34, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-09-24", "timestamp": 1618139364, "time_this_iter_s": 20.383461713790894, "time_total_s": 728.9238586425781, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 728.9238586425781, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 57.839999999999996, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1168.0, "episode_reward_min": 1168.0, "episode_reward_mean": 1168.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1168.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46319346636668485, "mean_raw_obs_processing_ms": 0.08096673897484856, "mean_inference_ms": 1.6400575877937236, "mean_action_processing_ms": 0.04681768014161401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 140000, "timers": {"sample_time_ms": 9278.121, "sample_throughput": 431.122, "learn_time_ms": 12267.608, "learn_throughput": 326.062, "update_time_ms": 2.964}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.108258977532387, "policy_loss": -0.033161956060212106, "vf_loss": 9.138726696372032, "vf_explained_var": 0.6682611703872681, "kl": 0.008980574013548903, "entropy": 0.2914188033901155, "entropy_coeff": 0.0}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 14, "training_iteration": 35, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-09-44", "timestamp": 1618139384, "time_this_iter_s": 20.213410139083862, "time_total_s": 749.137268781662, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d95d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33565d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 749.137268781662, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.06785714285713, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1168.0, "episode_reward_min": 1168.0, "episode_reward_mean": 1168.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1168.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46319346636668485, "mean_raw_obs_processing_ms": 0.08096673897484856, "mean_inference_ms": 1.6400575877937236, "mean_action_processing_ms": 0.04681768014161401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"sample_time_ms": 9440.459, "sample_throughput": 423.708, "learn_time_ms": 12259.371, "learn_throughput": 326.281, "update_time_ms": 2.979}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.499731957912445, "policy_loss": -0.02719065226847306, "vf_loss": 9.524325922131538, "vf_explained_var": 0.2714861035346985, "kl": 0.008655611309222877, "entropy": 0.22333343978971243, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 14, "training_iteration": 36, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-10-06", "timestamp": 1618139406, "time_this_iter_s": 21.62839102745056, "time_total_s": 770.7656598091125, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3394510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 770.7656598091125, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.909677419354836, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1168.0, "episode_reward_min": 1168.0, "episode_reward_mean": 1168.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1168.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46319346636668485, "mean_raw_obs_processing_ms": 0.08096673897484856, "mean_inference_ms": 1.6400575877937236, "mean_action_processing_ms": 0.04681768014161401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 148000, "timers": {"sample_time_ms": 9432.811, "sample_throughput": 424.052, "learn_time_ms": 12233.243, "learn_throughput": 326.978, "update_time_ms": 2.982}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 9.218832448124886, "policy_loss": -0.028041873360052705, "vf_loss": 9.243623062968254, "vf_explained_var": 0.5697125792503357, "kl": 0.010837323483428918, "entropy": 0.3224848201498389, "entropy_coeff": 0.0}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 14, "training_iteration": 37, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-10-26", "timestamp": 1618139426, "time_this_iter_s": 20.01336908340454, "time_total_s": 790.7790288925171, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 790.7790288925171, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.8448275862069, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1192.0, "episode_reward_min": 1192.0, "episode_reward_mean": 1192.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1192.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4519252125970205, "mean_raw_obs_processing_ms": 0.0811310954964814, "mean_inference_ms": 1.636844744142015, "mean_action_processing_ms": 0.046706173137789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 152000, "timers": {"sample_time_ms": 9188.061, "sample_throughput": 435.348, "learn_time_ms": 12273.821, "learn_throughput": 325.897, "update_time_ms": 2.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 10.575910747051239, "policy_loss": -0.040848757431376725, "vf_loss": 10.612224012613297, "vf_explained_var": 0.46929746866226196, "kl": 0.015118250928935595, "entropy": 0.2698596497066319, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 15, "training_iteration": 38, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-10-46", "timestamp": 1618139446, "time_this_iter_s": 20.236011028289795, "time_total_s": 811.0150399208069, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4eb90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 811.0150399208069, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.886206896551734, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1192.0, "episode_reward_min": 1192.0, "episode_reward_mean": 1192.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1192.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4519252125970205, "mean_raw_obs_processing_ms": 0.0811310954964814, "mean_inference_ms": 1.636844744142015, "mean_action_processing_ms": 0.046706173137789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"sample_time_ms": 8847.25, "sample_throughput": 452.118, "learn_time_ms": 12251.738, "learn_throughput": 326.484, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 14.172836422920227, "policy_loss": -0.032548607676289976, "vf_loss": 14.198849558830261, "vf_explained_var": 0.4514681398868561, "kl": 0.021783953794511035, "entropy": 0.25506747141480446, "entropy_coeff": 0.0}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 15, "training_iteration": 39, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-11-07", "timestamp": 1618139467, "time_this_iter_s": 20.75687289237976, "time_total_s": 831.7719128131866, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 831.7719128131866, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 57.28275862068966, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1525.0, "episode_reward_min": 1525.0, "episode_reward_mean": 1525.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1525.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4499664898272631, "mean_raw_obs_processing_ms": 0.08125643757849758, "mean_inference_ms": 1.6357236240474295, "mean_action_processing_ms": 0.046670113878480614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 160000, "timers": {"sample_time_ms": 8669.801, "sample_throughput": 461.372, "learn_time_ms": 12260.168, "learn_throughput": 326.26, "update_time_ms": 3.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.322247371077538, "policy_loss": -0.01880629052175209, "vf_loss": 9.337160125374794, "vf_explained_var": 0.5408017635345459, "kl": 0.008652524920762517, "entropy": 0.22587190149351954, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 16, "training_iteration": 40, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-11-28", "timestamp": 1618139488, "time_this_iter_s": 21.074708938598633, "time_total_s": 852.8466217517853, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ef50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 852.8466217517853, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.958064516129035, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1525.0, "episode_reward_min": 1525.0, "episode_reward_mean": 1525.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1525.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4499664898272631, "mean_raw_obs_processing_ms": 0.08125643757849758, "mean_inference_ms": 1.6357236240474295, "mean_action_processing_ms": 0.046670113878480614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 164000, "timers": {"sample_time_ms": 8349.099, "sample_throughput": 479.094, "learn_time_ms": 12262.501, "learn_throughput": 326.198, "update_time_ms": 3.063}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 8.631425559520721, "policy_loss": -0.025888810749165714, "vf_loss": 8.654063269495964, "vf_explained_var": 0.42933154106140137, "kl": 0.007224743923870847, "entropy": 0.3200450800359249, "entropy_coeff": 0.0}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 16, "training_iteration": 41, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-11-48", "timestamp": 1618139508, "time_this_iter_s": 20.04882001876831, "time_total_s": 872.8954417705536, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 872.8954417705536, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.05714285714284, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1525.0, "episode_reward_min": 1525.0, "episode_reward_mean": 1525.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1525.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4499664898272631, "mean_raw_obs_processing_ms": 0.08125643757849758, "mean_inference_ms": 1.6357236240474295, "mean_action_processing_ms": 0.046670113878480614}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"sample_time_ms": 8312.03, "sample_throughput": 481.23, "learn_time_ms": 12262.027, "learn_throughput": 326.21, "update_time_ms": 3.05}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 4.563889063894749, "policy_loss": -0.030568760907044634, "vf_loss": 4.5913771241903305, "vf_explained_var": 0.7195796966552734, "kl": 0.006846000993391499, "entropy": 0.33533939346671104, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 16, "training_iteration": 42, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-12-08", "timestamp": 1618139528, "time_this_iter_s": 20.07128667831421, "time_total_s": 892.9667284488678, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 892.9667284488678, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 58.25172413793104, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4358617675349393, "mean_raw_obs_processing_ms": 0.08152568486747888, "mean_inference_ms": 1.6354815672901069, "mean_action_processing_ms": 0.04666024764296158}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 172000, "timers": {"sample_time_ms": 8260.841, "sample_throughput": 484.212, "learn_time_ms": 12262.803, "learn_throughput": 326.19, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.973741054534912, "policy_loss": -0.028947375481948256, "vf_loss": 10.999422252178192, "vf_explained_var": 0.7702875733375549, "kl": 0.007258017685671803, "entropy": 0.2562762531451881, "entropy_coeff": 0.0}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 17, "training_iteration": 43, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-12-29", "timestamp": 1618139549, "time_this_iter_s": 20.91226363182068, "time_total_s": 913.8789920806885, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 913.8789920806885, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.71333333333333, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 337.0, "episode_reward_min": 337.0, "episode_reward_mean": 337.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4358617675349393, "mean_raw_obs_processing_ms": 0.08152568486747888, "mean_inference_ms": 1.6354815672901069, "mean_action_processing_ms": 0.04666024764296158}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 176000, "timers": {"sample_time_ms": 8654.438, "sample_throughput": 462.191, "learn_time_ms": 12283.036, "learn_throughput": 325.652, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 9.821849688887596, "policy_loss": -0.02509340940741822, "vf_loss": 9.84357313811779, "vf_explained_var": 0.22443556785583496, "kl": 0.007488680828828365, "entropy": 0.16190936625935137, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 17, "training_iteration": 44, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-12-54", "timestamp": 1618139574, "time_this_iter_s": 24.520782470703125, "time_total_s": 938.3997745513916, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 938.3997745513916, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.67428571428571, "ram_util_percent": 27.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1968.0, "episode_reward_min": 1968.0, "episode_reward_mean": 1968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45097537368163304, "mean_raw_obs_processing_ms": 0.08169810816089067, "mean_inference_ms": 1.634268194281228, "mean_action_processing_ms": 0.046625522028587205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"sample_time_ms": 8681.82, "sample_throughput": 460.733, "learn_time_ms": 12281.784, "learn_throughput": 325.686, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 3.7718051597476006, "policy_loss": -0.027053500758484006, "vf_loss": 3.7953014373779297, "vf_explained_var": 0.34404313564300537, "kl": 0.007904966056230478, "entropy": 0.16988933132961392, "entropy_coeff": 0.0}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 18, "training_iteration": 45, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-13-14", "timestamp": 1618139594, "time_this_iter_s": 20.471293926239014, "time_total_s": 958.8710684776306, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4de10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 958.8710684776306, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.648275862068964, "ram_util_percent": 27.03793103448276}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1968.0, "episode_reward_min": 1968.0, "episode_reward_mean": 1968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45097537368163304, "mean_raw_obs_processing_ms": 0.08169810816089067, "mean_inference_ms": 1.634268194281228, "mean_action_processing_ms": 0.046625522028587205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 184000, "timers": {"sample_time_ms": 8889.26, "sample_throughput": 449.981, "learn_time_ms": 12278.042, "learn_throughput": 325.785, "update_time_ms": 3.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 5.9018983989953995, "policy_loss": -0.0233884533517994, "vf_loss": 5.92167329788208, "vf_explained_var": 0.23027753829956055, "kl": 0.00803006169735454, "entropy": 0.16735923453234136, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 18, "training_iteration": 46, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-13-38", "timestamp": 1618139618, "time_this_iter_s": 23.66519021987915, "time_total_s": 982.5362586975098, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 982.5362586975098, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.87647058823529, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1968.0, "episode_reward_min": 1968.0, "episode_reward_mean": 1968.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1968.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45097537368163304, "mean_raw_obs_processing_ms": 0.08169810816089067, "mean_inference_ms": 1.634268194281228, "mean_action_processing_ms": 0.046625522028587205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 188000, "timers": {"sample_time_ms": 9125.103, "sample_throughput": 438.351, "learn_time_ms": 12271.15, "learn_throughput": 325.968, "update_time_ms": 3.101}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 10.083892613649368, "policy_loss": -0.03302262022043578, "vf_loss": 10.113193482160568, "vf_explained_var": 0.5240628719329834, "kl": 0.00827056504203938, "entropy": 0.19029016699641943, "entropy_coeff": 0.0}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 18, "training_iteration": 47, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-14-00", "timestamp": 1618139640, "time_this_iter_s": 22.29944610595703, "time_total_s": 1004.8357048034668, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1004.8357048034668, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 57.512499999999996, "ram_util_percent": 27.096875}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1799.0, "episode_reward_min": 1799.0, "episode_reward_mean": 1799.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1799.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4793645955611758, "mean_raw_obs_processing_ms": 0.0820038046080797, "mean_inference_ms": 1.6332579871260768, "mean_action_processing_ms": 0.04661494305078922}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"sample_time_ms": 9412.367, "sample_throughput": 424.973, "learn_time_ms": 12239.673, "learn_throughput": 326.806, "update_time_ms": 3.108}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 11.183870255947113, "policy_loss": -0.03713898820569739, "vf_loss": 11.214702516794205, "vf_explained_var": 0.5286328792572021, "kl": 0.014014889864483848, "entropy": 0.21032644575461745, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 19, "training_iteration": 48, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-14-23", "timestamp": 1618139663, "time_this_iter_s": 22.794440746307373, "time_total_s": 1027.6301455497742, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1027.6301455497742, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 57.434375, "ram_util_percent": 27.05625}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1799.0, "episode_reward_min": 1799.0, "episode_reward_mean": 1799.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1799.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4793645955611758, "mean_raw_obs_processing_ms": 0.0820038046080797, "mean_inference_ms": 1.6332579871260768, "mean_action_processing_ms": 0.04661494305078922}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 196000, "timers": {"sample_time_ms": 9768.768, "sample_throughput": 409.468, "learn_time_ms": 12246.897, "learn_throughput": 326.613, "update_time_ms": 3.131}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 12.615728095173836, "policy_loss": -0.03644336375873536, "vf_loss": 12.642153531312943, "vf_explained_var": 0.30922645330429077, "kl": 0.02226205510669388, "entropy": 0.1789930029772222, "entropy_coeff": 0.0}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 19, "training_iteration": 49, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-14-47", "timestamp": 1618139687, "time_this_iter_s": 24.396363019943237, "time_total_s": 1052.0265085697174, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2251410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1052.0265085697174, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.837142857142865, "ram_util_percent": 27.091428571428576}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2016.0, "episode_reward_min": 2016.0, "episode_reward_mean": 2016.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2016.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5005013486685649, "mean_raw_obs_processing_ms": 0.08222044484908496, "mean_inference_ms": 1.633097683539216, "mean_action_processing_ms": 0.046613951309821086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 200000, "timers": {"sample_time_ms": 9903.713, "sample_throughput": 403.889, "learn_time_ms": 12239.729, "learn_throughput": 326.805, "update_time_ms": 3.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.653243035078049, "policy_loss": -0.029055472754407674, "vf_loss": 8.678751721978188, "vf_explained_var": 0.31945693492889404, "kl": 0.005254635245364625, "entropy": 0.16998523427173495, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 20, "training_iteration": 50, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-15-10", "timestamp": 1618139710, "time_this_iter_s": 22.35050630569458, "time_total_s": 1074.377014875412, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ed50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2251490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1074.377014875412, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 57.681250000000006, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2016.0, "episode_reward_min": 2016.0, "episode_reward_mean": 2016.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2016.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5005013486685649, "mean_raw_obs_processing_ms": 0.08222044484908496, "mean_inference_ms": 1.633097683539216, "mean_action_processing_ms": 0.046613951309821086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"sample_time_ms": 10152.055, "sample_throughput": 394.009, "learn_time_ms": 12236.569, "learn_throughput": 326.889, "update_time_ms": 3.036}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.361294001340866, "policy_loss": -0.03787909421953373, "vf_loss": 10.393734514713287, "vf_explained_var": 0.35622453689575195, "kl": 0.00805732241133228, "entropy": 0.18657710449770093, "entropy_coeff": 0.0}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 20, "training_iteration": 51, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-15-32", "timestamp": 1618139732, "time_this_iter_s": 22.501497745513916, "time_total_s": 1096.878512620926, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1096.878512620926, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.74375, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2016.0, "episode_reward_min": 2016.0, "episode_reward_mean": 2016.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2016.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5005013486685649, "mean_raw_obs_processing_ms": 0.08222044484908496, "mean_inference_ms": 1.633097683539216, "mean_action_processing_ms": 0.046613951309821086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 208000, "timers": {"sample_time_ms": 10211.665, "sample_throughput": 391.709, "learn_time_ms": 12250.501, "learn_throughput": 326.517, "update_time_ms": 2.984}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.034402661025524, "policy_loss": -0.027802135824458674, "vf_loss": 8.057494893670082, "vf_explained_var": 0.32304197549819946, "kl": 0.006977665896556573, "entropy": 0.1890441095456481, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 20, "training_iteration": 52, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-15-53", "timestamp": 1618139753, "time_this_iter_s": 20.80867290496826, "time_total_s": 1117.6871855258942, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d09d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1117.6871855258942, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 58.21333333333334, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1702.0, "episode_reward_min": 1702.0, "episode_reward_mean": 1702.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1702.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4973017125370794, "mean_raw_obs_processing_ms": 0.08253774419326758, "mean_inference_ms": 1.6340927404258414, "mean_action_processing_ms": 0.04664091161268821}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 212000, "timers": {"sample_time_ms": 10165.066, "sample_throughput": 393.505, "learn_time_ms": 12244.645, "learn_throughput": 326.673, "update_time_ms": 2.996}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.019906401634216, "policy_loss": -0.03510027009178884, "vf_loss": 11.050521612167358, "vf_explained_var": 0.6211134195327759, "kl": 0.006644333108852152, "entropy": 0.23895820416510105, "entropy_coeff": 0.0}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 21, "training_iteration": 53, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-16-14", "timestamp": 1618139774, "time_this_iter_s": 20.384709119796753, "time_total_s": 1138.071894645691, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33564d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1138.071894645691, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 57.89310344827586, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1702.0, "episode_reward_min": 1702.0, "episode_reward_mean": 1702.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1702.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4973017125370794, "mean_raw_obs_processing_ms": 0.08253774419326758, "mean_inference_ms": 1.6340927404258414, "mean_action_processing_ms": 0.04664091161268821}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"sample_time_ms": 10067.995, "sample_throughput": 397.299, "learn_time_ms": 12229.62, "learn_throughput": 327.075, "update_time_ms": 2.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.185519054532051, "policy_loss": -0.03536622121464461, "vf_loss": 7.21524079144001, "vf_explained_var": 0.33397719264030457, "kl": 0.008362260108697228, "entropy": 0.19083064794540405, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 21, "training_iteration": 54, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-16-37", "timestamp": 1618139797, "time_this_iter_s": 23.40278911590576, "time_total_s": 1161.4746837615967, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1161.4746837615967, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.57272727272728, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1590.0, "episode_reward_min": 1590.0, "episode_reward_mean": 1590.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1590.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5079228602941637, "mean_raw_obs_processing_ms": 0.08273534664544693, "mean_inference_ms": 1.6349548670403107, "mean_action_processing_ms": 0.04662726080536138}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 220000, "timers": {"sample_time_ms": 10218.261, "sample_throughput": 391.456, "learn_time_ms": 12240.08, "learn_throughput": 326.795, "update_time_ms": 2.94}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.76949267089367, "policy_loss": -0.025190927437506616, "vf_loss": 8.790718764066696, "vf_explained_var": 0.4982756972312927, "kl": 0.005873939975572284, "entropy": 0.17735288199037313, "entropy_coeff": 0.0}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 22, "training_iteration": 55, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-16-59", "timestamp": 1618139819, "time_this_iter_s": 22.081461668014526, "time_total_s": 1183.5561454296112, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68c7810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33736d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1183.5561454296112, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.76875, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1590.0, "episode_reward_min": 1590.0, "episode_reward_mean": 1590.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1590.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5079228602941637, "mean_raw_obs_processing_ms": 0.08273534664544693, "mean_inference_ms": 1.6349548670403107, "mean_action_processing_ms": 0.04662726080536138}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 224000, "timers": {"sample_time_ms": 9944.26, "sample_throughput": 402.242, "learn_time_ms": 12260.27, "learn_throughput": 326.257, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.817446663975716, "policy_loss": -0.022478868311736733, "vf_loss": 8.835215657949448, "vf_explained_var": 0.5421037673950195, "kl": 0.006977297991397791, "entropy": 0.20984714943915606, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 22, "training_iteration": 56, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-17-20", "timestamp": 1618139840, "time_this_iter_s": 21.1303391456604, "time_total_s": 1204.6864845752716, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6c45590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1204.6864845752716, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 58.21, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1590.0, "episode_reward_min": 1590.0, "episode_reward_mean": 1590.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1590.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5079228602941637, "mean_raw_obs_processing_ms": 0.08273534664544693, "mean_inference_ms": 1.6349548670403107, "mean_action_processing_ms": 0.04662726080536138}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"sample_time_ms": 10077.326, "sample_throughput": 396.931, "learn_time_ms": 12266.236, "learn_throughput": 326.098, "update_time_ms": 2.979}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.172296419739723, "policy_loss": -0.02879152717650868, "vf_loss": 8.1923216432333, "vf_explained_var": 0.2555130422115326, "kl": 0.012987203284865245, "entropy": 0.17166893417015672, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 22, "training_iteration": 57, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-17-44", "timestamp": 1618139864, "time_this_iter_s": 23.69365620613098, "time_total_s": 1228.3801407814026, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4da10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1228.3801407814026, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 57.523529411764706, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1826.0, "episode_reward_min": 1826.0, "episode_reward_mean": 1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5271708707204238, "mean_raw_obs_processing_ms": 0.08305479703579749, "mean_inference_ms": 1.6345966468646052, "mean_action_processing_ms": 0.046626673108091106}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 232000, "timers": {"sample_time_ms": 10203.252, "sample_throughput": 392.032, "learn_time_ms": 12268.666, "learn_throughput": 326.034, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 4.746415160596371, "policy_loss": -0.024007418542169034, "vf_loss": 4.766715995967388, "vf_explained_var": 0.2881050705909729, "kl": 0.005491082949447446, "entropy": 0.14566585328429937, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 23, "training_iteration": 58, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-18-08", "timestamp": 1618139888, "time_this_iter_s": 24.07588768005371, "time_total_s": 1252.4560284614563, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33b2090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6bb1550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1252.4560284614563, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 58.22941176470588, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1826.0, "episode_reward_min": 1826.0, "episode_reward_mean": 1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5271708707204238, "mean_raw_obs_processing_ms": 0.08305479703579749, "mean_inference_ms": 1.6345966468646052, "mean_action_processing_ms": 0.046626673108091106}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 236000, "timers": {"sample_time_ms": 9998.918, "sample_throughput": 400.043, "learn_time_ms": 12274.538, "learn_throughput": 325.878, "update_time_ms": 3.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 5.0377698838710785, "policy_loss": -0.031148859416134655, "vf_loss": 5.063989095389843, "vf_explained_var": 0.21777856349945068, "kl": 0.007303184436750598, "entropy": 0.1655991228763014, "entropy_coeff": 0.0}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 23, "training_iteration": 59, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-18-30", "timestamp": 1618139910, "time_this_iter_s": 22.411697149276733, "time_total_s": 1274.867725610733, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33b2190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3dfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1274.867725610733, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 57.575, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2023.0, "episode_reward_min": 2023.0, "episode_reward_mean": 2023.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2023.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5383189947669575, "mean_raw_obs_processing_ms": 0.08331796977828551, "mean_inference_ms": 1.6349660748792214, "mean_action_processing_ms": 0.046687634962663975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"sample_time_ms": 10104.059, "sample_throughput": 395.88, "learn_time_ms": 12273.225, "learn_throughput": 325.913, "update_time_ms": 2.978}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.755913972854614, "policy_loss": -0.0316992164880503, "vf_loss": 6.783547267317772, "vf_explained_var": 0.32631808519363403, "kl": 0.006023538495355751, "entropy": 0.15583806531503797, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 24, "training_iteration": 60, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-18-54", "timestamp": 1618139934, "time_this_iter_s": 23.38982915878296, "time_total_s": 1298.257554769516, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d3d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1298.257554769516, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.73529411764706, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2023.0, "episode_reward_min": 2023.0, "episode_reward_mean": 2023.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2023.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5383189947669575, "mean_raw_obs_processing_ms": 0.08331796977828551, "mean_inference_ms": 1.6349660748792214, "mean_action_processing_ms": 0.046687634962663975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 244000, "timers": {"sample_time_ms": 10060.069, "sample_throughput": 397.612, "learn_time_ms": 12292.323, "learn_throughput": 325.406, "update_time_ms": 3.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.257786750793457, "policy_loss": -0.022110252029960975, "vf_loss": 8.276211231946945, "vf_explained_var": 0.36172470450401306, "kl": 0.005460409010993317, "entropy": 0.1737458328716457, "entropy_coeff": 0.0}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 24, "training_iteration": 61, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-19-16", "timestamp": 1618139956, "time_this_iter_s": 22.254176378250122, "time_total_s": 1320.511731147766, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2274b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ebd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1320.511731147766, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 57.646875, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2023.0, "episode_reward_min": 2023.0, "episode_reward_mean": 2023.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2023.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5383189947669575, "mean_raw_obs_processing_ms": 0.08331796977828551, "mean_inference_ms": 1.6349660748792214, "mean_action_processing_ms": 0.046687634962663975}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 248000, "timers": {"sample_time_ms": 10113.035, "sample_throughput": 395.529, "learn_time_ms": 12281.767, "learn_throughput": 325.686, "update_time_ms": 3.205}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.297333166003227, "policy_loss": -0.03132714275852777, "vf_loss": 6.324947878718376, "vf_explained_var": 0.457801878452301, "kl": 0.005499916231201496, "entropy": 0.15200355625711381, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 24, "training_iteration": 62, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-19-38", "timestamp": 1618139978, "time_this_iter_s": 21.23353886604309, "time_total_s": 1341.7452700138092, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ed90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ead0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1341.7452700138092, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.893333333333324, "ram_util_percent": 27.103333333333342}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5558650773034046, "mean_raw_obs_processing_ms": 0.08366631428215554, "mean_inference_ms": 1.6354208584321412, "mean_action_processing_ms": 0.04668897028221515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 252000, "timers": {"sample_time_ms": 10655.635, "sample_throughput": 375.388, "learn_time_ms": 12301.156, "learn_throughput": 325.173, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.408373549580574, "policy_loss": -0.026357957860454917, "vf_loss": 7.4308493584394455, "vf_explained_var": 0.29122740030288696, "kl": 0.005751411139499396, "entropy": 0.14403842412866652, "entropy_coeff": 0.0}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 25, "training_iteration": 63, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-20-04", "timestamp": 1618140004, "time_this_iter_s": 26.00779700279236, "time_total_s": 1367.7530670166016, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4edd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1367.7530670166016, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.83513513513515, "ram_util_percent": 27.100000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5558650773034046, "mean_raw_obs_processing_ms": 0.08366631428215554, "mean_inference_ms": 1.6354208584321412, "mean_action_processing_ms": 0.04668897028221515}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 256000, "timers": {"sample_time_ms": 10630.023, "sample_throughput": 376.293, "learn_time_ms": 12310.792, "learn_throughput": 324.918, "update_time_ms": 3.218}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 5.976139709353447, "policy_loss": -0.026986736222170293, "vf_loss": 5.999080330133438, "vf_explained_var": 0.37065616250038147, "kl": 0.005994254555844236, "entropy": 0.14832447981461883, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 25, "training_iteration": 64, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-20-27", "timestamp": 1618140027, "time_this_iter_s": 23.24114179611206, "time_total_s": 1390.9942088127136, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338af50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1390.9942088127136, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 58.303030303030305, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2111.0, "episode_reward_min": 2111.0, "episode_reward_mean": 2111.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2111.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5612075247443952, "mean_raw_obs_processing_ms": 0.0838800193545445, "mean_inference_ms": 1.6351322263555916, "mean_action_processing_ms": 0.046680256228093533}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 260000, "timers": {"sample_time_ms": 10584.546, "sample_throughput": 377.909, "learn_time_ms": 12319.393, "learn_throughput": 324.691, "update_time_ms": 3.265}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 4.065563268959522, "policy_loss": -0.022615266090724617, "vf_loss": 4.08475873619318, "vf_explained_var": 0.3082762360572815, "kl": 0.005066322803031653, "entropy": 0.14738708385266364, "entropy_coeff": 0.0}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 26, "training_iteration": 65, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-20-49", "timestamp": 1618140049, "time_this_iter_s": 21.710130214691162, "time_total_s": 1412.7043390274048, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1412.7043390274048, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.806451612903224, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2111.0, "episode_reward_min": 2111.0, "episode_reward_mean": 2111.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2111.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5612075247443952, "mean_raw_obs_processing_ms": 0.0838800193545445, "mean_inference_ms": 1.6351322263555916, "mean_action_processing_ms": 0.046680256228093533}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timers": {"sample_time_ms": 10677.785, "sample_throughput": 374.61, "learn_time_ms": 12316.298, "learn_throughput": 324.773, "update_time_ms": 3.308}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.63497893512249, "policy_loss": -0.027613739192020148, "vf_loss": 8.658141359686852, "vf_explained_var": 0.43317824602127075, "kl": 0.0065943937879637815, "entropy": 0.16196644911542535, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 26, "training_iteration": 66, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-21-11", "timestamp": 1618140071, "time_this_iter_s": 22.03191614151001, "time_total_s": 1434.7362551689148, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6927590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1434.7362551689148, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.8375, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2111.0, "episode_reward_min": 2111.0, "episode_reward_mean": 2111.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2111.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5612075247443952, "mean_raw_obs_processing_ms": 0.0838800193545445, "mean_inference_ms": 1.6351322263555916, "mean_action_processing_ms": 0.046680256228093533}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 268000, "timers": {"sample_time_ms": 10534.365, "sample_throughput": 379.71, "learn_time_ms": 12319.636, "learn_throughput": 324.685, "update_time_ms": 3.315}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.800715193152428, "policy_loss": -0.037109206488821656, "vf_loss": 8.833069682121277, "vf_explained_var": 0.4207257330417633, "kl": 0.007044084057270084, "entropy": 0.1748108770698309, "entropy_coeff": 0.0}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 26, "training_iteration": 67, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-21-33", "timestamp": 1618140093, "time_this_iter_s": 22.290971994400024, "time_total_s": 1457.0272271633148, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22800d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1457.0272271633148, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 57.928125, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1826.0, "episode_reward_min": 1826.0, "episode_reward_mean": 1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5630889528233801, "mean_raw_obs_processing_ms": 0.08420998278587387, "mean_inference_ms": 1.6354610002912007, "mean_action_processing_ms": 0.046683841061748735}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 272000, "timers": {"sample_time_ms": 10273.259, "sample_throughput": 389.36, "learn_time_ms": 12317.422, "learn_throughput": 324.743, "update_time_ms": 3.288}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.71647022664547, "policy_loss": -0.027203807199839503, "vf_loss": 10.739627048373222, "vf_explained_var": 0.5273281335830688, "kl": 0.0059955106626148336, "entropy": 0.1734100771136582, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 27, "training_iteration": 68, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-21-54", "timestamp": 1618140114, "time_this_iter_s": 21.442543506622314, "time_total_s": 1478.4697706699371, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68e7090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1478.4697706699371, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 58.129999999999995, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1826.0, "episode_reward_min": 1826.0, "episode_reward_mean": 1826.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1826.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5630889528233801, "mean_raw_obs_processing_ms": 0.08420998278587387, "mean_inference_ms": 1.6354610002912007, "mean_action_processing_ms": 0.046683841061748735}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 276000, "timers": {"sample_time_ms": 10066.04, "sample_throughput": 397.376, "learn_time_ms": 12321.875, "learn_throughput": 324.626, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.660848647356033, "policy_loss": -0.03199116938048974, "vf_loss": 9.68852861225605, "vf_explained_var": 0.37111803889274597, "kl": 0.006387250221450813, "entropy": 0.1991195259615779, "entropy_coeff": 0.0}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 27, "training_iteration": 69, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-22-15", "timestamp": 1618140135, "time_this_iter_s": 20.382533311843872, "time_total_s": 1498.852303981781, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22802d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2274250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1498.852303981781, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 57.97241379310344, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1668.0, "episode_reward_min": 1668.0, "episode_reward_mean": 1668.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1668.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5564972757282005, "mean_raw_obs_processing_ms": 0.08440644738818925, "mean_inference_ms": 1.6352650805891678, "mean_action_processing_ms": 0.046672435523456325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 280000, "timers": {"sample_time_ms": 9835.291, "sample_throughput": 406.699, "learn_time_ms": 12330.003, "learn_throughput": 324.412, "update_time_ms": 3.263}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.613015800714493, "policy_loss": -0.026937005924992263, "vf_loss": 8.636380895972252, "vf_explained_var": 0.4640635848045349, "kl": 0.0052917762150173075, "entropy": 0.16926408326253295, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 28, "training_iteration": 70, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-22-36", "timestamp": 1618140156, "time_this_iter_s": 21.16004776954651, "time_total_s": 1520.0123517513275, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2274c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1520.0123517513275, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.9483870967742, "ram_util_percent": 27.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1668.0, "episode_reward_min": 1668.0, "episode_reward_mean": 1668.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1668.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5564972757282005, "mean_raw_obs_processing_ms": 0.08440644738818925, "mean_inference_ms": 1.6352650805891678, "mean_action_processing_ms": 0.046672435523456325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 284000, "timers": {"sample_time_ms": 9913.235, "sample_throughput": 403.501, "learn_time_ms": 12327.402, "learn_throughput": 324.48, "update_time_ms": 3.072}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.3357928693294525, "policy_loss": -0.01797839134815149, "vf_loss": 7.3495403081178665, "vf_explained_var": 0.3268800973892212, "kl": 0.006267971970373765, "entropy": 0.15408809506334364, "entropy_coeff": 0.0}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 28, "training_iteration": 71, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-22-59", "timestamp": 1618140179, "time_this_iter_s": 23.003385305404663, "time_total_s": 1543.0157370567322, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2274050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6de71d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1543.0157370567322, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 57.690625000000004, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1668.0, "episode_reward_min": 1668.0, "episode_reward_mean": 1668.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1668.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5564972757282005, "mean_raw_obs_processing_ms": 0.08440644738818925, "mean_inference_ms": 1.6352650805891678, "mean_action_processing_ms": 0.046672435523456325}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timers": {"sample_time_ms": 9876.991, "sample_throughput": 404.982, "learn_time_ms": 12320.052, "learn_throughput": 324.674, "update_time_ms": 3.043}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.932276546955109, "policy_loss": -0.02370613522361964, "vf_loss": 11.951920539140701, "vf_explained_var": 0.5261692404747009, "kl": 0.006018177009536885, "entropy": 0.1892128731124103, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 28, "training_iteration": 72, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-23-20", "timestamp": 1618140200, "time_this_iter_s": 20.796224355697632, "time_total_s": 1563.8119614124298, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3de50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1563.8119614124298, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.870000000000005, "ram_util_percent": 27.103333333333342}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1829.0, "episode_reward_min": 1829.0, "episode_reward_mean": 1829.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1829.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5643430351996668, "mean_raw_obs_processing_ms": 0.08469679482660447, "mean_inference_ms": 1.6341058204136656, "mean_action_processing_ms": 0.04663914391541491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 292000, "timers": {"sample_time_ms": 9598.266, "sample_throughput": 416.742, "learn_time_ms": 12318.711, "learn_throughput": 324.709, "update_time_ms": 3.033}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.16192577779293, "policy_loss": -0.02353325963485986, "vf_loss": 11.181690871715546, "vf_explained_var": 0.4134264886379242, "kl": 0.005582541969488375, "entropy": 0.15448358934372663, "entropy_coeff": 0.0}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 29, "training_iteration": 73, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-23-43", "timestamp": 1618140223, "time_this_iter_s": 23.203527212142944, "time_total_s": 1587.0154886245728, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d29d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dca90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1587.0154886245728, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.37878787878788, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1829.0, "episode_reward_min": 1829.0, "episode_reward_mean": 1829.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1829.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5643430351996668, "mean_raw_obs_processing_ms": 0.08469679482660447, "mean_inference_ms": 1.6341058204136656, "mean_action_processing_ms": 0.04663914391541491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 296000, "timers": {"sample_time_ms": 9802.71, "sample_throughput": 408.05, "learn_time_ms": 12355.864, "learn_throughput": 323.733, "update_time_ms": 3.244}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.905451416969299, "policy_loss": -0.03004118736134842, "vf_loss": 7.931860327720642, "vf_explained_var": 0.3350815176963806, "kl": 0.005381041999498848, "entropy": 0.1396308180410415, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 29, "training_iteration": 74, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-24-09", "timestamp": 1618140249, "time_this_iter_s": 25.663085460662842, "time_total_s": 1612.6785740852356, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcc90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1612.6785740852356, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.9945945945946, "ram_util_percent": 27.100000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2078.0, "episode_reward_min": 2078.0, "episode_reward_mean": 2078.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2078.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5790378620935909, "mean_raw_obs_processing_ms": 0.08501221214369024, "mean_inference_ms": 1.6359972724359007, "mean_action_processing_ms": 0.04670008589875135}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 300000, "timers": {"sample_time_ms": 9977.043, "sample_throughput": 400.92, "learn_time_ms": 12349.474, "learn_throughput": 323.9, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.681344479322433, "policy_loss": -0.023020641587208956, "vf_loss": 8.700638562440872, "vf_explained_var": 0.31406018137931824, "kl": 0.005520739861822221, "entropy": 0.14499930758029222, "entropy_coeff": 0.0}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 30, "training_iteration": 75, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-24-32", "timestamp": 1618140272, "time_this_iter_s": 23.39009928703308, "time_total_s": 1636.0686733722687, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1636.0686733722687, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 58.521212121212116, "ram_util_percent": 27.1}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2078.0, "episode_reward_min": 2078.0, "episode_reward_mean": 2078.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2078.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5790378620935909, "mean_raw_obs_processing_ms": 0.08501221214369024, "mean_inference_ms": 1.6359972724359007, "mean_action_processing_ms": 0.04670008589875135}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 304000, "timers": {"sample_time_ms": 9961.322, "sample_throughput": 401.553, "learn_time_ms": 12330.133, "learn_throughput": 324.408, "update_time_ms": 3.154}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.893642604351044, "policy_loss": -0.033280687319347635, "vf_loss": 9.922034472227097, "vf_explained_var": 0.5719763040542603, "kl": 0.00724279455607757, "entropy": 0.18243544921278954, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 30, "training_iteration": 76, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-24-54", "timestamp": 1618140294, "time_this_iter_s": 21.679237127304077, "time_total_s": 1657.7479104995728, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1657.7479104995728, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.74516129032258, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2078.0, "episode_reward_min": 2078.0, "episode_reward_mean": 2078.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2078.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5790378620935909, "mean_raw_obs_processing_ms": 0.08501221214369024, "mean_inference_ms": 1.6359972724359007, "mean_action_processing_ms": 0.04670008589875135}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 308000, "timers": {"sample_time_ms": 9939.015, "sample_throughput": 402.454, "learn_time_ms": 12331.398, "learn_throughput": 324.375, "update_time_ms": 3.107}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 9.328869864344597, "policy_loss": -0.02608926792163402, "vf_loss": 9.350659370422363, "vf_explained_var": 0.29017722606658936, "kl": 0.006369944559992291, "entropy": 0.15394772053696215, "entropy_coeff": 0.0}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 30, "training_iteration": 77, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-25-16", "timestamp": 1618140316, "time_this_iter_s": 22.081109046936035, "time_total_s": 1679.8290195465088, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1679.8290195465088, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.834375, "ram_util_percent": 27.134375}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1923.0, "episode_reward_min": 1923.0, "episode_reward_mean": 1923.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1923.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5824294098783734, "mean_raw_obs_processing_ms": 0.08528686202563801, "mean_inference_ms": 1.6355794797206886, "mean_action_processing_ms": 0.046662756481395194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timers": {"sample_time_ms": 10031.848, "sample_throughput": 398.73, "learn_time_ms": 12349.58, "learn_throughput": 323.898, "update_time_ms": 3.17}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.578450843691826, "policy_loss": -0.021450328349601477, "vf_loss": 6.595905438065529, "vf_explained_var": 0.3685612976551056, "kl": 0.005919539340538904, "entropy": 0.14779270044527948, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 31, "training_iteration": 78, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-25-39", "timestamp": 1618140339, "time_this_iter_s": 22.556791067123413, "time_total_s": 1702.3858106136322, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3db90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1702.3858106136322, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.753125, "ram_util_percent": 27.162499999999998}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1923.0, "episode_reward_min": 1923.0, "episode_reward_mean": 1923.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1923.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5824294098783734, "mean_raw_obs_processing_ms": 0.08528686202563801, "mean_inference_ms": 1.6355794797206886, "mean_action_processing_ms": 0.046662756481395194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 316000, "timers": {"sample_time_ms": 10072.833, "sample_throughput": 397.108, "learn_time_ms": 12373.58, "learn_throughput": 323.269, "update_time_ms": 3.202}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 11.43737205862999, "policy_loss": -0.029199976241216063, "vf_loss": 11.462587639689445, "vf_explained_var": 0.37404629588127136, "kl": 0.005902704106119927, "entropy": 0.19273555045947433, "entropy_coeff": 0.0}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 31, "training_iteration": 79, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-26-00", "timestamp": 1618140360, "time_this_iter_s": 21.030625343322754, "time_total_s": 1723.416435956955, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3d8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1723.416435956955, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 58.62, "ram_util_percent": 27.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1755.0, "episode_reward_min": 1755.0, "episode_reward_mean": 1755.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1755.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5846068188408623, "mean_raw_obs_processing_ms": 0.08558130938259641, "mean_inference_ms": 1.637555556441977, "mean_action_processing_ms": 0.04671404366724177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 320000, "timers": {"sample_time_ms": 10376.709, "sample_throughput": 385.479, "learn_time_ms": 12413.206, "learn_throughput": 322.237, "update_time_ms": 3.18}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.745407283306122, "policy_loss": -0.016159275895915926, "vf_loss": 8.75787927210331, "vf_explained_var": 0.34014520049095154, "kl": 0.0054626131895929575, "entropy": 0.1451376259792596, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 32, "training_iteration": 80, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-26-24", "timestamp": 1618140384, "time_this_iter_s": 24.597880125045776, "time_total_s": 1748.0143160820007, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcc50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1748.0143160820007, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.47142857142857, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1755.0, "episode_reward_min": 1755.0, "episode_reward_mean": 1755.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1755.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5846068188408623, "mean_raw_obs_processing_ms": 0.08558130938259641, "mean_inference_ms": 1.637555556441977, "mean_action_processing_ms": 0.04671404366724177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 324000, "timers": {"sample_time_ms": 10225.217, "sample_throughput": 391.19, "learn_time_ms": 12462.423, "learn_throughput": 320.965, "update_time_ms": 3.171}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 12.914459615945816, "policy_loss": -0.025718593795318156, "vf_loss": 12.936230659484863, "vf_explained_var": 0.5262041091918945, "kl": 0.005847870241268538, "entropy": 0.18565434962511063, "entropy_coeff": 0.0}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 32, "training_iteration": 81, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-26-46", "timestamp": 1618140406, "time_this_iter_s": 21.983813524246216, "time_total_s": 1769.998129606247, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3394510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2274310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1769.998129606247, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 58.303124999999994, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1755.0, "episode_reward_min": 1755.0, "episode_reward_mean": 1755.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1755.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5846068188408623, "mean_raw_obs_processing_ms": 0.08558130938259641, "mean_inference_ms": 1.637555556441977, "mean_action_processing_ms": 0.04671404366724177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 328000, "timers": {"sample_time_ms": 10150.279, "sample_throughput": 394.078, "learn_time_ms": 12467.067, "learn_throughput": 320.845, "update_time_ms": 3.209}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 13.688760489225388, "policy_loss": -0.035566534294048324, "vf_loss": 13.718881994485855, "vf_explained_var": 0.4878717362880707, "kl": 0.008066492940997705, "entropy": 0.22586225718259811, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 32, "training_iteration": 82, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-27-06", "timestamp": 1618140426, "time_this_iter_s": 20.09362006187439, "time_total_s": 1790.0917496681213, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1790.0917496681213, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 57.65357142857143, "ram_util_percent": 27.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1570.0, "episode_reward_min": 1570.0, "episode_reward_mean": 1570.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1570.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5771192063672027, "mean_raw_obs_processing_ms": 0.08587621192548707, "mean_inference_ms": 1.6371481212528975, "mean_action_processing_ms": 0.046688525916674765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 332000, "timers": {"sample_time_ms": 9959.356, "sample_throughput": 401.632, "learn_time_ms": 12474.177, "learn_throughput": 320.662, "update_time_ms": 3.326}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 8.136823832988739, "policy_loss": -0.03377590925083496, "vf_loss": 8.16620621085167, "vf_explained_var": 0.39930427074432373, "kl": 0.0065089567433460616, "entropy": 0.1752980810124427, "entropy_coeff": 0.0}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 33, "training_iteration": 83, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-27-28", "timestamp": 1618140448, "time_this_iter_s": 21.368412733078003, "time_total_s": 1811.4601624011993, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcf90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1811.4601624011993, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 58.435483870967744, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1570.0, "episode_reward_min": 1570.0, "episode_reward_mean": 1570.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1570.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5771192063672027, "mean_raw_obs_processing_ms": 0.08587621192548707, "mean_inference_ms": 1.6371481212528975, "mean_action_processing_ms": 0.046688525916674765}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timers": {"sample_time_ms": 9705.504, "sample_throughput": 412.137, "learn_time_ms": 12422.322, "learn_throughput": 322.001, "update_time_ms": 3.121}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 10.229053914546967, "policy_loss": -0.0281278086185921, "vf_loss": 10.25323024392128, "vf_explained_var": 0.2744980752468109, "kl": 0.00585398668772541, "entropy": 0.15341163612902164, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 33, "training_iteration": 84, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-27-50", "timestamp": 1618140470, "time_this_iter_s": 22.60159945487976, "time_total_s": 1834.061761856079, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f42d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1834.061761856079, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.884375, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5870464428374043, "mean_raw_obs_processing_ms": 0.08606441022346997, "mean_inference_ms": 1.6369133172932273, "mean_action_processing_ms": 0.04667698581256004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 340000, "timers": {"sample_time_ms": 9799.01, "sample_throughput": 408.204, "learn_time_ms": 12400.176, "learn_throughput": 322.576, "update_time_ms": 3.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 6.284150376915932, "policy_loss": -0.03175306675257161, "vf_loss": 6.312051624059677, "vf_explained_var": 0.27157485485076904, "kl": 0.005706485470000189, "entropy": 0.1422031233087182, "entropy_coeff": 0.0}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 34, "training_iteration": 85, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-28-15", "timestamp": 1618140495, "time_this_iter_s": 24.10575294494629, "time_total_s": 1858.1675148010254, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f48d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6927590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1858.1675148010254, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.379999999999995, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5870464428374043, "mean_raw_obs_processing_ms": 0.08606441022346997, "mean_inference_ms": 1.6369133172932273, "mean_action_processing_ms": 0.04667698581256004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 344000, "timers": {"sample_time_ms": 9863.097, "sample_throughput": 405.552, "learn_time_ms": 12409.185, "learn_throughput": 322.342, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 7.691575914621353, "policy_loss": -0.03696702484739944, "vf_loss": 7.723110377788544, "vf_explained_var": 0.43108057975769043, "kl": 0.008048206873354502, "entropy": 0.1607624616008252, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 34, "training_iteration": 86, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-28-37", "timestamp": 1618140517, "time_this_iter_s": 22.409406185150146, "time_total_s": 1880.5769209861755, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33b2690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1880.5769209861755, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 58.315625, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2130.0, "episode_reward_min": 2130.0, "episode_reward_mean": 2130.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2130.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5870464428374043, "mean_raw_obs_processing_ms": 0.08606441022346997, "mean_inference_ms": 1.6369133172932273, "mean_action_processing_ms": 0.04667698581256004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 348000, "timers": {"sample_time_ms": 9933.155, "sample_throughput": 402.692, "learn_time_ms": 12392.21, "learn_throughput": 322.783, "update_time_ms": 3.1}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 13.310240149497986, "policy_loss": -0.06354596460005268, "vf_loss": 13.3525952398777, "vf_explained_var": 0.470762699842453, "kl": 0.03139384702080861, "entropy": 0.2033384758979082, "entropy_coeff": 0.0}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 34, "training_iteration": 87, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-29-00", "timestamp": 1618140540, "time_this_iter_s": 22.612602472305298, "time_total_s": 1903.1895234584808, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1903.1895234584808, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.809375, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2011.0, "episode_reward_min": 2011.0, "episode_reward_mean": 2011.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2011.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5964498637128627, "mean_raw_obs_processing_ms": 0.08634556954586524, "mean_inference_ms": 1.6360814055104258, "mean_action_processing_ms": 0.046638039286763334}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 352000, "timers": {"sample_time_ms": 10021.042, "sample_throughput": 399.16, "learn_time_ms": 12324.917, "learn_throughput": 324.546, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 8.312703549861908, "policy_loss": -0.02608966635307297, "vf_loss": 8.331985712051392, "vf_explained_var": 0.4466158151626587, "kl": 0.006723544174747076, "entropy": 0.1574433990754187, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 35, "training_iteration": 88, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-29-22", "timestamp": 1618140562, "time_this_iter_s": 22.75936222076416, "time_total_s": 1925.948885679245, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d8d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1925.948885679245, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 57.3625, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2011.0, "episode_reward_min": 2011.0, "episode_reward_mean": 2011.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2011.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5964498637128627, "mean_raw_obs_processing_ms": 0.08634556954586524, "mean_inference_ms": 1.6360814055104258, "mean_action_processing_ms": 0.046638039286763334}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 356000, "timers": {"sample_time_ms": 10169.775, "sample_throughput": 393.322, "learn_time_ms": 12242.625, "learn_throughput": 326.727, "update_time_ms": 3.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 7.804363280534744, "policy_loss": -0.03258061013184488, "vf_loss": 7.831291392445564, "vf_explained_var": 0.30310332775115967, "kl": 0.005582712969044223, "entropy": 0.14848459558561444, "entropy_coeff": 0.0}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 35, "training_iteration": 89, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-29-44", "timestamp": 1618140584, "time_this_iter_s": 21.698399305343628, "time_total_s": 1947.6472849845886, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4da50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1947.6472849845886, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 57.21935483870968, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1961.0, "episode_reward_min": 1961.0, "episode_reward_mean": 1961.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1961.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5995705645738594, "mean_raw_obs_processing_ms": 0.08646954981513906, "mean_inference_ms": 1.635024434467471, "mean_action_processing_ms": 0.046596446673298764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timers": {"sample_time_ms": 9965.711, "sample_throughput": 401.376, "learn_time_ms": 12212.846, "learn_throughput": 327.524, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 10.446917548775673, "policy_loss": -0.05073092333623208, "vf_loss": 10.474738880991936, "vf_explained_var": 0.44738316535949707, "kl": 0.022626774123637006, "entropy": 0.1692789881490171, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 36, "training_iteration": 90, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-30-06", "timestamp": 1618140606, "time_this_iter_s": 22.25730848312378, "time_total_s": 1969.9045934677124, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1969.9045934677124, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 58.0125, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1961.0, "episode_reward_min": 1961.0, "episode_reward_mean": 1961.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1961.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5995705645738594, "mean_raw_obs_processing_ms": 0.08646954981513906, "mean_inference_ms": 1.635024434467471, "mean_action_processing_ms": 0.046596446673298764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 364000, "timers": {"sample_time_ms": 9916.162, "sample_throughput": 403.382, "learn_time_ms": 12227.449, "learn_throughput": 327.133, "update_time_ms": 3.143}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": 10.211450010538101, "policy_loss": -0.02834049251396209, "vf_loss": 10.234421640634537, "vf_explained_var": 0.40005195140838623, "kl": 0.003535018302500248, "entropy": 0.16007794137112796, "entropy_coeff": 0.0}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 36, "training_iteration": 91, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-30-28", "timestamp": 1618140628, "time_this_iter_s": 21.63499140739441, "time_total_s": 1991.5395848751068, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1991.5395848751068, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 58.60967741935484, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1961.0, "episode_reward_min": 1961.0, "episode_reward_mean": 1961.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1961.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5995705645738594, "mean_raw_obs_processing_ms": 0.08646954981513906, "mean_inference_ms": 1.635024434467471, "mean_action_processing_ms": 0.046596446673298764}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 368000, "timers": {"sample_time_ms": 10005.456, "sample_throughput": 399.782, "learn_time_ms": 12293.807, "learn_throughput": 325.367, "update_time_ms": 3.261}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 8.609953835606575, "policy_loss": -0.03512642823625356, "vf_loss": 8.640754967927933, "vf_explained_var": 0.4029756784439087, "kl": 0.005695666732208338, "entropy": 0.16343074548058212, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 36, "training_iteration": 92, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-30-50", "timestamp": 1618140650, "time_this_iter_s": 21.654746770858765, "time_total_s": 2013.1943316459656, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d20d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2013.1943316459656, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 58.56129032258065, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1712.0, "episode_reward_min": 1712.0, "episode_reward_mean": 1712.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1712.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5875997981895785, "mean_raw_obs_processing_ms": 0.08697746850473646, "mean_inference_ms": 1.6386506724107202, "mean_action_processing_ms": 0.046688824041478456}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 372000, "timers": {"sample_time_ms": 9947.871, "sample_throughput": 402.096, "learn_time_ms": 12326.22, "learn_throughput": 324.511, "update_time_ms": 3.127}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 10.699915945529938, "policy_loss": -0.03398794401437044, "vf_loss": 10.728691637516022, "vf_explained_var": 0.5851553082466125, "kl": 0.006863913527922705, "entropy": 0.2347076698206365, "entropy_coeff": 0.0}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 37, "training_iteration": 93, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-31-11", "timestamp": 1618140671, "time_this_iter_s": 21.117411136627197, "time_total_s": 2034.3117427825928, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2274e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2034.3117427825928, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 58.40333333333333, "ram_util_percent": 27.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1712.0, "episode_reward_min": 1712.0, "episode_reward_mean": 1712.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1712.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5875997981895785, "mean_raw_obs_processing_ms": 0.08697746850473646, "mean_inference_ms": 1.6386506724107202, "mean_action_processing_ms": 0.046688824041478456}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 376000, "timers": {"sample_time_ms": 10009.743, "sample_throughput": 399.611, "learn_time_ms": 12385.401, "learn_throughput": 322.961, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 12.515075147151947, "policy_loss": -0.019360589736606926, "vf_loss": 12.5303995013237, "vf_explained_var": 0.3958761990070343, "kl": 0.005315349553711712, "entropy": 0.15830759587697685, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 37, "training_iteration": 94, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-31-35", "timestamp": 1618140695, "time_this_iter_s": 23.812748432159424, "time_total_s": 2058.124491214752, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d29d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2058.124491214752, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 58.57941176470588, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1886.0, "episode_reward_min": 1886.0, "episode_reward_mean": 1886.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1886.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5924742240548084, "mean_raw_obs_processing_ms": 0.08730317405898183, "mean_inference_ms": 1.640815905470148, "mean_action_processing_ms": 0.046737917452715494}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 380000, "timers": {"sample_time_ms": 9905.931, "sample_throughput": 403.799, "learn_time_ms": 12429.458, "learn_throughput": 321.816, "update_time_ms": 3.135}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 7.891297087073326, "policy_loss": -0.02359967163647525, "vf_loss": 7.910387098789215, "vf_explained_var": 0.3291563391685486, "kl": 0.005938707501627505, "entropy": 0.14349821931682527, "entropy_coeff": 0.0}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 38, "training_iteration": 95, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-31-58", "timestamp": 1618140718, "time_this_iter_s": 23.50805401802063, "time_total_s": 2081.632545232773, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2081.632545232773, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 58.3029411764706, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1886.0, "episode_reward_min": 1886.0, "episode_reward_mean": 1886.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1886.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5924742240548084, "mean_raw_obs_processing_ms": 0.08730317405898183, "mean_inference_ms": 1.640815905470148, "mean_action_processing_ms": 0.046737917452715494}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timers": {"sample_time_ms": 9869.926, "sample_throughput": 405.272, "learn_time_ms": 12454.173, "learn_throughput": 321.177, "update_time_ms": 3.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 9.061327770352364, "policy_loss": -0.03174362346180715, "vf_loss": 9.087778106331825, "vf_explained_var": 0.4583788514137268, "kl": 0.006970695227209944, "entropy": 0.15615179436281323, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 38, "training_iteration": 96, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-32-21", "timestamp": 1618140741, "time_this_iter_s": 22.296446800231934, "time_total_s": 2103.9289920330048, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e55d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2103.9289920330048, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 58.209375, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1886.0, "episode_reward_min": 1886.0, "episode_reward_mean": 1886.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1886.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5924742240548084, "mean_raw_obs_processing_ms": 0.08730317405898183, "mean_inference_ms": 1.640815905470148, "mean_action_processing_ms": 0.046737917452715494}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 388000, "timers": {"sample_time_ms": 9673.801, "sample_throughput": 413.488, "learn_time_ms": 12474.075, "learn_throughput": 320.665, "update_time_ms": 3.204}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 5e-05, "total_loss": 11.479506641626358, "policy_loss": -0.02757881602155976, "vf_loss": 11.503392726182938, "vf_explained_var": 0.48787954449653625, "kl": 0.0048627440992277116, "entropy": 0.18224914837628603, "entropy_coeff": 0.0}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 38, "training_iteration": 97, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-32-42", "timestamp": 1618140762, "time_this_iter_s": 20.84996247291565, "time_total_s": 2124.7789545059204, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f46d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2124.7789545059204, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 58.282758620689656, "ram_util_percent": 27.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1719.0, "episode_reward_min": 1719.0, "episode_reward_mean": 1719.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1719.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5903831074151281, "mean_raw_obs_processing_ms": 0.08770791859427655, "mean_inference_ms": 1.6422224044921447, "mean_action_processing_ms": 0.046770210066328755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 392000, "timers": {"sample_time_ms": 9599.644, "sample_throughput": 416.682, "learn_time_ms": 12541.133, "learn_throughput": 318.95, "update_time_ms": 3.246}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 10.31936252117157, "policy_loss": -0.038601272157393396, "vf_loss": 10.354084715247154, "vf_explained_var": 0.6890957951545715, "kl": 0.010216525115538388, "entropy": 0.19388615665957332, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 39, "training_iteration": 98, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-33-04", "timestamp": 1618140784, "time_this_iter_s": 22.691378355026245, "time_total_s": 2147.4703328609467, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2147.4703328609467, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 58.09090909090909, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1719.0, "episode_reward_min": 1719.0, "episode_reward_mean": 1719.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1719.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5903831074151281, "mean_raw_obs_processing_ms": 0.08770791859427655, "mean_inference_ms": 1.6422224044921447, "mean_action_processing_ms": 0.046770210066328755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 396000, "timers": {"sample_time_ms": 9746.859, "sample_throughput": 410.389, "learn_time_ms": 12621.141, "learn_throughput": 316.929, "update_time_ms": 3.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 14.378911912441254, "policy_loss": -0.0334771015914157, "vf_loss": 14.4095938205719, "vf_explained_var": 0.35107067227363586, "kl": 0.007361227202636655, "entropy": 0.1516049294732511, "entropy_coeff": 0.0}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 39, "training_iteration": 99, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-33-28", "timestamp": 1618140808, "time_this_iter_s": 23.969931840896606, "time_total_s": 2171.4402647018433, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2171.4402647018433, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 58.05588235294118, "ram_util_percent": 27.232352941176465}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2114.0, "episode_reward_min": 2114.0, "episode_reward_mean": 2114.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2114.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989940295439636, "mean_raw_obs_processing_ms": 0.08790859060564446, "mean_inference_ms": 1.6419571668699307, "mean_action_processing_ms": 0.04676000706810672}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 400000, "timers": {"sample_time_ms": 9865.95, "sample_throughput": 405.435, "learn_time_ms": 12618.755, "learn_throughput": 316.988, "update_time_ms": 3.193}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 4.95275616645813, "policy_loss": -0.01810784259578213, "vf_loss": 4.968346193432808, "vf_explained_var": 0.278166264295578, "kl": 0.006631429961998947, "entropy": 0.12095067230984569, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 40, "training_iteration": 100, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-33-52", "timestamp": 1618140832, "time_this_iter_s": 23.424330472946167, "time_total_s": 2194.8645951747894, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2194.8645951747894, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.80909090909091, "ram_util_percent": 27.26060606060606}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2114.0, "episode_reward_min": 2114.0, "episode_reward_mean": 2114.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2114.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989940295439636, "mean_raw_obs_processing_ms": 0.08790859060564446, "mean_inference_ms": 1.6419571668699307, "mean_action_processing_ms": 0.04676000706810672}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 404000, "timers": {"sample_time_ms": 10309.378, "sample_throughput": 387.996, "learn_time_ms": 12533.823, "learn_throughput": 319.136, "update_time_ms": 3.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 6.4916956424713135, "policy_loss": -0.01966472784988582, "vf_loss": 6.50851583480835, "vf_explained_var": 0.24884381890296936, "kl": 0.007491813550586812, "entropy": 0.12126852851361036, "entropy_coeff": 0.0}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 40, "training_iteration": 101, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-34-17", "timestamp": 1618140857, "time_this_iter_s": 25.218222618103027, "time_total_s": 2220.0828177928925, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ed50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2220.0828177928925, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 57.862162162162164, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2114.0, "episode_reward_min": 2114.0, "episode_reward_mean": 2114.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2114.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5989940295439636, "mean_raw_obs_processing_ms": 0.08790859060564446, "mean_inference_ms": 1.6419571668699307, "mean_action_processing_ms": 0.04676000706810672}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timers": {"sample_time_ms": 10582.661, "sample_throughput": 377.977, "learn_time_ms": 12489.241, "learn_throughput": 320.276, "update_time_ms": 3.072}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 6.317055985331535, "policy_loss": -0.028142826980911195, "vf_loss": 6.342339918017387, "vf_explained_var": 0.3127816915512085, "kl": 0.007529659793362953, "entropy": 0.1332676662132144, "entropy_coeff": 0.0}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 40, "training_iteration": 102, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-34-41", "timestamp": 1618140881, "time_this_iter_s": 23.938394784927368, "time_total_s": 2244.02121257782, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2244.02121257782, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 58.32941176470588, "ram_util_percent": 27.299999999999997}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2255.0, "episode_reward_min": 2255.0, "episode_reward_mean": 2255.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2255.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6183862838351241, "mean_raw_obs_processing_ms": 0.088284841849118, "mean_inference_ms": 1.6426884677023499, "mean_action_processing_ms": 0.04677395150258015}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 412000, "timers": {"sample_time_ms": 11007.82, "sample_throughput": 363.378, "learn_time_ms": 12454.166, "learn_throughput": 321.178, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 6.252859979867935, "policy_loss": -0.022782460786402225, "vf_loss": 6.272949621081352, "vf_explained_var": 0.3456384241580963, "kl": 0.007092181505868211, "entropy": 0.12994906958192587, "entropy_coeff": 0.0}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 41, "training_iteration": 103, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-35-06", "timestamp": 1618140906, "time_this_iter_s": 25.01491069793701, "time_total_s": 2269.036123275757, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4eb10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2269.036123275757, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 57.96857142857142, "ram_util_percent": 27.299999999999997}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2255.0, "episode_reward_min": 2255.0, "episode_reward_mean": 2255.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2255.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6183862838351241, "mean_raw_obs_processing_ms": 0.088284841849118, "mean_inference_ms": 1.6426884677023499, "mean_action_processing_ms": 0.04677395150258015}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 416000, "timers": {"sample_time_ms": 10930.141, "sample_throughput": 365.961, "learn_time_ms": 12413.537, "learn_throughput": 322.229, "update_time_ms": 3.156}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 11.37228775024414, "policy_loss": -0.03876467634108849, "vf_loss": 11.406034022569656, "vf_explained_var": 0.5632308721542358, "kl": 0.01321752104558982, "entropy": 0.19476900855079293, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 41, "training_iteration": 104, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-35-29", "timestamp": 1618140929, "time_this_iter_s": 22.62770414352417, "time_total_s": 2291.663827419281, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2274950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2291.663827419281, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 58.690909090909095, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1922.0, "episode_reward_min": 1922.0, "episode_reward_mean": 1922.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1922.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6191392973159431, "mean_raw_obs_processing_ms": 0.08851619660068838, "mean_inference_ms": 1.643049743374126, "mean_action_processing_ms": 0.04677947804624019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 420000, "timers": {"sample_time_ms": 10811.054, "sample_throughput": 369.992, "learn_time_ms": 12385.998, "learn_throughput": 322.945, "update_time_ms": 3.132}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 7.0183079689741135, "policy_loss": -0.035783317289315164, "vf_loss": 7.0506685227155685, "vf_explained_var": 0.25735875964164734, "kl": 0.009014672046760097, "entropy": 0.14212907198816538, "entropy_coeff": 0.0}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 42, "training_iteration": 105, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-35-51", "timestamp": 1618140951, "time_this_iter_s": 22.04309630393982, "time_total_s": 2313.706923723221, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2313.706923723221, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.906451612903226, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1922.0, "episode_reward_min": 1922.0, "episode_reward_mean": 1922.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1922.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6191392973159431, "mean_raw_obs_processing_ms": 0.08851619660068838, "mean_inference_ms": 1.643049743374126, "mean_action_processing_ms": 0.04677947804624019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 424000, "timers": {"sample_time_ms": 10732.889, "sample_throughput": 372.686, "learn_time_ms": 12379.644, "learn_throughput": 323.111, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 7.673274353146553, "policy_loss": -0.02935582830104977, "vf_loss": 7.699348270893097, "vf_explained_var": 0.3878841996192932, "kl": 0.008643809807836078, "entropy": 0.1510806162841618, "entropy_coeff": 0.0}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 42, "training_iteration": 106, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-36-12", "timestamp": 1618140972, "time_this_iter_s": 21.454782247543335, "time_total_s": 2335.161705970764, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3dbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2335.161705970764, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 57.964516129032255, "ram_util_percent": 27.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1922.0, "episode_reward_min": 1922.0, "episode_reward_mean": 1922.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1922.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6191392973159431, "mean_raw_obs_processing_ms": 0.08851619660068838, "mean_inference_ms": 1.643049743374126, "mean_action_processing_ms": 0.04677947804624019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 428000, "timers": {"sample_time_ms": 10964.818, "sample_throughput": 364.803, "learn_time_ms": 12360.198, "learn_throughput": 323.619, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 7.6507032215595245, "policy_loss": -0.03362900868523866, "vf_loss": 7.6807214468717575, "vf_explained_var": 0.35018375515937805, "kl": 0.009509654104476795, "entropy": 0.14768318203277886, "entropy_coeff": 0.0}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 42, "training_iteration": 107, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-36-35", "timestamp": 1618140995, "time_this_iter_s": 22.975321054458618, "time_total_s": 2358.137027025223, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2309b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2358.137027025223, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.7060606060606, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2074.0, "episode_reward_min": 2074.0, "episode_reward_mean": 2074.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2074.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6279771681587187, "mean_raw_obs_processing_ms": 0.08881231893772076, "mean_inference_ms": 1.6419098853683032, "mean_action_processing_ms": 0.046741696392560365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timers": {"sample_time_ms": 11199.68, "sample_throughput": 357.153, "learn_time_ms": 12342.258, "learn_throughput": 324.09, "update_time_ms": 3.165}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 5.746682792901993, "policy_loss": -0.028004156076349318, "vf_loss": 5.771713092923164, "vf_explained_var": 0.24386349320411682, "kl": 0.007832427130779251, "entropy": 0.11744454456493258, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 43, "training_iteration": 108, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-37-00", "timestamp": 1618141020, "time_this_iter_s": 24.85771083831787, "time_total_s": 2382.9947378635406, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6de7050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2382.9947378635406, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 58.79428571428572, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2074.0, "episode_reward_min": 2074.0, "episode_reward_mean": 2074.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2074.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6279771681587187, "mean_raw_obs_processing_ms": 0.08881231893772076, "mean_inference_ms": 1.6419098853683032, "mean_action_processing_ms": 0.046741696392560365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 436000, "timers": {"sample_time_ms": 11185.31, "sample_throughput": 357.612, "learn_time_ms": 12311.959, "learn_throughput": 324.887, "update_time_ms": 3.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 5e-05, "total_loss": 10.44423496723175, "policy_loss": -0.04445337309152819, "vf_loss": 10.479554504156113, "vf_explained_var": 0.4693544805049896, "kl": 0.024056407128227875, "entropy": 0.16075652046129107, "entropy_coeff": 0.0}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 43, "training_iteration": 109, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-37-24", "timestamp": 1618141044, "time_this_iter_s": 23.52279305458069, "time_total_s": 2406.5175309181213, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2406.5175309181213, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 57.66764705882354, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2201.0, "episode_reward_min": 2201.0, "episode_reward_mean": 2201.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2201.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6406389810634522, "mean_raw_obs_processing_ms": 0.08901034629537219, "mean_inference_ms": 1.640953100455808, "mean_action_processing_ms": 0.04670864565250045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 440000, "timers": {"sample_time_ms": 11410.703, "sample_throughput": 350.548, "learn_time_ms": 12299.221, "learn_throughput": 325.224, "update_time_ms": 3.096}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.648277133703232, "policy_loss": -0.027482985140522942, "vf_loss": 6.672351628541946, "vf_explained_var": 0.3426211476325989, "kl": 0.005984641298709903, "entropy": 0.12324399896897376, "entropy_coeff": 0.0}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 44, "training_iteration": 110, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-37-49", "timestamp": 1618141069, "time_this_iter_s": 25.553005695343018, "time_total_s": 2432.0705366134644, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2432.0705366134644, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 58.13333333333334, "ram_util_percent": 27.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2201.0, "episode_reward_min": 2201.0, "episode_reward_mean": 2201.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2201.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6406389810634522, "mean_raw_obs_processing_ms": 0.08901034629537219, "mean_inference_ms": 1.640953100455808, "mean_action_processing_ms": 0.04670864565250045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 444000, "timers": {"sample_time_ms": 11150.194, "sample_throughput": 358.738, "learn_time_ms": 12307.61, "learn_throughput": 325.002, "update_time_ms": 3.126}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.8775574415922165, "policy_loss": -0.01778058084892109, "vf_loss": 5.89150758087635, "vf_explained_var": 0.3196950852870941, "kl": 0.006725848026690073, "entropy": 0.12089231261052191, "entropy_coeff": 0.0}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 44, "training_iteration": 111, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-38-12", "timestamp": 1618141092, "time_this_iter_s": 22.6968936920166, "time_total_s": 2454.767430305481, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3373dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2454.767430305481, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 57.57575757575758, "ram_util_percent": 27.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2201.0, "episode_reward_min": 2201.0, "episode_reward_mean": 2201.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2201.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6406389810634522, "mean_raw_obs_processing_ms": 0.08901034629537219, "mean_inference_ms": 1.640953100455808, "mean_action_processing_ms": 0.04670864565250045}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 448000, "timers": {"sample_time_ms": 10996.935, "sample_throughput": 363.738, "learn_time_ms": 12270.756, "learn_throughput": 325.978, "update_time_ms": 3.078}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.876240760087967, "policy_loss": -0.02611880865879357, "vf_loss": 7.897755712270737, "vf_explained_var": 0.47859981656074524, "kl": 0.00808382393734064, "entropy": 0.15353312040679157, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 44, "training_iteration": 112, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-38-34", "timestamp": 1618141114, "time_this_iter_s": 22.033382415771484, "time_total_s": 2476.8008127212524, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d08d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2476.8008127212524, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 57.81290322580645, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2086.0, "episode_reward_min": 2086.0, "episode_reward_mean": 2086.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2086.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6435689001359707, "mean_raw_obs_processing_ms": 0.0892610906562185, "mean_inference_ms": 1.6398094539835641, "mean_action_processing_ms": 0.04667285756719155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 452000, "timers": {"sample_time_ms": 10704.732, "sample_throughput": 373.667, "learn_time_ms": 12255.94, "learn_throughput": 326.372, "update_time_ms": 3.075}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.815374031662941, "policy_loss": -0.032453104213345796, "vf_loss": 9.843916326761246, "vf_explained_var": 0.4589017927646637, "kl": 0.006866601572255604, "entropy": 0.14789733453653753, "entropy_coeff": 0.0}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 45, "training_iteration": 113, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-38-56", "timestamp": 1618141136, "time_this_iter_s": 21.94535779953003, "time_total_s": 2498.7461705207825, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2498.7461705207825, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.883870967741935, "ram_util_percent": 27.225806451612915}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2086.0, "episode_reward_min": 2086.0, "episode_reward_mean": 2086.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2086.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6435689001359707, "mean_raw_obs_processing_ms": 0.0892610906562185, "mean_inference_ms": 1.6398094539835641, "mean_action_processing_ms": 0.04667285756719155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timers": {"sample_time_ms": 10717.496, "sample_throughput": 373.222, "learn_time_ms": 12246.945, "learn_throughput": 326.612, "update_time_ms": 3.037}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.32164940237999, "policy_loss": -0.032993811677442864, "vf_loss": 9.35052090883255, "vf_explained_var": 0.4420399069786072, "kl": 0.007238026715640444, "entropy": 0.136848651105538, "entropy_coeff": 0.0}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 45, "training_iteration": 114, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-39-19", "timestamp": 1618141159, "time_this_iter_s": 22.6641685962677, "time_total_s": 2521.41033911705, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2521.41033911705, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 58.32424242424243, "ram_util_percent": 27.236363636363635}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2051.0, "episode_reward_min": 2051.0, "episode_reward_mean": 2051.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2051.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465308703821556, "mean_raw_obs_processing_ms": 0.08940943375341497, "mean_inference_ms": 1.6388984788819783, "mean_action_processing_ms": 0.04663999100234155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 460000, "timers": {"sample_time_ms": 10765.578, "sample_throughput": 371.555, "learn_time_ms": 12218.615, "learn_throughput": 327.369, "update_time_ms": 3.068}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.0986286997795105, "policy_loss": -0.02562220545951277, "vf_loss": 6.118959382176399, "vf_explained_var": 0.2696167230606079, "kl": 0.0092909834056627, "entropy": 0.14069912512786686, "entropy_coeff": 0.0}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 46, "training_iteration": 115, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-39-41", "timestamp": 1618141181, "time_this_iter_s": 22.237024068832397, "time_total_s": 2543.6473631858826, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68e7090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2543.6473631858826, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 57.865624999999994, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2051.0, "episode_reward_min": 2051.0, "episode_reward_mean": 2051.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2051.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465308703821556, "mean_raw_obs_processing_ms": 0.08940943375341497, "mean_inference_ms": 1.6388984788819783, "mean_action_processing_ms": 0.04663999100234155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 464000, "timers": {"sample_time_ms": 10672.902, "sample_throughput": 374.781, "learn_time_ms": 12195.277, "learn_throughput": 327.996, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.890810400247574, "policy_loss": -0.027727400534786284, "vf_loss": 7.914327189326286, "vf_explained_var": 0.4613860845565796, "kl": 0.007393225678242743, "entropy": 0.14250821294263005, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 46, "training_iteration": 116, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-40-01", "timestamp": 1618141201, "time_this_iter_s": 20.292979955673218, "time_total_s": 2563.940343141556, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f25d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e09d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2563.940343141556, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 58.34827586206895, "ram_util_percent": 27.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2051.0, "episode_reward_min": 2051.0, "episode_reward_mean": 2051.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2051.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6465308703821556, "mean_raw_obs_processing_ms": 0.08940943375341497, "mean_inference_ms": 1.6388984788819783, "mean_action_processing_ms": 0.04663999100234155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 468000, "timers": {"sample_time_ms": 10419.611, "sample_throughput": 383.891, "learn_time_ms": 12202.399, "learn_throughput": 327.804, "update_time_ms": 3.03}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.802363589406013, "policy_loss": -0.028622824931517243, "vf_loss": 9.827338606119156, "vf_explained_var": 0.35764196515083313, "kl": 0.00640468297933694, "entropy": 0.13872403651475906, "entropy_coeff": 0.0}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 46, "training_iteration": 117, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-40-22", "timestamp": 1618141222, "time_this_iter_s": 20.513919830322266, "time_total_s": 2584.454262971878, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f22d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ed50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2584.454262971878, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 57.80344827586207, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1948.0, "episode_reward_min": 1948.0, "episode_reward_mean": 1948.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1948.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.637192613199845, "mean_raw_obs_processing_ms": 0.08963823067435295, "mean_inference_ms": 1.6375269459032307, "mean_action_processing_ms": 0.046588155978368004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 472000, "timers": {"sample_time_ms": 9952.985, "sample_throughput": 401.89, "learn_time_ms": 12199.874, "learn_throughput": 327.872, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.947074130177498, "policy_loss": -0.02171886502765119, "vf_loss": 5.964615553617477, "vf_explained_var": 0.3453960418701172, "kl": 0.007334903333685361, "entropy": 0.12444683839567006, "entropy_coeff": 0.0}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 47, "training_iteration": 118, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-40-42", "timestamp": 1618141242, "time_this_iter_s": 20.165714979171753, "time_total_s": 2604.61997795105, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2604.61997795105, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 58.196551724137926, "ram_util_percent": 27.296551724137924}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1948.0, "episode_reward_min": 1948.0, "episode_reward_mean": 1948.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1948.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.637192613199845, "mean_raw_obs_processing_ms": 0.08963823067435295, "mean_inference_ms": 1.6375269459032307, "mean_action_processing_ms": 0.046588155978368004}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 476000, "timers": {"sample_time_ms": 9603.251, "sample_throughput": 416.526, "learn_time_ms": 12205.304, "learn_throughput": 327.726, "update_time_ms": 3.018}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.896464616060257, "policy_loss": -0.03650477941846475, "vf_loss": 12.926948457956314, "vf_explained_var": 0.5412943363189697, "kl": 0.010571344129857607, "entropy": 0.22794996947050095, "entropy_coeff": 0.0}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 47, "training_iteration": 119, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-41-02", "timestamp": 1618141262, "time_this_iter_s": 20.079514026641846, "time_total_s": 2624.6994919776917, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e09d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2624.6994919776917, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 58.54642857142857, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1696.0, "episode_reward_min": 1696.0, "episode_reward_mean": 1696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6335824512256137, "mean_raw_obs_processing_ms": 0.08980704512295694, "mean_inference_ms": 1.6369269555959713, "mean_action_processing_ms": 0.04656775925589655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timers": {"sample_time_ms": 9240.274, "sample_throughput": 432.888, "learn_time_ms": 12188.823, "learn_throughput": 328.17, "update_time_ms": 3.021}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 13.651924401521683, "policy_loss": -0.03577277675503865, "vf_loss": 13.683496236801147, "vf_explained_var": 0.42485281825065613, "kl": 0.007376038993243128, "entropy": 0.13219392206519842, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 48, "training_iteration": 120, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-41-24", "timestamp": 1618141284, "time_this_iter_s": 21.75867247581482, "time_total_s": 2646.4581644535065, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338aa50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2646.4581644535065, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 57.83548387096774, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1696.0, "episode_reward_min": 1696.0, "episode_reward_mean": 1696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6335824512256137, "mean_raw_obs_processing_ms": 0.08980704512295694, "mean_inference_ms": 1.6369269555959713, "mean_action_processing_ms": 0.04656775925589655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 484000, "timers": {"sample_time_ms": 9187.729, "sample_throughput": 435.363, "learn_time_ms": 12194.635, "learn_throughput": 328.013, "update_time_ms": 3.022}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.981701135635376, "policy_loss": -0.030563099484425038, "vf_loss": 11.00813964009285, "vf_explained_var": 0.4729585647583008, "kl": 0.00724199121032143, "entropy": 0.14464664203114808, "entropy_coeff": 0.0}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 48, "training_iteration": 121, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-41-46", "timestamp": 1618141306, "time_this_iter_s": 22.229542016983032, "time_total_s": 2668.6877064704895, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2668.6877064704895, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 58.003125, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1696.0, "episode_reward_min": 1696.0, "episode_reward_mean": 1696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6335824512256137, "mean_raw_obs_processing_ms": 0.08980704512295694, "mean_inference_ms": 1.6369269555959713, "mean_action_processing_ms": 0.04656775925589655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 488000, "timers": {"sample_time_ms": 9166.935, "sample_throughput": 436.351, "learn_time_ms": 12203.986, "learn_throughput": 327.762, "update_time_ms": 3.072}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.557543486356735, "policy_loss": -0.030938723182771355, "vf_loss": 9.58345665037632, "vf_explained_var": 0.3486718237400055, "kl": 0.008824044169159606, "entropy": 0.1347778004128486, "entropy_coeff": 0.0}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 48, "training_iteration": 122, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-42-08", "timestamp": 1618141328, "time_this_iter_s": 21.91917109489441, "time_total_s": 2690.606877565384, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33564d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2690.606877565384, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 58.2125, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1986.0, "episode_reward_min": 1986.0, "episode_reward_mean": 1986.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6315437909613545, "mean_raw_obs_processing_ms": 0.09005916858323657, "mean_inference_ms": 1.6359787826652683, "mean_action_processing_ms": 0.04653489290142087}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 492000, "timers": {"sample_time_ms": 9001.472, "sample_throughput": 444.372, "learn_time_ms": 12188.12, "learn_throughput": 328.188, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.581216424703598, "policy_loss": -0.042240725917508826, "vf_loss": 10.615783721208572, "vf_explained_var": 0.4055713415145874, "kl": 0.013472996579366736, "entropy": 0.1759113511070609, "entropy_coeff": 0.0}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 49, "training_iteration": 123, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-42-28", "timestamp": 1618141348, "time_this_iter_s": 20.134358406066895, "time_total_s": 2710.741235971451, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68cedd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2710.741235971451, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 58.332142857142856, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1986.0, "episode_reward_min": 1986.0, "episode_reward_mean": 1986.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6315437909613545, "mean_raw_obs_processing_ms": 0.09005916858323657, "mean_inference_ms": 1.6359787826652683, "mean_action_processing_ms": 0.04653489290142087}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 496000, "timers": {"sample_time_ms": 8736.219, "sample_throughput": 457.864, "learn_time_ms": 12172.918, "learn_throughput": 328.598, "update_time_ms": 3.111}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.923418283462524, "policy_loss": -0.039458852959796786, "vf_loss": 12.957823008298874, "vf_explained_var": 0.5391467809677124, "kl": 0.008874242223100737, "entropy": 0.296314446721226, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 49, "training_iteration": 124, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-42-48", "timestamp": 1618141368, "time_this_iter_s": 19.862053632736206, "time_total_s": 2730.603289604187, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2730.603289604187, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 58.120689655172406, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1046.0, "episode_reward_min": 1046.0, "episode_reward_mean": 1046.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1046.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6243776017048491, "mean_raw_obs_processing_ms": 0.0902209089212803, "mean_inference_ms": 1.6350727758444386, "mean_action_processing_ms": 0.04650467488539511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 500000, "timers": {"sample_time_ms": 8492.905, "sample_throughput": 470.981, "learn_time_ms": 12190.082, "learn_throughput": 328.136, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 14.60354146361351, "policy_loss": -0.032837553531862795, "vf_loss": 14.631925716996193, "vf_explained_var": 0.6456600427627563, "kl": 0.007819573511369526, "entropy": 0.20577938319183886, "entropy_coeff": 0.0}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 50, "training_iteration": 125, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-43-08", "timestamp": 1618141388, "time_this_iter_s": 19.974318265914917, "time_total_s": 2750.577607870102, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f43d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d09d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2750.577607870102, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 58.06428571428571, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1046.0, "episode_reward_min": 1046.0, "episode_reward_mean": 1046.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1046.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6243776017048491, "mean_raw_obs_processing_ms": 0.0902209089212803, "mean_inference_ms": 1.6350727758444386, "mean_action_processing_ms": 0.04650467488539511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timers": {"sample_time_ms": 8449.346, "sample_throughput": 473.409, "learn_time_ms": 12181.8, "learn_throughput": 328.359, "update_time_ms": 3.131}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 16.50363004207611, "policy_loss": -0.03216232522390783, "vf_loss": 16.531804591417313, "vf_explained_var": 0.4975184500217438, "kl": 0.007002155660302378, "entropy": 0.20565847447142005, "entropy_coeff": 0.0}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 50, "training_iteration": 126, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-43-28", "timestamp": 1618141408, "time_this_iter_s": 19.772252559661865, "time_total_s": 2770.349860429764, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3da10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2770.349860429764, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 57.56428571428571, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1046.0, "episode_reward_min": 1046.0, "episode_reward_mean": 1046.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1046.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6243776017048491, "mean_raw_obs_processing_ms": 0.0902209089212803, "mean_inference_ms": 1.6350727758444386, "mean_action_processing_ms": 0.04650467488539511}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 508000, "timers": {"sample_time_ms": 8412.31, "sample_throughput": 475.494, "learn_time_ms": 12176.159, "learn_throughput": 328.511, "update_time_ms": 3.106}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 20.54760181903839, "policy_loss": -0.03389119100756943, "vf_loss": 20.576358258724213, "vf_explained_var": 0.446981281042099, "kl": 0.009015760180773214, "entropy": 0.1767348311841488, "entropy_coeff": 0.0}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 50, "training_iteration": 127, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-43-48", "timestamp": 1618141428, "time_this_iter_s": 20.085152626037598, "time_total_s": 2790.4350130558014, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222dc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2790.4350130558014, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 58.658620689655166, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1493.0, "episode_reward_min": 1493.0, "episode_reward_mean": 1493.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1493.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6142761369883741, "mean_raw_obs_processing_ms": 0.09047402605620707, "mean_inference_ms": 1.6341284606458903, "mean_action_processing_ms": 0.046466119637232524}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 512000, "timers": {"sample_time_ms": 8406.053, "sample_throughput": 475.848, "learn_time_ms": 12166.547, "learn_throughput": 328.77, "update_time_ms": 3.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 11.827807128429413, "policy_loss": -0.040302150417119265, "vf_loss": 11.863000094890594, "vf_explained_var": 0.5097275972366333, "kl": 0.008970574504928663, "entropy": 0.14978702319785953, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 51, "training_iteration": 128, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-44-08", "timestamp": 1618141448, "time_this_iter_s": 20.006417989730835, "time_total_s": 2810.441431045532, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2262b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2810.441431045532, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 58.24137931034482, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1493.0, "episode_reward_min": 1493.0, "episode_reward_mean": 1493.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1493.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6142761369883741, "mean_raw_obs_processing_ms": 0.09047402605620707, "mean_inference_ms": 1.6341284606458903, "mean_action_processing_ms": 0.046466119637232524}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 516000, "timers": {"sample_time_ms": 8590.981, "sample_throughput": 465.605, "learn_time_ms": 12159.443, "learn_throughput": 328.962, "update_time_ms": 3.115}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.584059536457062, "policy_loss": -0.03056954190833494, "vf_loss": 10.610503852367401, "vf_explained_var": 0.7398496866226196, "kl": 0.007243109925184399, "entropy": 0.18032385548576713, "entropy_coeff": 0.0}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 51, "training_iteration": 129, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-44-30", "timestamp": 1618141470, "time_this_iter_s": 21.855687618255615, "time_total_s": 2832.297118663788, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2262150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4efd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2832.297118663788, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 58.11612903225806, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1862.0, "episode_reward_min": 1862.0, "episode_reward_mean": 1862.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1862.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6166339294955561, "mean_raw_obs_processing_ms": 0.090649406171227, "mean_inference_ms": 1.6336944244407419, "mean_action_processing_ms": 0.046451530625343}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 520000, "timers": {"sample_time_ms": 8688.647, "sample_throughput": 460.371, "learn_time_ms": 12158.613, "learn_throughput": 328.985, "update_time_ms": 3.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.981564775109291, "policy_loss": -0.021377876691985875, "vf_loss": 6.999544233083725, "vf_explained_var": 0.27647876739501953, "kl": 0.005966995006019715, "entropy": 0.10555273480713367, "entropy_coeff": 0.0}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 52, "training_iteration": 130, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-44-53", "timestamp": 1618141493, "time_this_iter_s": 22.72711181640625, "time_total_s": 2855.024230480194, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22625d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4db50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2855.024230480194, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 58.05, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1862.0, "episode_reward_min": 1862.0, "episode_reward_mean": 1862.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1862.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6166339294955561, "mean_raw_obs_processing_ms": 0.090649406171227, "mean_inference_ms": 1.6336944244407419, "mean_action_processing_ms": 0.046451530625343}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 524000, "timers": {"sample_time_ms": 8599.594, "sample_throughput": 465.138, "learn_time_ms": 12131.451, "learn_throughput": 329.721, "update_time_ms": 3.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.507450595498085, "policy_loss": -0.021662297163857147, "vf_loss": 6.525030642747879, "vf_explained_var": 0.34631115198135376, "kl": 0.00716780660150107, "entropy": 0.12447775667533278, "entropy_coeff": 0.0}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 52, "training_iteration": 131, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-45-14", "timestamp": 1618141514, "time_this_iter_s": 21.068008422851562, "time_total_s": 2876.0922389030457, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2262d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4eb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2876.0922389030457, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 58.076666666666675, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1862.0, "episode_reward_min": 1862.0, "episode_reward_mean": 1862.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1862.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6166339294955561, "mean_raw_obs_processing_ms": 0.090649406171227, "mean_inference_ms": 1.6336944244407419, "mean_action_processing_ms": 0.046451530625343}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timers": {"sample_time_ms": 8441.288, "sample_throughput": 473.861, "learn_time_ms": 12101.825, "learn_throughput": 330.529, "update_time_ms": 3.04}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.1019628047943115, "policy_loss": -0.03364885610062629, "vf_loss": 6.13137823343277, "vf_explained_var": 0.4405365586280823, "kl": 0.007433206570567563, "entropy": 0.13049181969836354, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 52, "training_iteration": 132, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-45-34", "timestamp": 1618141534, "time_this_iter_s": 20.0391104221344, "time_total_s": 2896.13134932518, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4efd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2262d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2896.13134932518, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 57.90344827586207, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2001.0, "episode_reward_min": 2001.0, "episode_reward_mean": 2001.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2001.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6137435220117367, "mean_raw_obs_processing_ms": 0.0908438697673296, "mean_inference_ms": 1.6320423159914743, "mean_action_processing_ms": 0.04641028648980118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 532000, "timers": {"sample_time_ms": 8567.581, "sample_throughput": 466.876, "learn_time_ms": 12084.456, "learn_throughput": 331.004, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.817016288638115, "policy_loss": -0.02556147798895836, "vf_loss": 6.838902220129967, "vf_explained_var": 0.39372384548187256, "kl": 0.006453424830397125, "entropy": 0.11949971783906221, "entropy_coeff": 0.0}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 53, "training_iteration": 133, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-45-55", "timestamp": 1618141555, "time_this_iter_s": 21.219902753829956, "time_total_s": 2917.35125207901, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33564d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2917.35125207901, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 57.586666666666666, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2001.0, "episode_reward_min": 2001.0, "episode_reward_mean": 2001.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2001.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6137435220117367, "mean_raw_obs_processing_ms": 0.0908438697673296, "mean_inference_ms": 1.6320423159914743, "mean_action_processing_ms": 0.04641028648980118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 536000, "timers": {"sample_time_ms": 8918.417, "sample_throughput": 448.51, "learn_time_ms": 12105.538, "learn_throughput": 330.427, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 4.589037701487541, "policy_loss": -0.024924376572016627, "vf_loss": 4.610168389976025, "vf_explained_var": 0.3091437816619873, "kl": 0.0066611140937311575, "entropy": 0.11223065992817283, "entropy_coeff": 0.0}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 53, "training_iteration": 134, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-46-19", "timestamp": 1618141579, "time_this_iter_s": 23.58147168159485, "time_total_s": 2940.932723760605, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2940.932723760605, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 57.74411764705882, "ram_util_percent": 27.299999999999997}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2245.0, "episode_reward_min": 2245.0, "episode_reward_mean": 2245.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2245.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6201334789822139, "mean_raw_obs_processing_ms": 0.09103801610685494, "mean_inference_ms": 1.6316668767810274, "mean_action_processing_ms": 0.04639576338046748}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 540000, "timers": {"sample_time_ms": 9282.266, "sample_throughput": 430.929, "learn_time_ms": 12103.971, "learn_throughput": 330.47, "update_time_ms": 2.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.41161847114563, "policy_loss": -0.027255220105871558, "vf_loss": 5.434055119752884, "vf_explained_var": 0.3347620666027069, "kl": 0.00846066523808986, "entropy": 0.10789473564364016, "entropy_coeff": 0.0}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 54, "training_iteration": 135, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-46-42", "timestamp": 1618141602, "time_this_iter_s": 23.600900173187256, "time_total_s": 2964.533623933792, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2964.533623933792, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 58.42941176470588, "ram_util_percent": 27.305882352941172}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2245.0, "episode_reward_min": 2245.0, "episode_reward_mean": 2245.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2245.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6201334789822139, "mean_raw_obs_processing_ms": 0.09103801610685494, "mean_inference_ms": 1.6316668767810274, "mean_action_processing_ms": 0.04639576338046748}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 544000, "timers": {"sample_time_ms": 9677.667, "sample_throughput": 413.323, "learn_time_ms": 12110.643, "learn_throughput": 330.288, "update_time_ms": 2.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.829632878303528, "policy_loss": -0.03387770944391377, "vf_loss": 6.859681278467178, "vf_explained_var": 0.42078426480293274, "kl": 0.006723646198224742, "entropy": 0.11541712703183293, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 54, "training_iteration": 136, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-47-06", "timestamp": 1618141626, "time_this_iter_s": 23.796839475631714, "time_total_s": 2988.330463409424, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6927590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68e7690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2988.330463409424, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 58.544117647058826, "ram_util_percent": 27.36176470588235}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2245.0, "episode_reward_min": 2245.0, "episode_reward_mean": 2245.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2245.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6201334789822139, "mean_raw_obs_processing_ms": 0.09103801610685494, "mean_inference_ms": 1.6316668767810274, "mean_action_processing_ms": 0.04639576338046748}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 548000, "timers": {"sample_time_ms": 10021.556, "sample_throughput": 399.14, "learn_time_ms": 12116.67, "learn_throughput": 330.124, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.940451189875603, "policy_loss": -0.032603378931526095, "vf_loss": 6.967855557799339, "vf_explained_var": 0.20853443443775177, "kl": 0.009128535210038535, "entropy": 0.11897043976932764, "entropy_coeff": 0.0}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 54, "training_iteration": 137, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-47-30", "timestamp": 1618141650, "time_this_iter_s": 23.585650205612183, "time_total_s": 3011.916113615036, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dca90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3011.916113615036, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 57.81818181818181, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2138.0, "episode_reward_min": 2138.0, "episode_reward_mean": 2138.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2138.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6295650771617365, "mean_raw_obs_processing_ms": 0.09133565681157306, "mean_inference_ms": 1.6313219406206794, "mean_action_processing_ms": 0.046389078502250096}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timers": {"sample_time_ms": 10345.866, "sample_throughput": 386.628, "learn_time_ms": 12120.92, "learn_throughput": 330.008, "update_time_ms": 2.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.867521181702614, "policy_loss": -0.02557600970612839, "vf_loss": 7.888987749814987, "vf_explained_var": 0.43566596508026123, "kl": 0.00721561731188558, "entropy": 0.11807265901006758, "entropy_coeff": 0.0}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 55, "training_iteration": 138, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-47-53", "timestamp": 1618141673, "time_this_iter_s": 23.294025182724, "time_total_s": 3035.21013879776, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d23d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3035.21013879776, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 58.561764705882354, "ram_util_percent": 27.299999999999997}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2138.0, "episode_reward_min": 2138.0, "episode_reward_mean": 2138.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2138.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6295650771617365, "mean_raw_obs_processing_ms": 0.09133565681157306, "mean_inference_ms": 1.6313219406206794, "mean_action_processing_ms": 0.046389078502250096}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 556000, "timers": {"sample_time_ms": 10429.261, "sample_throughput": 383.536, "learn_time_ms": 12117.103, "learn_throughput": 330.112, "update_time_ms": 2.99}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 5.40876055508852, "policy_loss": -0.01691977193695493, "vf_loss": 5.421803787350655, "vf_explained_var": 0.32026442885398865, "kl": 0.0068065475425100885, "entropy": 0.11298913392238319, "entropy_coeff": 0.0}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 55, "training_iteration": 139, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-48-16", "timestamp": 1618141696, "time_this_iter_s": 22.653942823410034, "time_total_s": 3057.86408162117, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3057.86408162117, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 58.240624999999994, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2120.0, "episode_reward_min": 2120.0, "episode_reward_mean": 2120.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2120.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6288212880629966, "mean_raw_obs_processing_ms": 0.09153705540119, "mean_inference_ms": 1.6308706150024517, "mean_action_processing_ms": 0.04637290558556855}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 560000, "timers": {"sample_time_ms": 10191.823, "sample_throughput": 392.472, "learn_time_ms": 12124.016, "learn_throughput": 329.924, "update_time_ms": 2.971}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.020889610052109, "policy_loss": -0.03316805593203753, "vf_loss": 9.050321027636528, "vf_explained_var": 0.32552605867385864, "kl": 0.0065613172118901275, "entropy": 0.12697009346447885, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 56, "training_iteration": 140, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-48-36", "timestamp": 1618141716, "time_this_iter_s": 20.420276880264282, "time_total_s": 3078.2843585014343, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68c74d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3078.2843585014343, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 58.344827586206904, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2120.0, "episode_reward_min": 2120.0, "episode_reward_mean": 2120.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2120.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6288212880629966, "mean_raw_obs_processing_ms": 0.09153705540119, "mean_inference_ms": 1.6308706150024517, "mean_action_processing_ms": 0.04637290558556855}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 564000, "timers": {"sample_time_ms": 10067.15, "sample_throughput": 397.332, "learn_time_ms": 12150.365, "learn_throughput": 329.208, "update_time_ms": 3.018}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 11.615476101636887, "policy_loss": -0.035873982385965064, "vf_loss": 11.645927429199219, "vf_explained_var": 0.4469450116157532, "kl": 0.009521165906335227, "entropy": 0.20407364377751946, "entropy_coeff": 0.0}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 56, "training_iteration": 141, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-48-56", "timestamp": 1618141736, "time_this_iter_s": 20.085143566131592, "time_total_s": 3098.369502067566, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dce50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3098.369502067566, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 58.30344827586207, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2120.0, "episode_reward_min": 2120.0, "episode_reward_mean": 2120.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2120.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6288212880629966, "mean_raw_obs_processing_ms": 0.09153705540119, "mean_inference_ms": 1.6308706150024517, "mean_action_processing_ms": 0.04637290558556855}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 568000, "timers": {"sample_time_ms": 10028.905, "sample_throughput": 398.847, "learn_time_ms": 12178.03, "learn_throughput": 328.46, "update_time_ms": 3.028}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.388470590114594, "policy_loss": -0.03209902212256566, "vf_loss": 12.41474962234497, "vf_explained_var": 0.5494363307952881, "kl": 0.010219000687357038, "entropy": 0.24679082306101918, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 56, "training_iteration": 142, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-49-16", "timestamp": 1618141756, "time_this_iter_s": 19.935444355010986, "time_total_s": 3118.304946422577, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3118.304946422577, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 57.846428571428575, "ram_util_percent": 27.321428571428562}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1185.0, "episode_reward_min": 1185.0, "episode_reward_mean": 1185.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1185.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6246045207722037, "mean_raw_obs_processing_ms": 0.09178516248936663, "mean_inference_ms": 1.6298953747929852, "mean_action_processing_ms": 0.046341537024385406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 572000, "timers": {"sample_time_ms": 10153.238, "sample_throughput": 393.963, "learn_time_ms": 12216.109, "learn_throughput": 327.436, "update_time_ms": 3.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 12.755906343460083, "policy_loss": -0.038996459799818695, "vf_loss": 12.789468497037888, "vf_explained_var": 0.6879606246948242, "kl": 0.0095419765857514, "entropy": 0.17488998034968972, "entropy_coeff": 0.0}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 57, "training_iteration": 143, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-49-39", "timestamp": 1618141779, "time_this_iter_s": 22.844696283340454, "time_total_s": 3141.1496427059174, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3141.1496427059174, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 58.5030303030303, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1185.0, "episode_reward_min": 1185.0, "episode_reward_mean": 1185.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1185.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6246045207722037, "mean_raw_obs_processing_ms": 0.09178516248936663, "mean_inference_ms": 1.6298953747929852, "mean_action_processing_ms": 0.046341537024385406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timers": {"sample_time_ms": 10042.196, "sample_throughput": 398.319, "learn_time_ms": 12203.046, "learn_throughput": 327.787, "update_time_ms": 3.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.335791021585464, "policy_loss": -0.039995560073293746, "vf_loss": 9.370791018009186, "vf_explained_var": 0.40914684534072876, "kl": 0.008771632143179886, "entropy": 0.10771419492084533, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 57, "training_iteration": 144, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-50-02", "timestamp": 1618141802, "time_this_iter_s": 22.337353706359863, "time_total_s": 3163.486996412277, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3163.486996412277, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 57.996875, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2156.0, "episode_reward_min": 2156.0, "episode_reward_mean": 2156.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2156.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6252597329824551, "mean_raw_obs_processing_ms": 0.09198566477223032, "mean_inference_ms": 1.6299690170182985, "mean_action_processing_ms": 0.0463419119357789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 580000, "timers": {"sample_time_ms": 9880.113, "sample_throughput": 404.854, "learn_time_ms": 12200.628, "learn_throughput": 327.852, "update_time_ms": 3.064}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 6.744326576590538, "policy_loss": -0.02296167245367542, "vf_loss": 6.7642956376075745, "vf_explained_var": 0.35539981722831726, "kl": 0.005254406401945744, "entropy": 0.10924983979202807, "entropy_coeff": 0.0}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 58, "training_iteration": 145, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-50-24", "timestamp": 1618141824, "time_this_iter_s": 21.953847885131836, "time_total_s": 3185.440844297409, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3185.440844297409, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 58.090322580645164, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2156.0, "episode_reward_min": 2156.0, "episode_reward_mean": 2156.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2156.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6252597329824551, "mean_raw_obs_processing_ms": 0.09198566477223032, "mean_inference_ms": 1.6299690170182985, "mean_action_processing_ms": 0.0463419119357789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 584000, "timers": {"sample_time_ms": 9655.55, "sample_throughput": 414.269, "learn_time_ms": 12206.517, "learn_throughput": 327.694, "update_time_ms": 3.018}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 7.8525721579790115, "policy_loss": -0.03145447879796848, "vf_loss": 7.880098521709442, "vf_explained_var": 0.3924499750137329, "kl": 0.006897025043144822, "entropy": 0.12281625648029149, "entropy_coeff": 0.0}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 58, "training_iteration": 146, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-50-45", "timestamp": 1618141845, "time_this_iter_s": 21.60875654220581, "time_total_s": 3207.049600839615, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3207.049600839615, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 58.04838709677419, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2156.0, "episode_reward_min": 2156.0, "episode_reward_mean": 2156.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2156.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6252597329824551, "mean_raw_obs_processing_ms": 0.09198566477223032, "mean_inference_ms": 1.6299690170182985, "mean_action_processing_ms": 0.0463419119357789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 588000, "timers": {"sample_time_ms": 9599.014, "sample_throughput": 416.709, "learn_time_ms": 12214.491, "learn_throughput": 327.48, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 8.046068727970123, "policy_loss": -0.02444476482924074, "vf_loss": 8.067186892032623, "vf_explained_var": 0.3820396363735199, "kl": 0.00584105662892398, "entropy": 0.11342730652540922, "entropy_coeff": 0.0}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 58, "training_iteration": 147, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-51-08", "timestamp": 1618141868, "time_this_iter_s": 23.0978741645813, "time_total_s": 3230.147475004196, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f41d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3230.147475004196, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 57.85757575757576, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6253356390515807, "mean_raw_obs_processing_ms": 0.09227366744512945, "mean_inference_ms": 1.6297893037539093, "mean_action_processing_ms": 0.04633251664901911}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 592000, "timers": {"sample_time_ms": 9377.564, "sample_throughput": 426.55, "learn_time_ms": 12219.93, "learn_throughput": 327.334, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.107301399111748, "policy_loss": -0.028141517948824912, "vf_loss": 10.130048274993896, "vf_explained_var": 0.3190072476863861, "kl": 0.00947207072749734, "entropy": 0.13070526742376387, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 59, "training_iteration": 148, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-51-30", "timestamp": 1618141890, "time_this_iter_s": 21.133914470672607, "time_total_s": 3251.281389474869, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fd90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3251.281389474869, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 58.023333333333326, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2018.0, "episode_reward_min": 2018.0, "episode_reward_mean": 2018.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2018.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6253356390515807, "mean_raw_obs_processing_ms": 0.09227366744512945, "mean_inference_ms": 1.6297893037539093, "mean_action_processing_ms": 0.04633251664901911}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 596000, "timers": {"sample_time_ms": 9262.97, "sample_throughput": 431.827, "learn_time_ms": 12233.12, "learn_throughput": 326.981, "update_time_ms": 3.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.266215771436691, "policy_loss": -0.01856761984527111, "vf_loss": 10.280605524778366, "vf_explained_var": 0.37095192074775696, "kl": 0.007335761772992555, "entropy": 0.11797624872997403, "entropy_coeff": 0.0}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 59, "training_iteration": 149, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-51-51", "timestamp": 1618141911, "time_this_iter_s": 21.640516996383667, "time_total_s": 3272.9219064712524, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3272.9219064712524, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 58.458064516129035, "ram_util_percent": 27.332258064516125}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2014.0, "episode_reward_min": 2014.0, "episode_reward_mean": 2014.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2014.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6232973240620059, "mean_raw_obs_processing_ms": 0.0924852478856861, "mean_inference_ms": 1.629898411715258, "mean_action_processing_ms": 0.0463463352558536}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timers": {"sample_time_ms": 9327.996, "sample_throughput": 428.817, "learn_time_ms": 12250.01, "learn_throughput": 326.53, "update_time_ms": 3.065}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 10.202822491526604, "policy_loss": -0.026213696983177215, "vf_loss": 10.224757835268974, "vf_explained_var": 0.42559048533439636, "kl": 0.007512012773077004, "entropy": 0.14044422330334783, "entropy_coeff": 0.0}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 60, "training_iteration": 150, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-52-12", "timestamp": 1618141932, "time_this_iter_s": 21.240897178649902, "time_total_s": 3294.1628036499023, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3294.1628036499023, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 58.36129032258064, "ram_util_percent": 27.309677419354827}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2014.0, "episode_reward_min": 2014.0, "episode_reward_mean": 2014.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2014.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6232973240620059, "mean_raw_obs_processing_ms": 0.0924852478856861, "mean_inference_ms": 1.629898411715258, "mean_action_processing_ms": 0.0463463352558536}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 604000, "timers": {"sample_time_ms": 9819.456, "sample_throughput": 407.355, "learn_time_ms": 12245.557, "learn_throughput": 326.649, "update_time_ms": 3.074}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.56953125, "cur_lr": 5e-05, "total_loss": 9.163360029459, "policy_loss": -0.06286267592804506, "vf_loss": 9.209988847374916, "vf_explained_var": 0.5654860734939575, "kl": 0.028503980342065915, "entropy": 0.13714580819942057, "entropy_coeff": 0.0}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 60, "training_iteration": 151, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-52-37", "timestamp": 1618141957, "time_this_iter_s": 24.95237922668457, "time_total_s": 3319.115182876587, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3319.115182876587, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 58.55714285714286, "ram_util_percent": 27.299999999999997}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2014.0, "episode_reward_min": 2014.0, "episode_reward_mean": 2014.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2014.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6232973240620059, "mean_raw_obs_processing_ms": 0.0924852478856861, "mean_inference_ms": 1.629898411715258, "mean_action_processing_ms": 0.0463463352558536}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 608000, "timers": {"sample_time_ms": 9913.388, "sample_throughput": 403.495, "learn_time_ms": 12261.551, "learn_throughput": 326.223, "update_time_ms": 3.106}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 13.113057494163513, "policy_loss": -0.04159823147347197, "vf_loss": 13.148451685905457, "vf_explained_var": 0.5297105312347412, "kl": 0.007262366358190775, "entropy": 0.16001842846162617, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 60, "training_iteration": 152, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-52-58", "timestamp": 1618141978, "time_this_iter_s": 21.033449411392212, "time_total_s": 3340.148632287979, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc76cba6810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b82c4710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3340.148632287979, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 58.34666666666668, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1827.0, "episode_reward_min": 1827.0, "episode_reward_mean": 1827.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1827.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6234511612506866, "mean_raw_obs_processing_ms": 0.09280025599342354, "mean_inference_ms": 1.6299147359070838, "mean_action_processing_ms": 0.046349416603627756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 612000, "timers": {"sample_time_ms": 9636.286, "sample_throughput": 415.098, "learn_time_ms": 12277.867, "learn_throughput": 325.789, "update_time_ms": 3.103}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 14.559781312942505, "policy_loss": -0.030825901951175183, "vf_loss": 14.5838024020195, "vf_explained_var": 0.6287453770637512, "kl": 0.007965481549035758, "entropy": 0.2723750676959753, "entropy_coeff": 0.0}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 61, "training_iteration": 153, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-53-19", "timestamp": 1618141999, "time_this_iter_s": 20.238845586776733, "time_total_s": 3360.387477874756, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3373110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3360.387477874756, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 58.41724137931033, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1827.0, "episode_reward_min": 1827.0, "episode_reward_mean": 1827.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1827.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6234511612506866, "mean_raw_obs_processing_ms": 0.09280025599342354, "mean_inference_ms": 1.6299147359070838, "mean_action_processing_ms": 0.046349416603627756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 616000, "timers": {"sample_time_ms": 9405.849, "sample_throughput": 425.267, "learn_time_ms": 12291.776, "learn_throughput": 325.421, "update_time_ms": 3.043}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 8.133011400699615, "policy_loss": -0.034943717531859875, "vf_loss": 8.16148266196251, "vf_explained_var": 0.6331692934036255, "kl": 0.007576445932500064, "entropy": 0.33484521321952343, "entropy_coeff": 0.0}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 61, "training_iteration": 154, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-53-39", "timestamp": 1618142019, "time_this_iter_s": 20.173558712005615, "time_total_s": 3380.5610365867615, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3380.5610365867615, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 57.68965517241379, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 549.0, "episode_reward_min": 549.0, "episode_reward_mean": 549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184642753188903, "mean_raw_obs_processing_ms": 0.0930235316026708, "mean_inference_ms": 1.629930564886413, "mean_action_processing_ms": 0.046348865800814}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 620000, "timers": {"sample_time_ms": 9287.829, "sample_throughput": 430.671, "learn_time_ms": 12308.845, "learn_throughput": 324.97, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 7.412475690245628, "policy_loss": -0.03233312809607014, "vf_loss": 7.438435927033424, "vf_explained_var": 0.8813754320144653, "kl": 0.007459824759280309, "entropy": 0.3202317161485553, "entropy_coeff": 0.0}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 62, "training_iteration": 155, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-54-00", "timestamp": 1618142040, "time_this_iter_s": 20.94688868522644, "time_total_s": 3401.507925271988, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fb90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3401.507925271988, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 58.62666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 549.0, "episode_reward_min": 549.0, "episode_reward_mean": 549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184642753188903, "mean_raw_obs_processing_ms": 0.0930235316026708, "mean_inference_ms": 1.629930564886413, "mean_action_processing_ms": 0.046348865800814}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timers": {"sample_time_ms": 9267.226, "sample_throughput": 431.629, "learn_time_ms": 12326.674, "learn_throughput": 324.5, "update_time_ms": 3.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8542968750000001, "cur_lr": 5e-05, "total_loss": 12.155928134918213, "policy_loss": -0.018439530162140727, "vf_loss": 12.170227110385895, "vf_explained_var": 0.3543485105037689, "kl": 0.004846670697588706, "entropy": 0.10709879524074495, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 62, "training_iteration": 156, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-54-22", "timestamp": 1618142062, "time_this_iter_s": 21.5799720287323, "time_total_s": 3423.08789730072, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3da10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3423.08789730072, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 58.66451612903225, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 549.0, "episode_reward_min": 549.0, "episode_reward_mean": 549.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [549.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6184642753188903, "mean_raw_obs_processing_ms": 0.0930235316026708, "mean_inference_ms": 1.629930564886413, "mean_action_processing_ms": 0.046348865800814}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 628000, "timers": {"sample_time_ms": 8996.868, "sample_throughput": 444.599, "learn_time_ms": 12329.545, "learn_throughput": 324.424, "update_time_ms": 3.048}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 10.991550400853157, "policy_loss": -0.03474979568272829, "vf_loss": 11.021875143051147, "vf_explained_var": 0.588380753993988, "kl": 0.010359369203797542, "entropy": 0.20930227730423212, "entropy_coeff": 0.0}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 62, "training_iteration": 157, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-54-42", "timestamp": 1618142082, "time_this_iter_s": 20.42176342010498, "time_total_s": 3443.509660720825, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dce50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3443.509660720825, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 58.36206896551725, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1791.0, "episode_reward_min": 1791.0, "episode_reward_mean": 1791.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1791.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6160036175664327, "mean_raw_obs_processing_ms": 0.09335859909301106, "mean_inference_ms": 1.6305051273054045, "mean_action_processing_ms": 0.0463623259423318}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 632000, "timers": {"sample_time_ms": 9173.734, "sample_throughput": 436.027, "learn_time_ms": 12349.486, "learn_throughput": 323.9, "update_time_ms": 3.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 8.3103778809309, "policy_loss": -0.025405696957022883, "vf_loss": 8.332575961947441, "vf_explained_var": 0.3569835126399994, "kl": 0.007509856033721007, "entropy": 0.10286432923749089, "entropy_coeff": 0.0}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 63, "training_iteration": 158, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-55-05", "timestamp": 1618142105, "time_this_iter_s": 23.102254629135132, "time_total_s": 3466.6119153499603, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3466.6119153499603, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 58.32121212121211, "ram_util_percent": 27.3}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1791.0, "episode_reward_min": 1791.0, "episode_reward_mean": 1791.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1791.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6160036175664327, "mean_raw_obs_processing_ms": 0.09335859909301106, "mean_inference_ms": 1.6305051273054045, "mean_action_processing_ms": 0.0463623259423318}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 636000, "timers": {"sample_time_ms": 9085.546, "sample_throughput": 440.26, "learn_time_ms": 12360.319, "learn_throughput": 323.616, "update_time_ms": 3.043}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 8.93985790014267, "policy_loss": -0.02363227994646877, "vf_loss": 8.960550740361214, "vf_explained_var": 0.48761022090911865, "kl": 0.00688155314855976, "entropy": 0.1348317419178784, "entropy_coeff": 0.0}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 63, "training_iteration": 159, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-55-26", "timestamp": 1618142126, "time_this_iter_s": 20.866491317749023, "time_total_s": 3487.4784066677094, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3487.4784066677094, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 58.27333333333333, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1520.0, "episode_reward_min": 1520.0, "episode_reward_mean": 1520.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112408903501513, "mean_raw_obs_processing_ms": 0.09357855860258539, "mean_inference_ms": 1.6307972833292301, "mean_action_processing_ms": 0.04636828471620304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 640000, "timers": {"sample_time_ms": 8998.315, "sample_throughput": 444.528, "learn_time_ms": 12353.438, "learn_throughput": 323.796, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 15.412656843662262, "policy_loss": -0.03783838450908661, "vf_loss": 15.444602608680725, "vf_explained_var": 0.48369279503822327, "kl": 0.013795563718304038, "entropy": 0.24990805983543396, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 64, "training_iteration": 160, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-55-46", "timestamp": 1618142146, "time_this_iter_s": 20.297385454177856, "time_total_s": 3507.775792121887, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3507.775792121887, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 58.89310344827586, "ram_util_percent": 27.372413793103444}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1520.0, "episode_reward_min": 1520.0, "episode_reward_mean": 1520.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112408903501513, "mean_raw_obs_processing_ms": 0.09357855860258539, "mean_inference_ms": 1.6307972833292301, "mean_action_processing_ms": 0.04636828471620304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 644000, "timers": {"sample_time_ms": 8534.998, "sample_throughput": 468.659, "learn_time_ms": 12380.723, "learn_throughput": 323.083, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 13.050562918186188, "policy_loss": -0.034329940332099795, "vf_loss": 13.080402791500092, "vf_explained_var": 0.5751761198043823, "kl": 0.010511390253668651, "entropy": 0.2502800510264933, "entropy_coeff": 0.0}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 64, "training_iteration": 161, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-56-07", "timestamp": 1618142167, "time_this_iter_s": 20.595146894454956, "time_total_s": 3528.370939016342, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3528.370939016342, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 58.64482758620691, "ram_util_percent": 27.324137931034475}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1520.0, "episode_reward_min": 1520.0, "episode_reward_mean": 1520.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6112408903501513, "mean_raw_obs_processing_ms": 0.09357855860258539, "mean_inference_ms": 1.6307972833292301, "mean_action_processing_ms": 0.04636828471620304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timers": {"sample_time_ms": 8461.54, "sample_throughput": 472.727, "learn_time_ms": 12405.981, "learn_throughput": 322.425, "update_time_ms": 3.081}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 13.204055353999138, "policy_loss": -0.03696715226396918, "vf_loss": 13.236650854349136, "vf_explained_var": 0.6835927963256836, "kl": 0.0102342172031058, "entropy": 0.24807486031204462, "entropy_coeff": 0.0}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 64, "training_iteration": 162, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-56-28", "timestamp": 1618142188, "time_this_iter_s": 20.554198265075684, "time_total_s": 3548.925137281418, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ec850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3548.925137281418, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 58.576666666666675, "ram_util_percent": 27.393333333333324}, "trial_id": "9be58_00000"}
{"episode_reward_max": 815.0, "episode_reward_min": 815.0, "episode_reward_mean": 815.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [815.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6033530507182365, "mean_raw_obs_processing_ms": 0.09392709784756328, "mean_inference_ms": 1.6309770357340008, "mean_action_processing_ms": 0.046374385887760244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 652000, "timers": {"sample_time_ms": 8477.511, "sample_throughput": 471.837, "learn_time_ms": 12445.124, "learn_throughput": 321.411, "update_time_ms": 3.066}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 3.9195261746644974, "policy_loss": -0.046487671439535916, "vf_loss": 3.9603744372725487, "vf_explained_var": 0.25861960649490356, "kl": 0.013202397938584909, "entropy": 0.43599495757371187, "entropy_coeff": 0.0}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 65, "training_iteration": 163, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-56-48", "timestamp": 1618142208, "time_this_iter_s": 20.79116177558899, "time_total_s": 3569.716299057007, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3d790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3569.716299057007, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 59.00000000000001, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 815.0, "episode_reward_min": 815.0, "episode_reward_mean": 815.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [815.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6033530507182365, "mean_raw_obs_processing_ms": 0.09392709784756328, "mean_inference_ms": 1.6309770357340008, "mean_action_processing_ms": 0.046374385887760244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 656000, "timers": {"sample_time_ms": 8566.936, "sample_throughput": 466.911, "learn_time_ms": 12476.352, "learn_throughput": 320.607, "update_time_ms": 3.124}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 17.443911284208298, "policy_loss": -0.028208782547153533, "vf_loss": 17.467139840126038, "vf_explained_var": 0.6424497365951538, "kl": 0.011659002484520897, "entropy": 0.21829660888761282, "entropy_coeff": 0.0}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 65, "training_iteration": 164, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-57-10", "timestamp": 1618142230, "time_this_iter_s": 21.38200306892395, "time_total_s": 3591.098302125931, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22800d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d95d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3591.098302125931, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 58.87741935483869, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1366.0, "episode_reward_min": 1366.0, "episode_reward_mean": 1366.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1366.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6015526048723506, "mean_raw_obs_processing_ms": 0.09414838484310846, "mean_inference_ms": 1.6310956285538387, "mean_action_processing_ms": 0.04638653756660401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 660000, "timers": {"sample_time_ms": 8662.614, "sample_throughput": 461.754, "learn_time_ms": 12486.051, "learn_throughput": 320.358, "update_time_ms": 3.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42714843750000003, "cur_lr": 5e-05, "total_loss": 19.093007743358612, "policy_loss": -0.06705087673617527, "vf_loss": 19.146535992622375, "vf_explained_var": 0.4939316213130951, "kl": 0.03165745665319264, "entropy": 0.16192223993130028, "entropy_coeff": 0.0}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 66, "training_iteration": 165, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-57-32", "timestamp": 1618142252, "time_this_iter_s": 22.000558853149414, "time_total_s": 3613.09886097908, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22808d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3613.09886097908, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 58.28064516129032, "ram_util_percent": 27.29999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1366.0, "episode_reward_min": 1366.0, "episode_reward_mean": 1366.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1366.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6015526048723506, "mean_raw_obs_processing_ms": 0.09414838484310846, "mean_inference_ms": 1.6310956285538387, "mean_action_processing_ms": 0.04638653756660401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 664000, "timers": {"sample_time_ms": 8591.454, "sample_throughput": 465.579, "learn_time_ms": 12493.728, "learn_throughput": 320.161, "update_time_ms": 3.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 16.39610904455185, "policy_loss": -0.04216484405333176, "vf_loss": 16.428355485200882, "vf_explained_var": 0.5434306263923645, "kl": 0.0154799701704178, "entropy": 0.1768559366464615, "entropy_coeff": 0.0}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 66, "training_iteration": 166, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-57-53", "timestamp": 1618142273, "time_this_iter_s": 20.946409940719604, "time_total_s": 3634.0452709198, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338ad90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3634.0452709198, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 58.41666666666667, "ram_util_percent": 27.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1366.0, "episode_reward_min": 1366.0, "episode_reward_mean": 1366.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1366.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.6015526048723506, "mean_raw_obs_processing_ms": 0.09414838484310846, "mean_inference_ms": 1.6310956285538387, "mean_action_processing_ms": 0.04638653756660401}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 668000, "timers": {"sample_time_ms": 8578.702, "sample_throughput": 466.271, "learn_time_ms": 12491.17, "learn_throughput": 320.226, "update_time_ms": 3.133}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 16.151497304439545, "policy_loss": -0.029256107634864748, "vf_loss": 16.17636427283287, "vf_explained_var": 0.5283674001693726, "kl": 0.006850187011878006, "entropy": 0.15736205969005823, "entropy_coeff": 0.0}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 66, "training_iteration": 167, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-58-13", "timestamp": 1618142293, "time_this_iter_s": 20.269225358963013, "time_total_s": 3654.314496278763, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3654.314496278763, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 58.12413793103448, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1511.0, "episode_reward_min": 1511.0, "episode_reward_mean": 1511.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1511.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5950193289163739, "mean_raw_obs_processing_ms": 0.09444925077299621, "mean_inference_ms": 1.6309459710819343, "mean_action_processing_ms": 0.04638040720936532}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timers": {"sample_time_ms": 8313.188, "sample_throughput": 481.163, "learn_time_ms": 12484.943, "learn_throughput": 320.386, "update_time_ms": 3.201}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 14.450735121965408, "policy_loss": -0.034818457323126495, "vf_loss": 14.480990588665009, "vf_explained_var": 0.43414533138275146, "kl": 0.007121393573470414, "entropy": 0.1686706142500043, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 67, "training_iteration": 168, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-58-34", "timestamp": 1618142314, "time_this_iter_s": 20.38356065750122, "time_total_s": 3674.698056936264, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ec4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3674.698056936264, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 58.83448275862068, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1511.0, "episode_reward_min": 1511.0, "episode_reward_mean": 1511.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1511.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5950193289163739, "mean_raw_obs_processing_ms": 0.09444925077299621, "mean_inference_ms": 1.6309459710819343, "mean_action_processing_ms": 0.04638040720936532}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 676000, "timers": {"sample_time_ms": 8274.134, "sample_throughput": 483.434, "learn_time_ms": 12477.637, "learn_throughput": 320.574, "update_time_ms": 3.226}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 13.371095806360245, "policy_loss": -0.026942685624817386, "vf_loss": 13.39227893948555, "vf_explained_var": 0.4594342112541199, "kl": 0.008989223919343203, "entropy": 0.24776671780273318, "entropy_coeff": 0.0}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 67, "training_iteration": 169, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-58-54", "timestamp": 1618142334, "time_this_iter_s": 20.403309106826782, "time_total_s": 3695.101366043091, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3695.101366043091, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 58.755172413793105, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1205.0, "episode_reward_min": 1205.0, "episode_reward_mean": 1205.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5902556451939086, "mean_raw_obs_processing_ms": 0.09468572660729399, "mean_inference_ms": 1.6309255944989203, "mean_action_processing_ms": 0.04637853800349816}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 680000, "timers": {"sample_time_ms": 8259.684, "sample_throughput": 484.28, "learn_time_ms": 12504.436, "learn_throughput": 319.886, "update_time_ms": 3.169}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 13.055293530225754, "policy_loss": -0.029892398801166564, "vf_loss": 13.080179065465927, "vf_explained_var": 0.5735529661178589, "kl": 0.007814508673618548, "entropy": 0.15234041353687644, "entropy_coeff": 0.0}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 68, "training_iteration": 170, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-59-14", "timestamp": 1618142354, "time_this_iter_s": 20.420995950698853, "time_total_s": 3715.5223619937897, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3715.5223619937897, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 58.58275862068966, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1205.0, "episode_reward_min": 1205.0, "episode_reward_mean": 1205.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5902556451939086, "mean_raw_obs_processing_ms": 0.09468572660729399, "mean_inference_ms": 1.6309255944989203, "mean_action_processing_ms": 0.04637853800349816}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 684000, "timers": {"sample_time_ms": 8235.285, "sample_throughput": 485.715, "learn_time_ms": 12504.522, "learn_throughput": 319.884, "update_time_ms": 3.127}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 13.486350804567337, "policy_loss": -0.038683257647790015, "vf_loss": 13.51943588256836, "vf_explained_var": 0.5597691535949707, "kl": 0.008736956035136245, "entropy": 0.25340461358428, "entropy_coeff": 0.0}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 68, "training_iteration": 171, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-59-35", "timestamp": 1618142375, "time_this_iter_s": 20.351662397384644, "time_total_s": 3735.8740243911743, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d25d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3735.8740243911743, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 58.38333333333333, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1205.0, "episode_reward_min": 1205.0, "episode_reward_mean": 1205.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5902556451939086, "mean_raw_obs_processing_ms": 0.09468572660729399, "mean_inference_ms": 1.6309255944989203, "mean_action_processing_ms": 0.04637853800349816}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 688000, "timers": {"sample_time_ms": 8223.542, "sample_throughput": 486.408, "learn_time_ms": 12492.48, "learn_throughput": 320.193, "update_time_ms": 3.208}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 10.1312026232481, "policy_loss": -0.028458603541366756, "vf_loss": 10.155340686440468, "vf_explained_var": 0.5171180963516235, "kl": 0.0067434366210363805, "entropy": 0.28777881246060133, "entropy_coeff": 0.0}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 68, "training_iteration": 172, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_11-59-55", "timestamp": 1618142395, "time_this_iter_s": 20.316993474960327, "time_total_s": 3756.1910178661346, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3756.1910178661346, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 58.19655172413794, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 537.0, "episode_reward_min": 537.0, "episode_reward_mean": 537.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [537.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5831226345453654, "mean_raw_obs_processing_ms": 0.09499608800505217, "mean_inference_ms": 1.6307387914222666, "mean_action_processing_ms": 0.046371463924468385}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 692000, "timers": {"sample_time_ms": 8229.702, "sample_throughput": 486.044, "learn_time_ms": 12440.177, "learn_throughput": 321.539, "update_time_ms": 3.213}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.64072265625, "cur_lr": 5e-05, "total_loss": 7.2369000017642975, "policy_loss": -0.06628621852723882, "vf_loss": 7.270316660404205, "vf_explained_var": 0.42857831716537476, "kl": 0.05130075663328171, "entropy": 0.3335345387458801, "entropy_coeff": 0.0}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 69, "training_iteration": 173, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-00-15", "timestamp": 1618142415, "time_this_iter_s": 20.32636070251465, "time_total_s": 3776.5173785686493, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68cea90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3776.5173785686493, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 58.55172413793103, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 537.0, "episode_reward_min": 537.0, "episode_reward_mean": 537.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [537.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5831226345453654, "mean_raw_obs_processing_ms": 0.09499608800505217, "mean_inference_ms": 1.6307387914222666, "mean_action_processing_ms": 0.046371463924468385}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timers": {"sample_time_ms": 8167.313, "sample_throughput": 489.757, "learn_time_ms": 12411.114, "learn_throughput": 322.292, "update_time_ms": 3.163}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 14.554125308990479, "policy_loss": -0.028285874286666512, "vf_loss": 14.575783401727676, "vf_explained_var": 0.7050868272781372, "kl": 0.006896021754073445, "entropy": 0.18405767064541578, "entropy_coeff": 0.0}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 69, "training_iteration": 174, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-00-36", "timestamp": 1618142436, "time_this_iter_s": 20.46675729751587, "time_total_s": 3796.984135866165, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e56d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68cedd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3796.984135866165, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 58.589655172413785, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1202.0, "episode_reward_min": 1202.0, "episode_reward_mean": 1202.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5788857470162241, "mean_raw_obs_processing_ms": 0.09520564034278117, "mean_inference_ms": 1.6305989349816066, "mean_action_processing_ms": 0.046368114102919966}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 700000, "timers": {"sample_time_ms": 8017.286, "sample_throughput": 498.922, "learn_time_ms": 12402.16, "learn_throughput": 322.524, "update_time_ms": 3.161}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 16.721502751111984, "policy_loss": -0.03199016611324623, "vf_loss": 16.747519105672836, "vf_explained_var": 0.542617917060852, "kl": 0.006215554734808393, "entropy": 0.1638772776350379, "entropy_coeff": 0.0}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 70, "training_iteration": 175, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-00-56", "timestamp": 1618142456, "time_this_iter_s": 20.409836053848267, "time_total_s": 3817.3939719200134, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e50d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3817.3939719200134, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 58.56551724137931, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1202.0, "episode_reward_min": 1202.0, "episode_reward_mean": 1202.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5788857470162241, "mean_raw_obs_processing_ms": 0.09520564034278117, "mean_inference_ms": 1.6305989349816066, "mean_action_processing_ms": 0.046368114102919966}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 704000, "timers": {"sample_time_ms": 7951.435, "sample_throughput": 503.054, "learn_time_ms": 12340.903, "learn_throughput": 324.125, "update_time_ms": 3.162}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9610839843750001, "cur_lr": 5e-05, "total_loss": 13.10382729768753, "policy_loss": -0.02254974318202585, "vf_loss": 13.121647000312805, "vf_explained_var": 0.5515464544296265, "kl": 0.004921912754070945, "entropy": 0.14364317944273353, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 70, "training_iteration": 176, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-01-16", "timestamp": 1618142476, "time_this_iter_s": 19.673197269439697, "time_total_s": 3837.067169189453, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6c74490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6de7390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3837.067169189453, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 57.49285714285714, "ram_util_percent": 27.399999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1202.0, "episode_reward_min": 1202.0, "episode_reward_mean": 1202.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5788857470162241, "mean_raw_obs_processing_ms": 0.09520564034278117, "mean_inference_ms": 1.6305989349816066, "mean_action_processing_ms": 0.046368114102919966}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 708000, "timers": {"sample_time_ms": 7936.653, "sample_throughput": 503.991, "learn_time_ms": 12290.289, "learn_throughput": 325.46, "update_time_ms": 3.171}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 13.489669144153595, "policy_loss": -0.023930901137646288, "vf_loss": 13.509808093309402, "vf_explained_var": 0.45090872049331665, "kl": 0.007890776221756823, "entropy": 0.14831672399304807, "entropy_coeff": 0.0}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 70, "training_iteration": 177, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-01-36", "timestamp": 1618142496, "time_this_iter_s": 19.617310523986816, "time_total_s": 3856.68447971344, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3856.68447971344, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 58.871428571428574, "ram_util_percent": 27.399999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1453.0, "episode_reward_min": 1453.0, "episode_reward_mean": 1453.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1453.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5722684722040671, "mean_raw_obs_processing_ms": 0.0954002318966341, "mean_inference_ms": 1.6291071705701907, "mean_action_processing_ms": 0.046319971499804116}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 712000, "timers": {"sample_time_ms": 7851.729, "sample_throughput": 509.442, "learn_time_ms": 12283.07, "learn_throughput": 325.651, "update_time_ms": 3.084}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 11.322911262512207, "policy_loss": -0.0403807467664592, "vf_loss": 11.358509123325348, "vf_explained_var": 0.6137648224830627, "kl": 0.009953113563824445, "entropy": 0.20564711187034845, "entropy_coeff": 0.0}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 71, "training_iteration": 178, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-01-55", "timestamp": 1618142515, "time_this_iter_s": 19.462442636489868, "time_total_s": 3876.14692234993, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33a0650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3876.14692234993, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 58.30000000000001, "ram_util_percent": 27.399999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1453.0, "episode_reward_min": 1453.0, "episode_reward_mean": 1453.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1453.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5722684722040671, "mean_raw_obs_processing_ms": 0.0954002318966341, "mean_inference_ms": 1.6291071705701907, "mean_action_processing_ms": 0.046319971499804116}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 716000, "timers": {"sample_time_ms": 7820.243, "sample_throughput": 511.493, "learn_time_ms": 12273.593, "learn_throughput": 325.903, "update_time_ms": 3.11}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.787010490894318, "policy_loss": -0.03889024764066562, "vf_loss": 8.820433467626572, "vf_explained_var": 0.47533947229385376, "kl": 0.01137745488085784, "entropy": 0.247791251167655, "entropy_coeff": 0.0}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 71, "training_iteration": 179, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-02-15", "timestamp": 1618142535, "time_this_iter_s": 19.991608142852783, "time_total_s": 3896.1385304927826, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dccd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3896.1385304927826, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 57.589285714285715, "ram_util_percent": 27.399999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 556.0, "episode_reward_min": 556.0, "episode_reward_mean": 556.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [556.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5678915335371326, "mean_raw_obs_processing_ms": 0.09561690686597595, "mean_inference_ms": 1.628959541734218, "mean_action_processing_ms": 0.046315144081978635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timers": {"sample_time_ms": 7831.597, "sample_throughput": 510.752, "learn_time_ms": 12245.107, "learn_throughput": 326.661, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.83791010081768, "policy_loss": -0.031809538369998336, "vf_loss": 8.864721804857254, "vf_explained_var": 0.7493581771850586, "kl": 0.010400162369478494, "entropy": 0.2177822762168944, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 72, "training_iteration": 180, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-02-35", "timestamp": 1618142555, "time_this_iter_s": 20.25271224975586, "time_total_s": 3916.3912427425385, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcf50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3916.3912427425385, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 58.48620689655172, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 556.0, "episode_reward_min": 556.0, "episode_reward_mean": 556.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [556.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5678915335371326, "mean_raw_obs_processing_ms": 0.09561690686597595, "mean_inference_ms": 1.628959541734218, "mean_action_processing_ms": 0.046315144081978635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 724000, "timers": {"sample_time_ms": 7846.566, "sample_throughput": 509.777, "learn_time_ms": 12222.622, "learn_throughput": 327.262, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 15.451054811477661, "policy_loss": -0.03572057862766087, "vf_loss": 15.48008382320404, "vf_explained_var": 0.7222341299057007, "kl": 0.013925013889092952, "entropy": 0.18957016384229064, "entropy_coeff": 0.0}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 72, "training_iteration": 181, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-02-56", "timestamp": 1618142576, "time_this_iter_s": 20.277220726013184, "time_total_s": 3936.6684634685516, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3936.6684634685516, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 59.00689655172414, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 556.0, "episode_reward_min": 556.0, "episode_reward_mean": 556.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [556.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5678915335371326, "mean_raw_obs_processing_ms": 0.09561690686597595, "mean_inference_ms": 1.628959541734218, "mean_action_processing_ms": 0.046315144081978635}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 728000, "timers": {"sample_time_ms": 7847.721, "sample_throughput": 509.702, "learn_time_ms": 12217.007, "learn_throughput": 327.412, "update_time_ms": 3.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 11.166821420192719, "policy_loss": -0.026473036472452804, "vf_loss": 11.188786581158638, "vf_explained_var": 0.7818443179130554, "kl": 0.009380953022628091, "entropy": 0.22193981148302555, "entropy_coeff": 0.0}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 72, "training_iteration": 182, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-03-16", "timestamp": 1618142596, "time_this_iter_s": 20.271934986114502, "time_total_s": 3956.940398454666, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3956.940398454666, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 58.731034482758616, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1027.0, "episode_reward_min": 1027.0, "episode_reward_mean": 1027.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1027.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5616795375520639, "mean_raw_obs_processing_ms": 0.09592338392257922, "mean_inference_ms": 1.6286302352308868, "mean_action_processing_ms": 0.04630602180582172}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 732000, "timers": {"sample_time_ms": 7831.138, "sample_throughput": 510.781, "learn_time_ms": 12210.646, "learn_throughput": 327.583, "update_time_ms": 3.149}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 17.13425302505493, "policy_loss": -0.026659979484975338, "vf_loss": 17.157393217086792, "vf_explained_var": 0.6069219708442688, "kl": 0.007325024875171948, "entropy": 0.17602273309603333, "entropy_coeff": 0.0}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 73, "training_iteration": 183, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-03-36", "timestamp": 1618142616, "time_this_iter_s": 20.097376585006714, "time_total_s": 3977.037775039673, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68cecd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3977.037775039673, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 57.74137931034482, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1027.0, "episode_reward_min": 1027.0, "episode_reward_mean": 1027.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1027.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5616795375520639, "mean_raw_obs_processing_ms": 0.09592338392257922, "mean_inference_ms": 1.6286302352308868, "mean_action_processing_ms": 0.04630602180582172}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 736000, "timers": {"sample_time_ms": 7818.91, "sample_throughput": 511.58, "learn_time_ms": 12194.362, "learn_throughput": 328.02, "update_time_ms": 3.19}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 10.037096604704857, "policy_loss": -0.0305113939975854, "vf_loss": 10.06280805170536, "vf_explained_var": 0.5032383799552917, "kl": 0.00998879763938021, "entropy": 0.1898258626461029, "entropy_coeff": 0.0}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 73, "training_iteration": 184, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-03-56", "timestamp": 1618142636, "time_this_iter_s": 20.17980670928955, "time_total_s": 3997.2175817489624, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ecd10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3997.2175817489624, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 58.510344827586216, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 783.0, "episode_reward_min": 783.0, "episode_reward_mean": 783.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [783.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5575447812234047, "mean_raw_obs_processing_ms": 0.09612534265939957, "mean_inference_ms": 1.6285937493500589, "mean_action_processing_ms": 0.046305268127089794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 740000, "timers": {"sample_time_ms": 7811.486, "sample_throughput": 512.066, "learn_time_ms": 12180.646, "learn_throughput": 328.39, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 7.617487147450447, "policy_loss": -0.0335821503540501, "vf_loss": 7.645458102226257, "vf_explained_var": 0.6534954309463501, "kl": 0.011676830836222507, "entropy": 0.25212282314896584, "entropy_coeff": 0.0}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 74, "training_iteration": 185, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-04-17", "timestamp": 1618142657, "time_this_iter_s": 20.19581937789917, "time_total_s": 4017.4134011268616, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4017.4134011268616, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 58.68620689655172, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 783.0, "episode_reward_min": 783.0, "episode_reward_mean": 783.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [783.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5575447812234047, "mean_raw_obs_processing_ms": 0.09612534265939957, "mean_inference_ms": 1.6285937493500589, "mean_action_processing_ms": 0.046305268127089794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timers": {"sample_time_ms": 7817.556, "sample_throughput": 511.669, "learn_time_ms": 12228.342, "learn_throughput": 327.109, "update_time_ms": 3.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 9.39315028488636, "policy_loss": -0.032534451922401786, "vf_loss": 9.421072080731392, "vf_explained_var": 0.6522499322891235, "kl": 0.009599162760423496, "entropy": 0.23517101537436247, "entropy_coeff": 0.0}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 74, "training_iteration": 186, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-04-37", "timestamp": 1618142677, "time_this_iter_s": 20.21367907524109, "time_total_s": 4037.6270802021027, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4037.6270802021027, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 58.789655172413795, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 783.0, "episode_reward_min": 783.0, "episode_reward_mean": 783.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [783.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5575447812234047, "mean_raw_obs_processing_ms": 0.09612534265939957, "mean_inference_ms": 1.6285937493500589, "mean_action_processing_ms": 0.046305268127089794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 748000, "timers": {"sample_time_ms": 7816.138, "sample_throughput": 511.762, "learn_time_ms": 12280.526, "learn_throughput": 325.719, "update_time_ms": 3.201}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 7.896501645445824, "policy_loss": -0.030844756052829325, "vf_loss": 7.922822341322899, "vf_explained_var": 0.4889022707939148, "kl": 0.00941443326883018, "entropy": 0.2553327027708292, "entropy_coeff": 0.0}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 74, "training_iteration": 187, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-04-57", "timestamp": 1618142697, "time_this_iter_s": 20.122752904891968, "time_total_s": 4057.7498331069946, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fa90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4057.7498331069946, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 57.824999999999996, "ram_util_percent": 27.399999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 761.0, "episode_reward_min": 761.0, "episode_reward_mean": 761.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [761.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5515508444474374, "mean_raw_obs_processing_ms": 0.09642469266802892, "mean_inference_ms": 1.628399584520722, "mean_action_processing_ms": 0.046303269961415955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 752000, "timers": {"sample_time_ms": 7910.057, "sample_throughput": 505.685, "learn_time_ms": 12273.898, "learn_throughput": 325.895, "update_time_ms": 3.241}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 12.941679775714874, "policy_loss": -0.03154965932480991, "vf_loss": 12.969435572624207, "vf_explained_var": 0.29629677534103394, "kl": 0.007894827191194054, "entropy": 0.11069988552480936, "entropy_coeff": 0.0}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 75, "training_iteration": 188, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-05-17", "timestamp": 1618142717, "time_this_iter_s": 20.3347909450531, "time_total_s": 4078.0846240520477, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4078.0846240520477, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 58.71034482758621, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 761.0, "episode_reward_min": 761.0, "episode_reward_mean": 761.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [761.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5515508444474374, "mean_raw_obs_processing_ms": 0.09642469266802892, "mean_inference_ms": 1.628399584520722, "mean_action_processing_ms": 0.046303269961415955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 756000, "timers": {"sample_time_ms": 7958.795, "sample_throughput": 502.589, "learn_time_ms": 12267.579, "learn_throughput": 326.063, "update_time_ms": 3.239}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 12.89433640241623, "policy_loss": -0.0241660182364285, "vf_loss": 12.914026767015457, "vf_explained_var": 0.5801141858100891, "kl": 0.009313843547715805, "entropy": 0.13028547842986882, "entropy_coeff": 0.0}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 75, "training_iteration": 189, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-05-38", "timestamp": 1618142738, "time_this_iter_s": 20.418086767196655, "time_total_s": 4098.502710819244, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e06d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4098.502710819244, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 58.55666666666668, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1432.0, "episode_reward_min": 1432.0, "episode_reward_mean": 1432.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1432.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.547821769359539, "mean_raw_obs_processing_ms": 0.09666277721270979, "mean_inference_ms": 1.6288034380433511, "mean_action_processing_ms": 0.046316599135054724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 760000, "timers": {"sample_time_ms": 7971.268, "sample_throughput": 501.802, "learn_time_ms": 12278.515, "learn_throughput": 325.772, "update_time_ms": 3.258}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 12.834572464227676, "policy_loss": -0.03389918079483323, "vf_loss": 12.863952726125717, "vf_explained_var": 0.5400489568710327, "kl": 0.009403730015037581, "entropy": 0.14546163496561348, "entropy_coeff": 0.0}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 76, "training_iteration": 190, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-05-58", "timestamp": 1618142758, "time_this_iter_s": 20.48793363571167, "time_total_s": 4118.990644454956, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4118.990644454956, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 59.28275862068965, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1432.0, "episode_reward_min": 1432.0, "episode_reward_mean": 1432.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1432.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.547821769359539, "mean_raw_obs_processing_ms": 0.09666277721270979, "mean_inference_ms": 1.6288034380433511, "mean_action_processing_ms": 0.046316599135054724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 764000, "timers": {"sample_time_ms": 7964.356, "sample_throughput": 502.238, "learn_time_ms": 12278.653, "learn_throughput": 325.769, "update_time_ms": 3.416}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 12.417336076498032, "policy_loss": -0.028057283838279545, "vf_loss": 12.440827548503876, "vf_explained_var": 0.6356222629547119, "kl": 0.009501299500698224, "entropy": 0.16498141339980066, "entropy_coeff": 0.0}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 76, "training_iteration": 191, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-06-19", "timestamp": 1618142779, "time_this_iter_s": 20.210468292236328, "time_total_s": 4139.201112747192, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68cedd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4139.201112747192, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 58.12413793103449, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1432.0, "episode_reward_min": 1432.0, "episode_reward_mean": 1432.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1432.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.547821769359539, "mean_raw_obs_processing_ms": 0.09666277721270979, "mean_inference_ms": 1.6288034380433511, "mean_action_processing_ms": 0.046316599135054724}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timers": {"sample_time_ms": 7975.852, "sample_throughput": 501.514, "learn_time_ms": 12266.879, "learn_throughput": 326.081, "update_time_ms": 3.352}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.710693567991257, "policy_loss": -0.03068789083044976, "vf_loss": 8.737161964178085, "vf_explained_var": 0.5821874141693115, "kl": 0.008780968957580626, "entropy": 0.2172253020107746, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 76, "training_iteration": 192, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-06-39", "timestamp": 1618142799, "time_this_iter_s": 20.26891565322876, "time_total_s": 4159.470028400421, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68cecd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4159.470028400421, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 58.05517241379311, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 765.0, "episode_reward_min": 765.0, "episode_reward_mean": 765.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [765.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5422074976414979, "mean_raw_obs_processing_ms": 0.09697549616589092, "mean_inference_ms": 1.629239942271596, "mean_action_processing_ms": 0.04633211708717889}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 772000, "timers": {"sample_time_ms": 8030.525, "sample_throughput": 498.099, "learn_time_ms": 12271.467, "learn_throughput": 325.959, "update_time_ms": 3.289}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 17.847520142793655, "policy_loss": -0.027866393444128335, "vf_loss": 17.871346831321716, "vf_explained_var": 0.6041191816329956, "kl": 0.00840644164418336, "entropy": 0.1642183770891279, "entropy_coeff": 0.0}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 77, "training_iteration": 193, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-07-00", "timestamp": 1618142820, "time_this_iter_s": 20.691242694854736, "time_total_s": 4180.161271095276, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3df50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4180.161271095276, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 59.34137931034484, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 765.0, "episode_reward_min": 765.0, "episode_reward_mean": 765.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [765.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5422074976414979, "mean_raw_obs_processing_ms": 0.09697549616589092, "mean_inference_ms": 1.629239942271596, "mean_action_processing_ms": 0.04633211708717889}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 776000, "timers": {"sample_time_ms": 8050.386, "sample_throughput": 496.871, "learn_time_ms": 12294.318, "learn_throughput": 325.354, "update_time_ms": 3.324}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 17.384753078222275, "policy_loss": -0.02587772798142396, "vf_loss": 17.40654107928276, "vf_explained_var": 0.6929221153259277, "kl": 0.00851054600207135, "entropy": 0.14926722552627325, "entropy_coeff": 0.0}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 77, "training_iteration": 194, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-07-20", "timestamp": 1618142840, "time_this_iter_s": 20.60891366004944, "time_total_s": 4200.770184755325, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221fa50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4200.770184755325, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 58.836666666666666, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1215.0, "episode_reward_min": 1215.0, "episode_reward_mean": 1215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5386220350801774, "mean_raw_obs_processing_ms": 0.09718784196702203, "mean_inference_ms": 1.6292980375133186, "mean_action_processing_ms": 0.046330723907660035}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 780000, "timers": {"sample_time_ms": 8050.805, "sample_throughput": 496.845, "learn_time_ms": 12315.913, "learn_throughput": 324.783, "update_time_ms": 3.315}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 12.785257786512375, "policy_loss": -0.02586364044691436, "vf_loss": 12.806405395269394, "vf_explained_var": 0.4513590931892395, "kl": 0.009813772892812267, "entropy": 0.19013261329382658, "entropy_coeff": 0.0}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 78, "training_iteration": 195, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-07-41", "timestamp": 1618142861, "time_this_iter_s": 20.418407917022705, "time_total_s": 4221.188592672348, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4221.188592672348, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 58.396551724137936, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1215.0, "episode_reward_min": 1215.0, "episode_reward_mean": 1215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5386220350801774, "mean_raw_obs_processing_ms": 0.09718784196702203, "mean_inference_ms": 1.6292980375133186, "mean_action_processing_ms": 0.046330723907660035}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 784000, "timers": {"sample_time_ms": 8064.51, "sample_throughput": 496.0, "learn_time_ms": 12309.873, "learn_throughput": 324.942, "update_time_ms": 3.466}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 3.4709785878658295, "policy_loss": -0.03189396735979244, "vf_loss": 3.498444400727749, "vf_explained_var": 0.3027331829071045, "kl": 0.009214959281962365, "entropy": 0.24370080325752497, "entropy_coeff": 0.0}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 78, "training_iteration": 196, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-08-01", "timestamp": 1618142881, "time_this_iter_s": 20.291918516159058, "time_total_s": 4241.480511188507, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4241.480511188507, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 58.1448275862069, "ram_util_percent": 27.39999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1215.0, "episode_reward_min": 1215.0, "episode_reward_mean": 1215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5386220350801774, "mean_raw_obs_processing_ms": 0.09718784196702203, "mean_inference_ms": 1.6292980375133186, "mean_action_processing_ms": 0.046330723907660035}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 788000, "timers": {"sample_time_ms": 8081.989, "sample_throughput": 494.928, "learn_time_ms": 12309.087, "learn_throughput": 324.963, "update_time_ms": 3.448}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 2.9343763925135136, "policy_loss": -0.03007253637770191, "vf_loss": 2.959801260381937, "vf_explained_var": 0.5734764337539673, "kl": 0.009671647392679006, "entropy": 0.2633607699535787, "entropy_coeff": 0.0}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 78, "training_iteration": 197, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-08-21", "timestamp": 1618142901, "time_this_iter_s": 20.29274344444275, "time_total_s": 4261.77325463295, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4261.77325463295, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 58.475862068965526, "ram_util_percent": 27.4103448275862}, "trial_id": "9be58_00000"}
{"episode_reward_max": 243.0, "episode_reward_min": 243.0, "episode_reward_mean": 243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5330876723287815, "mean_raw_obs_processing_ms": 0.09751056782255128, "mean_inference_ms": 1.629500755570893, "mean_action_processing_ms": 0.04633654869277925}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timers": {"sample_time_ms": 8076.849, "sample_throughput": 495.243, "learn_time_ms": 12327.617, "learn_throughput": 324.475, "update_time_ms": 3.389}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 2.6684435456991196, "policy_loss": -0.030131995561532676, "vf_loss": 2.6945161186158657, "vf_explained_var": 0.509666919708252, "kl": 0.008447562038782053, "entropy": 0.27233445132151246, "entropy_coeff": 0.0}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 79, "training_iteration": 198, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-08-42", "timestamp": 1618142922, "time_this_iter_s": 20.46893620491028, "time_total_s": 4282.24219083786, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4282.24219083786, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 59.09655172413793, "ram_util_percent": 27.49655172413793}, "trial_id": "9be58_00000"}
{"episode_reward_max": 243.0, "episode_reward_min": 243.0, "episode_reward_mean": 243.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5330876723287815, "mean_raw_obs_processing_ms": 0.09751056782255128, "mean_inference_ms": 1.629500755570893, "mean_action_processing_ms": 0.04633654869277925}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 796000, "timers": {"sample_time_ms": 8062.137, "sample_throughput": 496.146, "learn_time_ms": 12345.058, "learn_throughput": 324.016, "update_time_ms": 3.408}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 6.38179837167263, "policy_loss": -0.025992408278398216, "vf_loss": 6.402652859687805, "vf_explained_var": 0.796237587928772, "kl": 0.010691943040001206, "entropy": 0.24585853330790997, "entropy_coeff": 0.0}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 79, "training_iteration": 199, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-09-02", "timestamp": 1618142942, "time_this_iter_s": 20.443190813064575, "time_total_s": 4302.685381650925, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4302.685381650925, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 58.73448275862068, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 392.0, "episode_reward_min": 392.0, "episode_reward_mean": 392.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5295489826531958, "mean_raw_obs_processing_ms": 0.09772582236176501, "mean_inference_ms": 1.6296215015268378, "mean_action_processing_ms": 0.04633949298801398}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 800000, "timers": {"sample_time_ms": 8041.126, "sample_throughput": 497.443, "learn_time_ms": 12352.912, "learn_throughput": 323.81, "update_time_ms": 3.435}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 6.7631260603666306, "policy_loss": -0.03871409484418109, "vf_loss": 6.7952442318201065, "vf_explained_var": 0.5237295627593994, "kl": 0.013725789583986625, "entropy": 0.21369678294286132, "entropy_coeff": 0.0}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 80, "training_iteration": 200, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-09-23", "timestamp": 1618142963, "time_this_iter_s": 20.355588674545288, "time_total_s": 4323.04097032547, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4323.04097032547, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 58.265517241379314, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 392.0, "episode_reward_min": 392.0, "episode_reward_mean": 392.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5295489826531958, "mean_raw_obs_processing_ms": 0.09772582236176501, "mean_inference_ms": 1.6296215015268378, "mean_action_processing_ms": 0.04633949298801398}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 804000, "timers": {"sample_time_ms": 8045.366, "sample_throughput": 497.181, "learn_time_ms": 12356.602, "learn_throughput": 323.714, "update_time_ms": 3.2}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 1.4176472537219524, "policy_loss": -0.03034268063493073, "vf_loss": 1.4434819128364325, "vf_explained_var": 0.6233680248260498, "kl": 0.00938110904826317, "entropy": 0.26147495536133647, "entropy_coeff": 0.0}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 80, "training_iteration": 201, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-09-43", "timestamp": 1618142983, "time_this_iter_s": 20.285311937332153, "time_total_s": 4343.326282262802, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4343.326282262802, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 58.08275862068965, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 392.0, "episode_reward_min": 392.0, "episode_reward_mean": 392.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5295489826531958, "mean_raw_obs_processing_ms": 0.09772582236176501, "mean_inference_ms": 1.6296215015268378, "mean_action_processing_ms": 0.04633949298801398}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 808000, "timers": {"sample_time_ms": 8048.288, "sample_throughput": 497.0, "learn_time_ms": 12350.938, "learn_throughput": 323.862, "update_time_ms": 3.261}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 8.342365875840187, "policy_loss": -0.034371973073575646, "vf_loss": 8.371612682938576, "vf_explained_var": 0.6989387273788452, "kl": 0.010665421126759611, "entropy": 0.21048728236928582, "entropy_coeff": 0.0}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 80, "training_iteration": 202, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-10-03", "timestamp": 1618143003, "time_this_iter_s": 20.238747119903564, "time_total_s": 4363.565029382706, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4363.565029382706, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 58.68275862068966, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 659.0, "episode_reward_min": 659.0, "episode_reward_mean": 659.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [659.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5251361038941875, "mean_raw_obs_processing_ms": 0.09804679659256467, "mean_inference_ms": 1.6298002113621968, "mean_action_processing_ms": 0.04635048487855174}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 812000, "timers": {"sample_time_ms": 8079.923, "sample_throughput": 495.054, "learn_time_ms": 12345.797, "learn_throughput": 323.997, "update_time_ms": 3.299}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.48054199218750004, "cur_lr": 5e-05, "total_loss": 16.720275312662125, "policy_loss": -0.034360188379650936, "vf_loss": 16.744996517896652, "vf_explained_var": 0.44149577617645264, "kl": 0.02005931385792792, "entropy": 0.1393958213739097, "entropy_coeff": 0.0}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 81, "training_iteration": 203, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-10-24", "timestamp": 1618143024, "time_this_iter_s": 20.954353094100952, "time_total_s": 4384.519382476807, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e55d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4384.519382476807, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 59.29666666666667, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 659.0, "episode_reward_min": 659.0, "episode_reward_mean": 659.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [659.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5251361038941875, "mean_raw_obs_processing_ms": 0.09804679659256467, "mean_inference_ms": 1.6298002113621968, "mean_action_processing_ms": 0.04635048487855174}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 816000, "timers": {"sample_time_ms": 8131.287, "sample_throughput": 491.927, "learn_time_ms": 12320.381, "learn_throughput": 324.665, "update_time_ms": 3.25}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 13.670387774705887, "policy_loss": -0.03403270913986489, "vf_loss": 13.690491139888763, "vf_explained_var": 0.5903246402740479, "kl": 0.019324696957482956, "entropy": 0.10971603146754205, "entropy_coeff": 0.0}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 81, "training_iteration": 204, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-10-45", "timestamp": 1618143045, "time_this_iter_s": 20.865004777908325, "time_total_s": 4405.384387254715, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4405.384387254715, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 58.556666666666665, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1603.0, "episode_reward_min": 1603.0, "episode_reward_mean": 1603.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1603.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5254379490973043, "mean_raw_obs_processing_ms": 0.09825477916717143, "mean_inference_ms": 1.629861132362102, "mean_action_processing_ms": 0.046347474936915746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 820000, "timers": {"sample_time_ms": 8373.115, "sample_throughput": 477.719, "learn_time_ms": 12294.154, "learn_throughput": 325.358, "update_time_ms": 3.26}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 9.021101832389832, "policy_loss": -0.01567128094029613, "vf_loss": 9.02705879509449, "vf_explained_var": 0.40046972036361694, "kl": 0.01347668285598047, "entropy": 0.09858166496269405, "entropy_coeff": 0.0}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 82, "training_iteration": 205, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-11-08", "timestamp": 1618143068, "time_this_iter_s": 22.572001457214355, "time_total_s": 4427.956388711929, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4427.956388711929, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 58.359375, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1603.0, "episode_reward_min": 1603.0, "episode_reward_mean": 1603.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1603.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5254379490973043, "mean_raw_obs_processing_ms": 0.09825477916717143, "mean_inference_ms": 1.629861132362102, "mean_action_processing_ms": 0.046347474936915746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 824000, "timers": {"sample_time_ms": 8413.478, "sample_throughput": 475.428, "learn_time_ms": 12284.555, "learn_throughput": 325.612, "update_time_ms": 3.099}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 11.75711715221405, "policy_loss": -0.03456554876174778, "vf_loss": 11.781906455755234, "vf_explained_var": 0.4646345376968384, "kl": 0.013562914376961999, "entropy": 0.11991583206690848, "entropy_coeff": 0.0}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 82, "training_iteration": 206, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-11-28", "timestamp": 1618143088, "time_this_iter_s": 20.598207235336304, "time_total_s": 4448.554595947266, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ded0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d93d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4448.554595947266, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 58.433333333333344, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1603.0, "episode_reward_min": 1603.0, "episode_reward_mean": 1603.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1603.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5254379490973043, "mean_raw_obs_processing_ms": 0.09825477916717143, "mean_inference_ms": 1.629861132362102, "mean_action_processing_ms": 0.046347474936915746}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 828000, "timers": {"sample_time_ms": 8599.152, "sample_throughput": 465.162, "learn_time_ms": 12278.592, "learn_throughput": 325.77, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7208129882812501, "cur_lr": 5e-05, "total_loss": 17.165978014469147, "policy_loss": -0.04276389683946036, "vf_loss": 17.180907517671585, "vf_explained_var": 0.49945390224456787, "kl": 0.03861547145061195, "entropy": 0.15205608471296728, "entropy_coeff": 0.0}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 82, "training_iteration": 207, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-11-51", "timestamp": 1618143111, "time_this_iter_s": 22.08724594116211, "time_total_s": 4470.641841888428, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4470.641841888428, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 58.74516129032258, "ram_util_percent": 27.490322580645163}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1556.0, "episode_reward_min": 1556.0, "episode_reward_mean": 1556.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1556.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5265449023334482, "mean_raw_obs_processing_ms": 0.09858088210277027, "mean_inference_ms": 1.6298608862631496, "mean_action_processing_ms": 0.0463475993631203}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 832000, "timers": {"sample_time_ms": 8875.254, "sample_throughput": 450.691, "learn_time_ms": 12253.452, "learn_throughput": 326.439, "update_time_ms": 3.101}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 9.323487043380737, "policy_loss": -0.03490865039930213, "vf_loss": 9.344420164823532, "vf_explained_var": 0.3089481592178345, "kl": 0.012925676317536272, "entropy": 0.10279780009295791, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 83, "training_iteration": 208, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-12-14", "timestamp": 1618143134, "time_this_iter_s": 22.977632761001587, "time_total_s": 4493.619474649429, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4493.619474649429, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 58.160606060606064, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1556.0, "episode_reward_min": 1556.0, "episode_reward_mean": 1556.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1556.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5265449023334482, "mean_raw_obs_processing_ms": 0.09858088210277027, "mean_inference_ms": 1.6298608862631496, "mean_action_processing_ms": 0.0463475993631203}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 836000, "timers": {"sample_time_ms": 9026.923, "sample_throughput": 443.119, "learn_time_ms": 12237.664, "learn_throughput": 326.86, "update_time_ms": 3.035}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 10.682431876659393, "policy_loss": -0.021497596928384155, "vf_loss": 10.695330530405045, "vf_explained_var": 0.5212675333023071, "kl": 0.007952916595968418, "entropy": 0.11748773464933038, "entropy_coeff": 0.0}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 83, "training_iteration": 209, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-12-35", "timestamp": 1618143155, "time_this_iter_s": 21.80396008491516, "time_total_s": 4515.4234347343445, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d25d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4515.4234347343445, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 58.22903225806452, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5310722202124092, "mean_raw_obs_processing_ms": 0.09879738819420891, "mean_inference_ms": 1.6299543654566393, "mean_action_processing_ms": 0.04635088687575708}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 840000, "timers": {"sample_time_ms": 9534.485, "sample_throughput": 419.53, "learn_time_ms": 12221.828, "learn_throughput": 327.283, "update_time_ms": 2.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 11.846881061792374, "policy_loss": -0.022311784676276147, "vf_loss": 11.862098842859268, "vf_explained_var": 0.5141677856445312, "kl": 0.006561230577062815, "entropy": 0.09925114992074668, "entropy_coeff": 0.0}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 84, "training_iteration": 210, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-13-01", "timestamp": 1618143181, "time_this_iter_s": 25.268638134002686, "time_total_s": 4540.692072868347, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d23d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4540.692072868347, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 58.56666666666667, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5310722202124092, "mean_raw_obs_processing_ms": 0.09879738819420891, "mean_inference_ms": 1.6299543654566393, "mean_action_processing_ms": 0.04635088687575708}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 844000, "timers": {"sample_time_ms": 9594.119, "sample_throughput": 416.922, "learn_time_ms": 12222.119, "learn_throughput": 327.275, "update_time_ms": 3.094}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 11.85131686925888, "policy_loss": -0.031028690573293716, "vf_loss": 11.87443482875824, "vf_explained_var": 0.5171880722045898, "kl": 0.007316549395909533, "entropy": 0.1193876916076988, "entropy_coeff": 0.0}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 84, "training_iteration": 211, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-13-22", "timestamp": 1618143202, "time_this_iter_s": 20.886566400527954, "time_total_s": 4561.578639268875, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcd50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4561.578639268875, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 59.07333333333334, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1942.0, "episode_reward_min": 1942.0, "episode_reward_mean": 1942.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1942.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5310722202124092, "mean_raw_obs_processing_ms": 0.09879738819420891, "mean_inference_ms": 1.6299543654566393, "mean_action_processing_ms": 0.04635088687575708}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 848000, "timers": {"sample_time_ms": 9635.919, "sample_throughput": 415.114, "learn_time_ms": 12236.857, "learn_throughput": 326.881, "update_time_ms": 3.055}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 16.175693809986115, "policy_loss": -0.02252748457249254, "vf_loss": 16.192662060260773, "vf_explained_var": 0.5133581161499023, "kl": 0.005141656976775266, "entropy": 0.11793259670957923, "entropy_coeff": 0.0}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 84, "training_iteration": 212, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-13-42", "timestamp": 1618143222, "time_this_iter_s": 20.805105924606323, "time_total_s": 4582.383745193481, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4582.383745193481, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 58.51, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1718.0, "episode_reward_min": 1718.0, "episode_reward_mean": 1718.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1718.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5292997894588704, "mean_raw_obs_processing_ms": 0.09910551016357648, "mean_inference_ms": 1.630022878990632, "mean_action_processing_ms": 0.046348592932770306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 852000, "timers": {"sample_time_ms": 9735.461, "sample_throughput": 410.869, "learn_time_ms": 12244.901, "learn_throughput": 326.667, "update_time_ms": 3.065}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 9.149060189723969, "policy_loss": -0.041528147470671684, "vf_loss": 9.176729172468185, "vf_explained_var": 0.4738693833351135, "kl": 0.01281798689160496, "entropy": 0.09638713498134166, "entropy_coeff": 0.0}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 85, "training_iteration": 213, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-14-04", "timestamp": 1618143244, "time_this_iter_s": 22.032986879348755, "time_total_s": 4604.41673207283, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3df10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcf10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4604.41673207283, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 58.25161290322579, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1718.0, "episode_reward_min": 1718.0, "episode_reward_mean": 1718.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1718.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5292997894588704, "mean_raw_obs_processing_ms": 0.09910551016357648, "mean_inference_ms": 1.630022878990632, "mean_action_processing_ms": 0.046348592932770306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 856000, "timers": {"sample_time_ms": 9980.822, "sample_throughput": 400.769, "learn_time_ms": 12244.771, "learn_throughput": 326.67, "update_time_ms": 3.022}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 9.156433388590813, "policy_loss": -0.01904793715220876, "vf_loss": 9.167196795344353, "vf_explained_var": 0.30301010608673096, "kl": 0.007662364841962699, "entropy": 0.10022885957732797, "entropy_coeff": 0.0}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 85, "training_iteration": 214, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-14-28", "timestamp": 1618143268, "time_this_iter_s": 23.32069444656372, "time_total_s": 4627.737426519394, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e59d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4627.737426519394, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 58.15151515151515, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2032.0, "episode_reward_min": 2032.0, "episode_reward_mean": 2032.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2032.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5326237581535941, "mean_raw_obs_processing_ms": 0.09932782799390687, "mean_inference_ms": 1.6301594849563066, "mean_action_processing_ms": 0.04635279444270047}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 860000, "timers": {"sample_time_ms": 10010.312, "sample_throughput": 399.588, "learn_time_ms": 12268.578, "learn_throughput": 326.036, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.081219482421875, "cur_lr": 5e-05, "total_loss": 14.309906095266342, "policy_loss": -0.05320824508089572, "vf_loss": 14.329785615205765, "vf_explained_var": 0.57779860496521, "kl": 0.030825037305476144, "entropy": 0.13958447915501893, "entropy_coeff": 0.0}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 86, "training_iteration": 215, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-14-51", "timestamp": 1618143291, "time_this_iter_s": 23.104938745498657, "time_total_s": 4650.842365264893, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4650.842365264893, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 58.39696969696969, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2032.0, "episode_reward_min": 2032.0, "episode_reward_mean": 2032.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2032.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5326237581535941, "mean_raw_obs_processing_ms": 0.09932782799390687, "mean_inference_ms": 1.6301594849563066, "mean_action_processing_ms": 0.04635279444270047}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 864000, "timers": {"sample_time_ms": 9971.869, "sample_throughput": 401.128, "learn_time_ms": 12268.066, "learn_throughput": 326.05, "update_time_ms": 3.029}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6218292236328127, "cur_lr": 5e-05, "total_loss": 12.027182936668396, "policy_loss": -0.020748461422044784, "vf_loss": 12.042124211788177, "vf_explained_var": 0.46907490491867065, "kl": 0.003580669541406678, "entropy": 0.11455398425459862, "entropy_coeff": 0.0}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 86, "training_iteration": 216, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-15-11", "timestamp": 1618143311, "time_this_iter_s": 20.20773482322693, "time_total_s": 4671.0501000881195, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ed90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3373dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4671.0501000881195, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 58.8551724137931, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 2032.0, "episode_reward_min": 2032.0, "episode_reward_mean": 2032.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2032.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5326237581535941, "mean_raw_obs_processing_ms": 0.09932782799390687, "mean_inference_ms": 1.6301594849563066, "mean_action_processing_ms": 0.04635279444270047}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 868000, "timers": {"sample_time_ms": 9806.037, "sample_throughput": 407.912, "learn_time_ms": 12281.279, "learn_throughput": 325.699, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8109146118164063, "cur_lr": 5e-05, "total_loss": 11.440943956375122, "policy_loss": -0.028466211137128994, "vf_loss": 11.46278528869152, "vf_explained_var": 0.6995335817337036, "kl": 0.008169537803041749, "entropy": 0.15513516496866941, "entropy_coeff": 0.0}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 86, "training_iteration": 217, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-15-32", "timestamp": 1618143332, "time_this_iter_s": 20.560521125793457, "time_total_s": 4691.610621213913, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4691.610621213913, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 58.57333333333334, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1381.0, "episode_reward_min": 1381.0, "episode_reward_mean": 1381.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1381.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5283276299362085, "mean_raw_obs_processing_ms": 0.09964075577269439, "mean_inference_ms": 1.6302394832164908, "mean_action_processing_ms": 0.04635499529145667}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 872000, "timers": {"sample_time_ms": 9560.572, "sample_throughput": 418.385, "learn_time_ms": 12299.637, "learn_throughput": 325.213, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8109146118164063, "cur_lr": 5e-05, "total_loss": 20.22837859392166, "policy_loss": -0.054889830615138635, "vf_loss": 20.25611686706543, "vf_explained_var": 0.4894212484359741, "kl": 0.033482633298262954, "entropy": 0.16709674592129886, "entropy_coeff": 0.0}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 87, "training_iteration": 218, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-15-53", "timestamp": 1618143353, "time_this_iter_s": 20.70705556869507, "time_total_s": 4712.317676782608, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcd10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4712.317676782608, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 58.806896551724144, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1381.0, "episode_reward_min": 1381.0, "episode_reward_mean": 1381.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1381.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5283276299362085, "mean_raw_obs_processing_ms": 0.09964075577269439, "mean_inference_ms": 1.6302394832164908, "mean_action_processing_ms": 0.04635499529145667}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 876000, "timers": {"sample_time_ms": 9538.656, "sample_throughput": 419.346, "learn_time_ms": 12314.287, "learn_throughput": 324.826, "update_time_ms": 3.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2163719177246095, "cur_lr": 5e-05, "total_loss": 15.584751784801483, "policy_loss": -0.03319661467685364, "vf_loss": 15.602966666221619, "vf_explained_var": 0.5351854562759399, "kl": 0.012316927663050592, "entropy": 0.12285366398282349, "entropy_coeff": 0.0}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 87, "training_iteration": 219, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-16-14", "timestamp": 1618143374, "time_this_iter_s": 21.73141360282898, "time_total_s": 4734.049090385437, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e2d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4734.049090385437, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 58.40322580645161, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1514.0, "episode_reward_min": 1514.0, "episode_reward_mean": 1514.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1514.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289851395313072, "mean_raw_obs_processing_ms": 0.09985716997728364, "mean_inference_ms": 1.6303936038866873, "mean_action_processing_ms": 0.046358836931788064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 880000, "timers": {"sample_time_ms": 9247.062, "sample_throughput": 432.57, "learn_time_ms": 12315.917, "learn_throughput": 324.783, "update_time_ms": 3.13}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2163719177246095, "cur_lr": 5e-05, "total_loss": 17.111793041229248, "policy_loss": -0.005668390076607466, "vf_loss": 17.11196279525757, "vf_explained_var": 0.5275744199752808, "kl": 0.004520606926234905, "entropy": 0.07681886514183134, "entropy_coeff": 0.0}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 88, "training_iteration": 220, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-16-37", "timestamp": 1618143397, "time_this_iter_s": 22.37277388572693, "time_total_s": 4756.421864271164, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338abd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4756.421864271164, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 58.5625, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1514.0, "episode_reward_min": 1514.0, "episode_reward_mean": 1514.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1514.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289851395313072, "mean_raw_obs_processing_ms": 0.09985716997728364, "mean_inference_ms": 1.6303936038866873, "mean_action_processing_ms": 0.046358836931788064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 884000, "timers": {"sample_time_ms": 9355.484, "sample_throughput": 427.557, "learn_time_ms": 12326.265, "learn_throughput": 324.51, "update_time_ms": 3.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 12.157132178544998, "policy_loss": -0.03121392101456877, "vf_loss": 12.183054059743881, "vf_explained_var": 0.42304426431655884, "kl": 0.008701253740582615, "entropy": 0.10965202120132744, "entropy_coeff": 0.0}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 88, "training_iteration": 221, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-16-59", "timestamp": 1618143419, "time_this_iter_s": 22.07248091697693, "time_total_s": 4778.494345188141, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33565d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4778.494345188141, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 59.09374999999999, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1514.0, "episode_reward_min": 1514.0, "episode_reward_mean": 1514.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1514.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289851395313072, "mean_raw_obs_processing_ms": 0.09985716997728364, "mean_inference_ms": 1.6303936038866873, "mean_action_processing_ms": 0.046358836931788064}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 888000, "timers": {"sample_time_ms": 9438.976, "sample_throughput": 423.775, "learn_time_ms": 12317.125, "learn_throughput": 324.751, "update_time_ms": 3.133}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 10.429853931069374, "policy_loss": -0.042992251575924456, "vf_loss": 10.462763607501984, "vf_explained_var": 0.524715781211853, "kl": 0.01657810823235195, "entropy": 0.11818958376534283, "entropy_coeff": 0.0}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 88, "training_iteration": 222, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-17-20", "timestamp": 1618143440, "time_this_iter_s": 21.547707557678223, "time_total_s": 4800.042052745819, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221fed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4800.042052745819, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 59.24838709677418, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1521.0, "episode_reward_min": 1521.0, "episode_reward_mean": 1521.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1521.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5272595461476481, "mean_raw_obs_processing_ms": 0.10019905089656335, "mean_inference_ms": 1.6310859968655524, "mean_action_processing_ms": 0.04637014050909601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 892000, "timers": {"sample_time_ms": 9305.07, "sample_throughput": 429.873, "learn_time_ms": 12313.52, "learn_throughput": 324.846, "update_time_ms": 3.114}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 15.226333528757095, "policy_loss": -0.02849406359018758, "vf_loss": 15.246600896120071, "vf_explained_var": 0.5845668911933899, "kl": 0.013526898343116045, "entropy": 0.15857481118291616, "entropy_coeff": 0.0}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 89, "training_iteration": 223, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-17-41", "timestamp": 1618143461, "time_this_iter_s": 20.6551570892334, "time_total_s": 4820.6972098350525, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33565d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4820.6972098350525, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 58.95517241379311, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1521.0, "episode_reward_min": 1521.0, "episode_reward_mean": 1521.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1521.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5272595461476481, "mean_raw_obs_processing_ms": 0.10019905089656335, "mean_inference_ms": 1.6310859968655524, "mean_action_processing_ms": 0.04637014050909601}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 896000, "timers": {"sample_time_ms": 9168.783, "sample_throughput": 436.263, "learn_time_ms": 12348.147, "learn_throughput": 323.935, "update_time_ms": 3.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 11.844193190336227, "policy_loss": -0.026141166454181075, "vf_loss": 11.864737048745155, "vf_explained_var": 0.43060192465782166, "kl": 0.00920332667283219, "entropy": 0.09689320577308536, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 89, "training_iteration": 224, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-18-03", "timestamp": 1618143483, "time_this_iter_s": 22.301172256469727, "time_total_s": 4842.998382091522, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221fe90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4842.998382091522, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 58.7375, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1785.0, "episode_reward_min": 1785.0, "episode_reward_mean": 1785.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1785.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5275790164664642, "mean_raw_obs_processing_ms": 0.10043034123437088, "mean_inference_ms": 1.6312042136281442, "mean_action_processing_ms": 0.046374696755521534}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 900000, "timers": {"sample_time_ms": 9049.956, "sample_throughput": 441.991, "learn_time_ms": 12331.278, "learn_throughput": 324.378, "update_time_ms": 3.182}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 13.308638453483582, "policy_loss": -0.018913651874754578, "vf_loss": 13.322802007198334, "vf_explained_var": 0.5028259754180908, "kl": 0.007810151364537887, "entropy": 0.1093261435162276, "entropy_coeff": 0.0}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 90, "training_iteration": 225, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-18-25", "timestamp": 1618143505, "time_this_iter_s": 21.748682737350464, "time_total_s": 4864.747064828873, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4864.747064828873, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 58.667741935483875, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1785.0, "episode_reward_min": 1785.0, "episode_reward_mean": 1785.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1785.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5275790164664642, "mean_raw_obs_processing_ms": 0.10043034123437088, "mean_inference_ms": 1.6312042136281442, "mean_action_processing_ms": 0.046374696755521534}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 904000, "timers": {"sample_time_ms": 9123.694, "sample_throughput": 438.419, "learn_time_ms": 12354.066, "learn_throughput": 323.78, "update_time_ms": 3.208}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 17.69857767224312, "policy_loss": -0.03225350409047678, "vf_loss": 17.72475156188011, "vf_explained_var": 0.5476799011230469, "kl": 0.009996289649279788, "entropy": 0.1556153493002057, "entropy_coeff": 0.0}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 90, "training_iteration": 226, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-18-46", "timestamp": 1618143526, "time_this_iter_s": 21.17470955848694, "time_total_s": 4885.92177438736, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ec490>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ece10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4885.92177438736, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 59.12666666666667, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1785.0, "episode_reward_min": 1785.0, "episode_reward_mean": 1785.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1785.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5275790164664642, "mean_raw_obs_processing_ms": 0.10043034123437088, "mean_inference_ms": 1.6312042136281442, "mean_action_processing_ms": 0.046374696755521534}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 908000, "timers": {"sample_time_ms": 9470.607, "sample_throughput": 422.359, "learn_time_ms": 12362.74, "learn_throughput": 323.553, "update_time_ms": 3.7}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 7.519322365522385, "policy_loss": -0.02008743054466322, "vf_loss": 7.53514239192009, "vf_explained_var": 0.21396924555301666, "kl": 0.007016601266514044, "entropy": 0.08425560838077217, "entropy_coeff": 0.0}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 90, "training_iteration": 227, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-19-11", "timestamp": 1618143551, "time_this_iter_s": 24.118802547454834, "time_total_s": 4910.040576934814, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ead0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4da50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4910.040576934814, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 58.64857142857144, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1807.0, "episode_reward_min": 1807.0, "episode_reward_mean": 1807.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1807.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5296234171114426, "mean_raw_obs_processing_ms": 0.10078255865848669, "mean_inference_ms": 1.6315242548499431, "mean_action_processing_ms": 0.046381746588269546}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 912000, "timers": {"sample_time_ms": 9634.975, "sample_throughput": 415.154, "learn_time_ms": 12369.562, "learn_throughput": 323.374, "update_time_ms": 3.763}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 7.981717005372047, "policy_loss": -0.027881756715942174, "vf_loss": 8.003874093294144, "vf_explained_var": 0.429135262966156, "kl": 0.009412832019734196, "entropy": 0.10898744012229145, "entropy_coeff": 0.0}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 91, "training_iteration": 228, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-19-33", "timestamp": 1618143573, "time_this_iter_s": 22.42128038406372, "time_total_s": 4932.461857318878, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4932.461857318878, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 58.76875, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1807.0, "episode_reward_min": 1807.0, "episode_reward_mean": 1807.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1807.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5296234171114426, "mean_raw_obs_processing_ms": 0.10078255865848669, "mean_inference_ms": 1.6315242548499431, "mean_action_processing_ms": 0.046381746588269546}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 916000, "timers": {"sample_time_ms": 9670.756, "sample_throughput": 413.618, "learn_time_ms": 12383.684, "learn_throughput": 323.006, "update_time_ms": 3.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6081859588623048, "cur_lr": 5e-05, "total_loss": 12.001746594905853, "policy_loss": -0.054045368277002126, "vf_loss": 12.033796310424805, "vf_explained_var": 0.598147451877594, "kl": 0.036166016943752766, "entropy": 0.147675454383716, "entropy_coeff": 0.0}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 91, "training_iteration": 229, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-19-55", "timestamp": 1618143595, "time_this_iter_s": 22.231041193008423, "time_total_s": 4954.692898511887, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4954.692898511887, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 58.559375, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1725.0, "episode_reward_min": 1725.0, "episode_reward_mean": 1725.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1725.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289276629729343, "mean_raw_obs_processing_ms": 0.10099578561808037, "mean_inference_ms": 1.6315472096969283, "mean_action_processing_ms": 0.046382702811086716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 920000, "timers": {"sample_time_ms": 9504.374, "sample_throughput": 420.859, "learn_time_ms": 12415.324, "learn_throughput": 322.182, "update_time_ms": 3.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 10.979277342557907, "policy_loss": -0.02110707521205768, "vf_loss": 10.99101173877716, "vf_explained_var": 0.5224559307098389, "kl": 0.010273908555973321, "entropy": 0.11268585571087897, "entropy_coeff": 0.0}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 92, "training_iteration": 230, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-20-16", "timestamp": 1618143616, "time_this_iter_s": 21.021803617477417, "time_total_s": 4975.714702129364, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e54d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4975.714702129364, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 59.123333333333335, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1725.0, "episode_reward_min": 1725.0, "episode_reward_mean": 1725.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1725.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289276629729343, "mean_raw_obs_processing_ms": 0.10099578561808037, "mean_inference_ms": 1.6315472096969283, "mean_action_processing_ms": 0.046382702811086716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 924000, "timers": {"sample_time_ms": 9373.875, "sample_throughput": 426.718, "learn_time_ms": 12403.618, "learn_throughput": 322.487, "update_time_ms": 4.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 12.232388377189636, "policy_loss": -0.03454596007941291, "vf_loss": 12.260089457035065, "vf_explained_var": 0.48715561628341675, "kl": 0.007503002867451869, "entropy": 0.11987608671188354, "entropy_coeff": 0.0}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 92, "training_iteration": 231, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-20-37", "timestamp": 1618143637, "time_this_iter_s": 20.656619787216187, "time_total_s": 4996.37132191658, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4996.37132191658, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 58.02758620689655, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1725.0, "episode_reward_min": 1725.0, "episode_reward_mean": 1725.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1725.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5289276629729343, "mean_raw_obs_processing_ms": 0.10099578561808037, "mean_inference_ms": 1.6315472096969283, "mean_action_processing_ms": 0.046382702811086716}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 928000, "timers": {"sample_time_ms": 9616.552, "sample_throughput": 415.95, "learn_time_ms": 12404.335, "learn_throughput": 322.468, "update_time_ms": 3.986}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 11.147971972823143, "policy_loss": -0.030575736658647656, "vf_loss": 11.167748898267746, "vf_explained_var": 0.4326987862586975, "kl": 0.011837092053610831, "entropy": 0.08948859863448888, "entropy_coeff": 0.0}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 92, "training_iteration": 232, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-21-01", "timestamp": 1618143661, "time_this_iter_s": 23.98154640197754, "time_total_s": 5020.352868318558, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4db90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5020.352868318558, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 59.035294117647055, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1950.0, "episode_reward_min": 1950.0, "episode_reward_mean": 1950.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1950.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5335773728472712, "mean_raw_obs_processing_ms": 0.10135209097333206, "mean_inference_ms": 1.6321190496873808, "mean_action_processing_ms": 0.04639691099006491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 932000, "timers": {"sample_time_ms": 10089.246, "sample_throughput": 396.462, "learn_time_ms": 12435.829, "learn_throughput": 321.651, "update_time_ms": 4.023}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 7.897422224283218, "policy_loss": -0.026905570179224014, "vf_loss": 7.919178634881973, "vf_explained_var": 0.2672024965286255, "kl": 0.005644373559334781, "entropy": 0.08235214464366436, "entropy_coeff": 0.0}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 93, "training_iteration": 233, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-21-27", "timestamp": 1618143687, "time_this_iter_s": 25.697821378707886, "time_total_s": 5046.050689697266, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4edd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5046.050689697266, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 58.554054054054056, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1950.0, "episode_reward_min": 1950.0, "episode_reward_mean": 1950.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1950.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5335773728472712, "mean_raw_obs_processing_ms": 0.10135209097333206, "mean_inference_ms": 1.6321190496873808, "mean_action_processing_ms": 0.04639691099006491}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 936000, "timers": {"sample_time_ms": 10464.72, "sample_throughput": 382.237, "learn_time_ms": 12443.367, "learn_throughput": 321.456, "update_time_ms": 4.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9122789382934571, "cur_lr": 5e-05, "total_loss": 14.099113047122955, "policy_loss": -0.056835347786545753, "vf_loss": 14.114571332931519, "vf_explained_var": 0.7546346187591553, "kl": 0.04535590880550444, "entropy": 0.13246811204589903, "entropy_coeff": 0.0}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 93, "training_iteration": 234, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-21-53", "timestamp": 1618143713, "time_this_iter_s": 26.13712239265442, "time_total_s": 5072.18781208992, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5072.18781208992, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 58.39729729729731, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1903.0, "episode_reward_min": 1903.0, "episode_reward_mean": 1903.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1903.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5379482821407136, "mean_raw_obs_processing_ms": 0.10158927565019048, "mean_inference_ms": 1.6324529021334806, "mean_action_processing_ms": 0.04640783156522954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 940000, "timers": {"sample_time_ms": 10500.043, "sample_throughput": 380.951, "learn_time_ms": 12476.208, "learn_throughput": 320.61, "update_time_ms": 4.112}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684184074401857, "cur_lr": 5e-05, "total_loss": 8.028383880853653, "policy_loss": -0.03305004155845381, "vf_loss": 8.04717256128788, "vf_explained_var": 0.4442952871322632, "kl": 0.010421803075587377, "entropy": 0.09520453645382077, "entropy_coeff": 0.0}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 94, "training_iteration": 235, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-22-15", "timestamp": 1618143735, "time_this_iter_s": 22.43212366104126, "time_total_s": 5094.619935750961, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2310710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d09d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5094.619935750961, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 59.253125, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1903.0, "episode_reward_min": 1903.0, "episode_reward_mean": 1903.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1903.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5379482821407136, "mean_raw_obs_processing_ms": 0.10158927565019048, "mean_inference_ms": 1.6324529021334806, "mean_action_processing_ms": 0.04640783156522954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 944000, "timers": {"sample_time_ms": 10561.799, "sample_throughput": 378.723, "learn_time_ms": 12486.073, "learn_throughput": 320.357, "update_time_ms": 4.057}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684184074401857, "cur_lr": 5e-05, "total_loss": 14.676804929971695, "policy_loss": -0.03004828648408875, "vf_loss": 14.691466063261032, "vf_explained_var": 0.6456767320632935, "kl": 0.01124467320914846, "entropy": 0.1016986221075058, "entropy_coeff": 0.0}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 94, "training_iteration": 236, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-22-37", "timestamp": 1618143757, "time_this_iter_s": 21.88883662223816, "time_total_s": 5116.5087723731995, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c23107d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5116.5087723731995, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 58.55, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1903.0, "episode_reward_min": 1903.0, "episode_reward_mean": 1903.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1903.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5379482821407136, "mean_raw_obs_processing_ms": 0.10158927565019048, "mean_inference_ms": 1.6324529021334806, "mean_action_processing_ms": 0.04640783156522954}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 948000, "timers": {"sample_time_ms": 10444.777, "sample_throughput": 382.967, "learn_time_ms": 12484.386, "learn_throughput": 320.4, "update_time_ms": 3.587}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684184074401857, "cur_lr": 5e-05, "total_loss": 9.104562565684319, "policy_loss": -0.026718756067566574, "vf_loss": 9.122688129544258, "vf_explained_var": 0.3640141487121582, "kl": 0.006279582912611659, "entropy": 0.08437363797565922, "entropy_coeff": 0.0}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 94, "training_iteration": 237, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-23-00", "timestamp": 1618143780, "time_this_iter_s": 22.932253122329712, "time_total_s": 5139.441025495529, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2310b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e5d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5139.441025495529, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 58.5625, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1873.0, "episode_reward_min": 1873.0, "episode_reward_mean": 1873.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1873.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5377502340008338, "mean_raw_obs_processing_ms": 0.10194040282207394, "mean_inference_ms": 1.6329740949063296, "mean_action_processing_ms": 0.04642006136292944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 952000, "timers": {"sample_time_ms": 10332.73, "sample_throughput": 387.119, "learn_time_ms": 12462.663, "learn_throughput": 320.959, "update_time_ms": 3.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3684184074401857, "cur_lr": 5e-05, "total_loss": 8.685741037130356, "policy_loss": -0.014326678938232362, "vf_loss": 8.695231229066849, "vf_explained_var": 0.40047141909599304, "kl": 0.0035343639756320044, "entropy": 0.08700579591095448, "entropy_coeff": 0.0}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 95, "training_iteration": 238, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-23-21", "timestamp": 1618143801, "time_this_iter_s": 21.08344578742981, "time_total_s": 5160.524471282959, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5160.524471282959, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 58.63333333333334, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1873.0, "episode_reward_min": 1873.0, "episode_reward_mean": 1873.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1873.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5377502340008338, "mean_raw_obs_processing_ms": 0.10194040282207394, "mean_inference_ms": 1.6329740949063296, "mean_action_processing_ms": 0.04642006136292944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 956000, "timers": {"sample_time_ms": 10158.739, "sample_throughput": 393.75, "learn_time_ms": 12434.885, "learn_throughput": 321.676, "update_time_ms": 3.432}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 15.44094803929329, "policy_loss": -0.03348108197678812, "vf_loss": 15.462380021810532, "vf_explained_var": 0.5788062214851379, "kl": 0.017610320704989135, "entropy": 0.1573300533927977, "entropy_coeff": 0.0}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 95, "training_iteration": 239, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-23-42", "timestamp": 1618143822, "time_this_iter_s": 20.212615251541138, "time_total_s": 5180.7370865345, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3dbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5180.7370865345, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 58.289655172413795, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1521.0, "episode_reward_min": 1521.0, "episode_reward_mean": 1521.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1521.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5349845156352486, "mean_raw_obs_processing_ms": 0.10213620727501743, "mean_inference_ms": 1.6327521790417545, "mean_action_processing_ms": 0.04641589654426264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 960000, "timers": {"sample_time_ms": 10114.705, "sample_throughput": 395.464, "learn_time_ms": 12394.831, "learn_throughput": 322.715, "update_time_ms": 3.406}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 14.741374254226685, "policy_loss": -0.030895514122676104, "vf_loss": 14.766775399446487, "vf_explained_var": 0.626221776008606, "kl": 0.008030329554458149, "entropy": 0.14395295665599406, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 96, "training_iteration": 240, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-24-02", "timestamp": 1618143842, "time_this_iter_s": 20.180747509002686, "time_total_s": 5200.917834043503, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5200.917834043503, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 58.46896551724139, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1521.0, "episode_reward_min": 1521.0, "episode_reward_mean": 1521.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1521.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5349845156352486, "mean_raw_obs_processing_ms": 0.10213620727501743, "mean_inference_ms": 1.6327521790417545, "mean_action_processing_ms": 0.04641589654426264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 964000, "timers": {"sample_time_ms": 10087.769, "sample_throughput": 396.52, "learn_time_ms": 12394.618, "learn_throughput": 322.721, "update_time_ms": 3.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 10.713843449950218, "policy_loss": -0.03548599511850625, "vf_loss": 10.743735402822495, "vf_explained_var": 0.8062893152236938, "kl": 0.008175787057552952, "entropy": 0.21161681693047285, "entropy_coeff": 0.0}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 96, "training_iteration": 241, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-24-22", "timestamp": 1618143862, "time_this_iter_s": 20.38002610206604, "time_total_s": 5221.297860145569, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ec410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5221.297860145569, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 59.26206896551724, "ram_util_percent": 27.51379310344828}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1521.0, "episode_reward_min": 1521.0, "episode_reward_mean": 1521.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1521.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5349845156352486, "mean_raw_obs_processing_ms": 0.10213620727501743, "mean_inference_ms": 1.6327521790417545, "mean_action_processing_ms": 0.04641589654426264}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 968000, "timers": {"sample_time_ms": 9739.041, "sample_throughput": 410.718, "learn_time_ms": 12387.783, "learn_throughput": 322.899, "update_time_ms": 3.121}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 16.63760507106781, "policy_loss": -0.029366179485805333, "vf_loss": 16.66211861371994, "vf_explained_var": 0.42251500487327576, "kl": 0.00709246272163, "entropy": 0.1136146446224302, "entropy_coeff": 0.0}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 96, "training_iteration": 242, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-24-43", "timestamp": 1618143883, "time_this_iter_s": 20.426958084106445, "time_total_s": 5241.724818229675, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5241.724818229675, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 58.941379310344836, "ram_util_percent": 27.50689655172414}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1220.0, "episode_reward_min": 1220.0, "episode_reward_mean": 1220.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.530776342924402, "mean_raw_obs_processing_ms": 0.10243790589837909, "mean_inference_ms": 1.6327375913849067, "mean_action_processing_ms": 0.04641479899417788}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 972000, "timers": {"sample_time_ms": 9221.761, "sample_throughput": 433.757, "learn_time_ms": 12360.064, "learn_throughput": 323.623, "update_time_ms": 3.122}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 13.036402583122253, "policy_loss": -0.0330296132597141, "vf_loss": 13.064338117837906, "vf_explained_var": 0.6030922532081604, "kl": 0.0074451874097576365, "entropy": 0.15470000845380127, "entropy_coeff": 0.0}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 97, "training_iteration": 243, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-25-03", "timestamp": 1618143903, "time_this_iter_s": 20.25032353401184, "time_total_s": 5261.975141763687, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e59d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5261.975141763687, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 58.679310344827584, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1220.0, "episode_reward_min": 1220.0, "episode_reward_mean": 1220.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.530776342924402, "mean_raw_obs_processing_ms": 0.10243790589837909, "mean_inference_ms": 1.6327375913849067, "mean_action_processing_ms": 0.04641479899417788}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 976000, "timers": {"sample_time_ms": 8670.607, "sample_throughput": 461.329, "learn_time_ms": 12313.714, "learn_throughput": 324.841, "update_time_ms": 3.006}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 12.51230302453041, "policy_loss": -0.03354044794104993, "vf_loss": 12.533832728862762, "vf_explained_var": 0.4278930425643921, "kl": 0.017553894344018772, "entropy": 0.12595374369993806, "entropy_coeff": 0.0}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 97, "training_iteration": 244, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-25-23", "timestamp": 1618143923, "time_this_iter_s": 20.158656120300293, "time_total_s": 5282.133797883987, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fcc50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33a9710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5282.133797883987, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 57.85517241379312, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.529140674732936, "mean_raw_obs_processing_ms": 0.10263512852655865, "mean_inference_ms": 1.6324568957648744, "mean_action_processing_ms": 0.046407176366678196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 980000, "timers": {"sample_time_ms": 8585.669, "sample_throughput": 465.893, "learn_time_ms": 12263.101, "learn_throughput": 326.182, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 8.516027137637138, "policy_loss": -0.02154669293668121, "vf_loss": 8.532862052321434, "vf_explained_var": 0.3707066774368286, "kl": 0.006886408569698688, "entropy": 0.08223204710520804, "entropy_coeff": 0.0}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 98, "training_iteration": 245, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-25-44", "timestamp": 1618143944, "time_this_iter_s": 21.07402205467224, "time_total_s": 5303.20781993866, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5303.20781993866, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 58.54666666666666, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.529140674732936, "mean_raw_obs_processing_ms": 0.10263512852655865, "mean_inference_ms": 1.6324568957648744, "mean_action_processing_ms": 0.046407176366678196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 984000, "timers": {"sample_time_ms": 8478.817, "sample_throughput": 471.764, "learn_time_ms": 12230.366, "learn_throughput": 327.055, "update_time_ms": 3.054}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 11.337783813476562, "policy_loss": -0.03525349227129482, "vf_loss": 11.365456968545914, "vf_explained_var": 0.6176557540893555, "kl": 0.011078759605879895, "entropy": 0.16869284212589264, "entropy_coeff": 0.0}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 98, "training_iteration": 246, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-26-05", "timestamp": 1618143965, "time_this_iter_s": 20.49144959449768, "time_total_s": 5323.699269533157, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f25d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5323.699269533157, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 59.13666666666666, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1744.0, "episode_reward_min": 1744.0, "episode_reward_mean": 1744.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.529140674732936, "mean_raw_obs_processing_ms": 0.10263512852655865, "mean_inference_ms": 1.6324568957648744, "mean_action_processing_ms": 0.046407176366678196}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 988000, "timers": {"sample_time_ms": 8244.149, "sample_throughput": 485.193, "learn_time_ms": 12200.833, "learn_throughput": 327.846, "update_time_ms": 3.096}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6842092037200929, "cur_lr": 5e-05, "total_loss": 15.247321158647537, "policy_loss": -0.10410104552283883, "vf_loss": 15.287073969841003, "vf_explained_var": 0.5316871404647827, "kl": 0.09404758992604911, "entropy": 0.28371714148670435, "entropy_coeff": 0.0}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 98, "training_iteration": 247, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-26-25", "timestamp": 1618143985, "time_this_iter_s": 20.290469646453857, "time_total_s": 5343.989739179611, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4b90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5343.989739179611, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 59.0448275862069, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 911.0, "episode_reward_min": 911.0, "episode_reward_mean": 911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5250259260212362, "mean_raw_obs_processing_ms": 0.10296514321067833, "mean_inference_ms": 1.6325474933269328, "mean_action_processing_ms": 0.04640792054300184}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 992000, "timers": {"sample_time_ms": 8144.719, "sample_throughput": 491.116, "learn_time_ms": 12242.324, "learn_throughput": 326.735, "update_time_ms": 3.124}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5e-05, "total_loss": 12.655297875404358, "policy_loss": -0.026709967525675893, "vf_loss": 12.674719423055649, "vf_explained_var": 0.5620274543762207, "kl": 0.0071015969006111845, "entropy": 0.19804851431399584, "entropy_coeff": 0.0}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 99, "training_iteration": 248, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-26-46", "timestamp": 1618144006, "time_this_iter_s": 20.502302169799805, "time_total_s": 5364.492041349411, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68cea90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6c74490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5364.492041349411, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 59.54827586206896, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 911.0, "episode_reward_min": 911.0, "episode_reward_mean": 911.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [911.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5250259260212362, "mean_raw_obs_processing_ms": 0.10296514321067833, "mean_inference_ms": 1.6325474933269328, "mean_action_processing_ms": 0.04640792054300184}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 996000, "timers": {"sample_time_ms": 8194.399, "sample_throughput": 488.138, "learn_time_ms": 12251.28, "learn_throughput": 326.496, "update_time_ms": 3.135}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5e-05, "total_loss": 12.387461483478546, "policy_loss": -0.02007709926692769, "vf_loss": 12.403557896614075, "vf_explained_var": 0.5091499090194702, "kl": 0.0038783598829468247, "entropy": 0.08889741299208254, "entropy_coeff": 0.0}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 99, "training_iteration": 249, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-27-06", "timestamp": 1618144026, "time_this_iter_s": 20.79945182800293, "time_total_s": 5385.291493177414, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5385.291493177414, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 58.026666666666664, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.522914153752106, "mean_raw_obs_processing_ms": 0.10317303091548531, "mean_inference_ms": 1.6326039861113002, "mean_action_processing_ms": 0.0464112757055761}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1000000, "timers": {"sample_time_ms": 8219.552, "sample_throughput": 486.645, "learn_time_ms": 12247.445, "learn_throughput": 326.599, "update_time_ms": 3.228}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5e-05, "total_loss": 13.266011118888855, "policy_loss": -0.0712925408151932, "vf_loss": 13.300490528345108, "vf_explained_var": 0.7199581861495972, "kl": 0.07173837919253856, "entropy": 0.1733413350302726, "entropy_coeff": 0.0}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 100, "training_iteration": 250, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-27-27", "timestamp": 1618144047, "time_this_iter_s": 20.394866704940796, "time_total_s": 5405.686359882355, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5405.686359882355, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 59.33103448275862, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.522914153752106, "mean_raw_obs_processing_ms": 0.10317303091548531, "mean_inference_ms": 1.6326039861113002, "mean_action_processing_ms": 0.0464112757055761}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1004000, "timers": {"sample_time_ms": 8223.931, "sample_throughput": 486.385, "learn_time_ms": 12224.986, "learn_throughput": 327.199, "update_time_ms": 3.253}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 154.18395519256592, "policy_loss": -0.02313193288864568, "vf_loss": 154.20272493362427, "vf_explained_var": -0.25277531147003174, "kl": 0.005668811980285682, "entropy": 0.10055396822281182, "entropy_coeff": 0.0}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 100, "training_iteration": 251, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-27-47", "timestamp": 1618144067, "time_this_iter_s": 20.200590133666992, "time_total_s": 5425.886950016022, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b82c4710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5425.886950016022, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 58.94137931034483, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1262.0, "episode_reward_min": 1262.0, "episode_reward_mean": 1262.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1262.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.522914153752106, "mean_raw_obs_processing_ms": 0.10317303091548531, "mean_inference_ms": 1.6326039861113002, "mean_action_processing_ms": 0.0464112757055761}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1008000, "timers": {"sample_time_ms": 8196.401, "sample_throughput": 488.019, "learn_time_ms": 12241.672, "learn_throughput": 326.753, "update_time_ms": 3.26}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 30.545722544193268, "policy_loss": -0.028380731091601774, "vf_loss": 30.569840908050537, "vf_explained_var": 0.01574409008026123, "kl": 0.005537184391869232, "entropy": 0.12756587681360543, "entropy_coeff": 0.0}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 100, "training_iteration": 252, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-28-07", "timestamp": 1618144087, "time_this_iter_s": 20.32073998451233, "time_total_s": 5446.207690000534, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a0d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33566d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5446.207690000534, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 59.19310344827586, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -1148.0, "episode_reward_min": -1148.0, "episode_reward_mean": -1148.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1148.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5189485065485185, "mean_raw_obs_processing_ms": 0.10346652679997771, "mean_inference_ms": 1.6323753737464348, "mean_action_processing_ms": 0.04641558443579479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1012000, "timers": {"sample_time_ms": 8192.884, "sample_throughput": 488.229, "learn_time_ms": 12237.372, "learn_throughput": 326.868, "update_time_ms": 3.237}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 5.297973267734051, "policy_loss": -0.017850028671091422, "vf_loss": 5.311662793159485, "vf_explained_var": 0.6130196452140808, "kl": 0.0054050491453381255, "entropy": 0.16550960903987288, "entropy_coeff": 0.0}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 101, "training_iteration": 253, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-28-28", "timestamp": 1618144108, "time_this_iter_s": 20.16929864883423, "time_total_s": 5466.376988649368, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fc10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5466.376988649368, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 58.01428571428571, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -1148.0, "episode_reward_min": -1148.0, "episode_reward_mean": -1148.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1148.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5189485065485185, "mean_raw_obs_processing_ms": 0.10346652679997771, "mean_inference_ms": 1.6323753737464348, "mean_action_processing_ms": 0.04641558443579479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1016000, "timers": {"sample_time_ms": 8212.858, "sample_throughput": 487.041, "learn_time_ms": 12240.337, "learn_throughput": 326.788, "update_time_ms": 3.234}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 13.620854288339615, "policy_loss": -0.033728059992427006, "vf_loss": 13.648856461048126, "vf_explained_var": 0.4649759531021118, "kl": 0.007438765722326934, "entropy": 0.15148575534112751, "entropy_coeff": 0.0}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 101, "training_iteration": 254, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-28-48", "timestamp": 1618144128, "time_this_iter_s": 20.389383554458618, "time_total_s": 5486.766372203827, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5486.766372203827, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 59.09310344827586, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -696.0, "episode_reward_min": -696.0, "episode_reward_mean": -696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5163576982158868, "mean_raw_obs_processing_ms": 0.10368436928268394, "mean_inference_ms": 1.6325225410985422, "mean_action_processing_ms": 0.04641979378842214}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1020000, "timers": {"sample_time_ms": 8126.695, "sample_throughput": 492.205, "learn_time_ms": 12246.165, "learn_throughput": 326.633, "update_time_ms": 3.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 7.637668013572693, "policy_loss": -0.02612886601127684, "vf_loss": 7.659394606947899, "vf_explained_var": 0.6716434955596924, "kl": 0.00571906764889718, "entropy": 0.10947639658115804, "entropy_coeff": 0.0}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 102, "training_iteration": 255, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-29-08", "timestamp": 1618144148, "time_this_iter_s": 20.27049994468689, "time_total_s": 5507.036872148514, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68cecd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356f50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5507.036872148514, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 59.07586206896551, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -696.0, "episode_reward_min": -696.0, "episode_reward_mean": -696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5163576982158868, "mean_raw_obs_processing_ms": 0.10368436928268394, "mean_inference_ms": 1.6325225410985422, "mean_action_processing_ms": 0.04641979378842214}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1024000, "timers": {"sample_time_ms": 8085.147, "sample_throughput": 494.734, "learn_time_ms": 12248.512, "learn_throughput": 326.57, "update_time_ms": 3.235}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 1.4641720801591873, "policy_loss": -0.03005879808915779, "vf_loss": 1.49010612629354, "vf_explained_var": 0.305877685546875, "kl": 0.005358662085200194, "entropy": 0.10152622242458165, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 102, "training_iteration": 256, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-29-28", "timestamp": 1618144168, "time_this_iter_s": 20.10086464881897, "time_total_s": 5527.137736797333, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5527.137736797333, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 58.80344827586207, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -696.0, "episode_reward_min": -696.0, "episode_reward_mean": -696.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5163576982158868, "mean_raw_obs_processing_ms": 0.10368436928268394, "mean_inference_ms": 1.6325225410985422, "mean_action_processing_ms": 0.04641979378842214}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1028000, "timers": {"sample_time_ms": 8056.755, "sample_throughput": 496.478, "learn_time_ms": 12243.559, "learn_throughput": 326.702, "update_time_ms": 3.192}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 8.105081230401993, "policy_loss": -0.02289380325237289, "vf_loss": 8.123330131173134, "vf_explained_var": 0.5225573778152466, "kl": 0.006034406535036396, "entropy": 0.13655533059500158, "entropy_coeff": 0.0}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 102, "training_iteration": 257, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-29-48", "timestamp": 1618144188, "time_this_iter_s": 19.95484685897827, "time_total_s": 5547.092583656311, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5547.092583656311, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 57.703448275862065, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -404.0, "episode_reward_min": -404.0, "episode_reward_mean": -404.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-404.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5125631380807475, "mean_raw_obs_processing_ms": 0.10397658789125096, "mean_inference_ms": 1.6322042195924753, "mean_action_processing_ms": 0.04641102920623587}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1032000, "timers": {"sample_time_ms": 8083.125, "sample_throughput": 494.858, "learn_time_ms": 12199.352, "learn_throughput": 327.886, "update_time_ms": 3.225}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 12.054651364684105, "policy_loss": -0.007274794508703053, "vf_loss": 12.05788403749466, "vf_explained_var": 0.6932611465454102, "kl": 0.005251144091744209, "entropy": 0.10532318754121661, "entropy_coeff": 0.0}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 103, "training_iteration": 258, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-30-09", "timestamp": 1618144209, "time_this_iter_s": 20.325152158737183, "time_total_s": 5567.417735815048, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ec90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fcf90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5567.417735815048, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 58.82413793103448, "ram_util_percent": 27.5}, "trial_id": "9be58_00000"}
{"episode_reward_max": -404.0, "episode_reward_min": -404.0, "episode_reward_mean": -404.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-404.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5125631380807475, "mean_raw_obs_processing_ms": 0.10397658789125096, "mean_inference_ms": 1.6322042195924753, "mean_action_processing_ms": 0.04641102920623587}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1036000, "timers": {"sample_time_ms": 8048.494, "sample_throughput": 496.987, "learn_time_ms": 12188.016, "learn_throughput": 328.191, "update_time_ms": 3.252}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 15.959129810333252, "policy_loss": -0.021673905255738646, "vf_loss": 15.975704967975616, "vf_explained_var": 0.4721461832523346, "kl": 0.0066243925102753565, "entropy": 0.12541606300510466, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 103, "training_iteration": 259, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-30-29", "timestamp": 1618144229, "time_this_iter_s": 20.339184999465942, "time_total_s": 5587.756920814514, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5587.756920814514, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 59.127586206896545, "ram_util_percent": 27.58275862068966}, "trial_id": "9be58_00000"}
{"episode_reward_max": -1265.0, "episode_reward_min": -1265.0, "episode_reward_mean": -1265.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1265.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5100858875294653, "mean_raw_obs_processing_ms": 0.10417275774198896, "mean_inference_ms": 1.6320308726031925, "mean_action_processing_ms": 0.04640527949015696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1040000, "timers": {"sample_time_ms": 8002.249, "sample_throughput": 499.859, "learn_time_ms": 12193.064, "learn_throughput": 328.055, "update_time_ms": 3.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 14.814463138580322, "policy_loss": -0.022146375966258347, "vf_loss": 14.831397652626038, "vf_explained_var": 0.6626380681991577, "kl": 0.006770584121113643, "entropy": 0.13125262688845396, "entropy_coeff": 0.0}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 104, "training_iteration": 260, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-30-49", "timestamp": 1618144249, "time_this_iter_s": 19.98253035545349, "time_total_s": 5607.739451169968, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5607.739451169968, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 58.11428571428571, "ram_util_percent": 27.59642857142858}, "trial_id": "9be58_00000"}
{"episode_reward_max": -1265.0, "episode_reward_min": -1265.0, "episode_reward_mean": -1265.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1265.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5100858875294653, "mean_raw_obs_processing_ms": 0.10417275774198896, "mean_inference_ms": 1.6320308726031925, "mean_action_processing_ms": 0.04640527949015696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1044000, "timers": {"sample_time_ms": 7983.882, "sample_throughput": 501.009, "learn_time_ms": 12194.042, "learn_throughput": 328.029, "update_time_ms": 3.254}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 16.73335263133049, "policy_loss": -0.03342933324165642, "vf_loss": 16.75806227326393, "vf_explained_var": 0.7125235795974731, "kl": 0.011328168053296395, "entropy": 0.162266134750098, "entropy_coeff": 0.0}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 104, "training_iteration": 261, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-31-09", "timestamp": 1618144269, "time_this_iter_s": 20.02568745613098, "time_total_s": 5627.765138626099, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5627.765138626099, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 58.713793103448275, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -1265.0, "episode_reward_min": -1265.0, "episode_reward_mean": -1265.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1265.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5100858875294653, "mean_raw_obs_processing_ms": 0.10417275774198896, "mean_inference_ms": 1.6320308726031925, "mean_action_processing_ms": 0.04640527949015696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1048000, "timers": {"sample_time_ms": 8038.755, "sample_throughput": 497.59, "learn_time_ms": 12171.0, "learn_throughput": 328.65, "update_time_ms": 3.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 15.939922511577606, "policy_loss": -0.033083506335970014, "vf_loss": 15.967663764953613, "vf_explained_var": 0.6419956684112549, "kl": 0.006940489249245729, "entropy": 0.15910928370431066, "entropy_coeff": 0.0}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 104, "training_iteration": 262, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-31-30", "timestamp": 1618144290, "time_this_iter_s": 20.63728642463684, "time_total_s": 5648.4024250507355, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5648.4024250507355, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 59.099999999999994, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -908.0, "episode_reward_min": -908.0, "episode_reward_mean": -908.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5069038582145307, "mean_raw_obs_processing_ms": 0.10446565546447412, "mean_inference_ms": 1.6318747803333327, "mean_action_processing_ms": 0.04639591382062777}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1052000, "timers": {"sample_time_ms": 8060.516, "sample_throughput": 496.246, "learn_time_ms": 12158.786, "learn_throughput": 328.98, "update_time_ms": 3.205}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 6.801358312368393, "policy_loss": -0.03144314087694511, "vf_loss": 6.825982451438904, "vf_explained_var": 0.5363789796829224, "kl": 0.00885896646650508, "entropy": 0.2197979874908924, "entropy_coeff": 0.0}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 105, "training_iteration": 263, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-31-50", "timestamp": 1618144310, "time_this_iter_s": 20.265716075897217, "time_total_s": 5668.668141126633, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5668.668141126633, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 59.26896551724137, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -908.0, "episode_reward_min": -908.0, "episode_reward_mean": -908.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5069038582145307, "mean_raw_obs_processing_ms": 0.10446565546447412, "mean_inference_ms": 1.6318747803333327, "mean_action_processing_ms": 0.04639591382062777}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1056000, "timers": {"sample_time_ms": 8019.155, "sample_throughput": 498.806, "learn_time_ms": 12177.647, "learn_throughput": 328.471, "update_time_ms": 3.2}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 5.046282045543194, "policy_loss": -0.031521175580564886, "vf_loss": 5.072787515819073, "vf_explained_var": 0.5279261469841003, "kl": 0.0065160777303390205, "entropy": 0.22558573679998517, "entropy_coeff": 0.0}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 105, "training_iteration": 264, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-32-10", "timestamp": 1618144330, "time_this_iter_s": 20.16278576850891, "time_total_s": 5688.830926895142, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5688.830926895142, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 58.217241379310344, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -254.0, "episode_reward_min": -254.0, "episode_reward_mean": -254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5043791299677339, "mean_raw_obs_processing_ms": 0.10465209417912258, "mean_inference_ms": 1.6315652475535545, "mean_action_processing_ms": 0.0463849239636205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1060000, "timers": {"sample_time_ms": 7996.134, "sample_throughput": 500.242, "learn_time_ms": 12180.529, "learn_throughput": 328.393, "update_time_ms": 3.167}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 0.6197865568101406, "policy_loss": -0.030673989444039762, "vf_loss": 0.6432058997452259, "vf_explained_var": -0.0036044251173734665, "kl": 0.009424860545550473, "entropy": 0.2375519797205925, "entropy_coeff": 0.0}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 106, "training_iteration": 265, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-32-30", "timestamp": 1618144350, "time_this_iter_s": 20.06908655166626, "time_total_s": 5708.900013446808, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5708.900013446808, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 58.52758620689655, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -254.0, "episode_reward_min": -254.0, "episode_reward_mean": -254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5043791299677339, "mean_raw_obs_processing_ms": 0.10465209417912258, "mean_inference_ms": 1.6315652475535545, "mean_action_processing_ms": 0.0463849239636205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1064000, "timers": {"sample_time_ms": 8004.667, "sample_throughput": 499.708, "learn_time_ms": 12180.786, "learn_throughput": 328.386, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 7.818422719836235, "policy_loss": -0.024818720819894224, "vf_loss": 7.837293788790703, "vf_explained_var": 0.6025792956352234, "kl": 0.007726840136456303, "entropy": 0.17713935859501362, "entropy_coeff": 0.0}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 106, "training_iteration": 266, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-32-51", "timestamp": 1618144371, "time_this_iter_s": 20.19092035293579, "time_total_s": 5729.090933799744, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d23d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5729.090933799744, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 58.59310344827586, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -254.0, "episode_reward_min": -254.0, "episode_reward_mean": -254.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5043791299677339, "mean_raw_obs_processing_ms": 0.10465209417912258, "mean_inference_ms": 1.6315652475535545, "mean_action_processing_ms": 0.0463849239636205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1068000, "timers": {"sample_time_ms": 8030.917, "sample_throughput": 498.075, "learn_time_ms": 12199.277, "learn_throughput": 327.888, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 9.550696775317192, "policy_loss": -0.02808658784488216, "vf_loss": 9.572827726602554, "vf_explained_var": 0.7182955741882324, "kl": 0.0077371546503854915, "entropy": 0.17857986968010664, "entropy_coeff": 0.0}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 106, "training_iteration": 267, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-33-11", "timestamp": 1618144391, "time_this_iter_s": 20.401560068130493, "time_total_s": 5749.492493867874, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5749.492493867874, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 59.43103448275861, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -589.0, "episode_reward_min": -589.0, "episode_reward_mean": -589.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5009841965027666, "mean_raw_obs_processing_ms": 0.10494094661050943, "mean_inference_ms": 1.631254864055096, "mean_action_processing_ms": 0.04637170405151599}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1072000, "timers": {"sample_time_ms": 8009.169, "sample_throughput": 499.428, "learn_time_ms": 12214.479, "learn_throughput": 327.48, "update_time_ms": 3.228}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5e-05, "total_loss": 20.132764637470245, "policy_loss": -0.011004955391399562, "vf_loss": 20.14200946688652, "vf_explained_var": 0.028602657839655876, "kl": 0.0022864794497934327, "entropy": 0.012934119626152096, "entropy_coeff": 0.0}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 107, "training_iteration": 268, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-33-31", "timestamp": 1618144411, "time_this_iter_s": 20.26077151298523, "time_total_s": 5769.753265380859, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5769.753265380859, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 58.24827586206896, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -589.0, "episode_reward_min": -589.0, "episode_reward_mean": -589.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.5009841965027666, "mean_raw_obs_processing_ms": 0.10494094661050943, "mean_inference_ms": 1.631254864055096, "mean_action_processing_ms": 0.04637170405151599}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1076000, "timers": {"sample_time_ms": 7994.506, "sample_throughput": 500.344, "learn_time_ms": 12204.652, "learn_throughput": 327.744, "update_time_ms": 3.207}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3848676770925522, "cur_lr": 5e-05, "total_loss": 4.566920146346092, "policy_loss": -0.004577439336571842, "vf_loss": 4.571497566998005, "vf_explained_var": -0.001149892807006836, "kl": 2.012992101896316e-07, "entropy": 0.0002588368097349303, "entropy_coeff": 0.0}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 107, "training_iteration": 269, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-33-52", "timestamp": 1618144432, "time_this_iter_s": 20.09118342399597, "time_total_s": 5789.844448804855, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5789.844448804855, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 58.65000000000001, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -102.0, "episode_reward_min": -102.0, "episode_reward_mean": -102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49882524692907854, "mean_raw_obs_processing_ms": 0.1051231671442543, "mean_inference_ms": 1.631064359086583, "mean_action_processing_ms": 0.04636882091342718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1080000, "timers": {"sample_time_ms": 8021.115, "sample_throughput": 498.684, "learn_time_ms": 12189.665, "learn_throughput": 328.147, "update_time_ms": 3.133}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": 5.024683117866516, "policy_loss": -0.01032292892341502, "vf_loss": 5.033647388219833, "vf_explained_var": 0.7469761371612549, "kl": 0.007060214520606678, "entropy": 0.03490299702389166, "entropy_coeff": 0.0}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 108, "training_iteration": 270, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-34-12", "timestamp": 1618144452, "time_this_iter_s": 20.100927352905273, "time_total_s": 5809.945376157761, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5809.945376157761, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 58.789655172413795, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -102.0, "episode_reward_min": -102.0, "episode_reward_mean": -102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49882524692907854, "mean_raw_obs_processing_ms": 0.1051231671442543, "mean_inference_ms": 1.631064359086583, "mean_action_processing_ms": 0.04636882091342718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1084000, "timers": {"sample_time_ms": 8027.774, "sample_throughput": 498.27, "learn_time_ms": 12206.295, "learn_throughput": 327.7, "update_time_ms": 3.083}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": 11.056243896484375, "policy_loss": -0.04415264155250043, "vf_loss": 11.096866458654404, "vf_explained_var": 0.5125865340232849, "kl": 0.018343903444474563, "entropy": 0.22577730752527714, "entropy_coeff": 0.0}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 108, "training_iteration": 271, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-34-32", "timestamp": 1618144472, "time_this_iter_s": 20.25969696044922, "time_total_s": 5830.20507311821, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5830.20507311821, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 58.972413793103456, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -102.0, "episode_reward_min": -102.0, "episode_reward_mean": -102.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49882524692907854, "mean_raw_obs_processing_ms": 0.1051231671442543, "mean_inference_ms": 1.631064359086583, "mean_action_processing_ms": 0.04636882091342718}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1088000, "timers": {"sample_time_ms": 7968.869, "sample_throughput": 501.953, "learn_time_ms": 12201.019, "learn_throughput": 327.841, "update_time_ms": 3.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": 11.508292585611343, "policy_loss": -0.029769744927762076, "vf_loss": 11.534421622753143, "vf_explained_var": 0.5045895576477051, "kl": 0.018919141381047666, "entropy": 0.19445416191592813, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 108, "training_iteration": 272, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-34-52", "timestamp": 1618144492, "time_this_iter_s": 19.995803356170654, "time_total_s": 5850.2008764743805, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33a0650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33b2190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5850.2008764743805, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 58.13793103448276, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -666.0, "episode_reward_min": -666.0, "episode_reward_mean": -666.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-666.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49553279509579645, "mean_raw_obs_processing_ms": 0.10543636170233701, "mean_inference_ms": 1.6307723164220325, "mean_action_processing_ms": 0.046367553241171235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1092000, "timers": {"sample_time_ms": 7971.335, "sample_throughput": 501.798, "learn_time_ms": 12193.105, "learn_throughput": 328.054, "update_time_ms": 3.128}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1924338385462761, "cur_lr": 5e-05, "total_loss": 3.0140657275915146, "policy_loss": 0.0036804242408834398, "vf_loss": 3.0103850811719894, "vf_explained_var": -0.0006125904619693756, "kl": 1.0600886444223079e-06, "entropy": 0.0029795915179420263, "entropy_coeff": 0.0}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 109, "training_iteration": 273, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-35-12", "timestamp": 1618144512, "time_this_iter_s": 20.211688995361328, "time_total_s": 5870.412565469742, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ec90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5870.412565469742, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 58.949999999999996, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -666.0, "episode_reward_min": -666.0, "episode_reward_mean": -666.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-666.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49553279509579645, "mean_raw_obs_processing_ms": 0.10543636170233701, "mean_inference_ms": 1.6307723164220325, "mean_action_processing_ms": 0.046367553241171235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1096000, "timers": {"sample_time_ms": 7995.546, "sample_throughput": 500.279, "learn_time_ms": 12163.067, "learn_throughput": 328.864, "update_time_ms": 3.162}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09621691927313805, "cur_lr": 5e-05, "total_loss": 0.5458624586462975, "policy_loss": -0.0020469329319894314, "vf_loss": 0.5479066083207726, "vf_explained_var": -0.0006377119570970535, "kl": 2.870986543257459e-05, "entropy": 0.00415151656488888, "entropy_coeff": 0.0}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 109, "training_iteration": 274, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-35-32", "timestamp": 1618144532, "time_this_iter_s": 20.10341501235962, "time_total_s": 5890.515980482101, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f990>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5890.515980482101, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 58.85862068965517, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -98.0, "episode_reward_min": -98.0, "episode_reward_mean": -98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49339226669893316, "mean_raw_obs_processing_ms": 0.10564016925486988, "mean_inference_ms": 1.6305480837790858, "mean_action_processing_ms": 0.04636082357679979}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1100000, "timers": {"sample_time_ms": 8005.952, "sample_throughput": 499.628, "learn_time_ms": 12173.314, "learn_throughput": 328.588, "update_time_ms": 3.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.048108459636569026, "cur_lr": 5e-05, "total_loss": 3.7077173441648483, "policy_loss": -0.03827484374050982, "vf_loss": 3.744802340865135, "vf_explained_var": 0.6846615076065063, "kl": 0.024732921359827742, "entropy": 0.13230072474107146, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 110, "training_iteration": 275, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-35-53", "timestamp": 1618144553, "time_this_iter_s": 20.275480270385742, "time_total_s": 5910.791460752487, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222d310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4edd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5910.791460752487, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 58.09310344827587, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -98.0, "episode_reward_min": -98.0, "episode_reward_mean": -98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49339226669893316, "mean_raw_obs_processing_ms": 0.10564016925486988, "mean_inference_ms": 1.6305480837790858, "mean_action_processing_ms": 0.04636082357679979}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1104000, "timers": {"sample_time_ms": 8015.536, "sample_throughput": 499.031, "learn_time_ms": 12166.294, "learn_throughput": 328.777, "update_time_ms": 3.177}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.07216268945485355, "cur_lr": 5e-05, "total_loss": 7.371078372001648, "policy_loss": -0.036631348833907396, "vf_loss": 7.40604442358017, "vf_explained_var": 0.6846648454666138, "kl": 0.02307665828266181, "entropy": 0.1986182676628232, "entropy_coeff": 0.0}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 110, "training_iteration": 276, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-36-13", "timestamp": 1618144573, "time_this_iter_s": 20.215362787246704, "time_total_s": 5931.006823539734, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5350>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5931.006823539734, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 59.26551724137931, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -98.0, "episode_reward_min": -98.0, "episode_reward_mean": -98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49339226669893316, "mean_raw_obs_processing_ms": 0.10564016925486988, "mean_inference_ms": 1.6305480837790858, "mean_action_processing_ms": 0.04636082357679979}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1108000, "timers": {"sample_time_ms": 8005.685, "sample_throughput": 499.645, "learn_time_ms": 12151.487, "learn_throughput": 329.178, "update_time_ms": 3.215}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10824403418228032, "cur_lr": 5e-05, "total_loss": 5.944081321358681, "policy_loss": -0.03810451622121036, "vf_loss": 5.978464409708977, "vf_explained_var": 0.4992283284664154, "kl": 0.034379574295599014, "entropy": 0.26717803720384836, "entropy_coeff": 0.0}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 110, "training_iteration": 277, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-36-33", "timestamp": 1618144593, "time_this_iter_s": 20.154423475265503, "time_total_s": 5951.161247014999, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f29d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6de7090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5951.161247014999, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 59.02413793103448, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -454.0, "episode_reward_min": -454.0, "episode_reward_mean": -454.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-454.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49015403761815673, "mean_raw_obs_processing_ms": 0.10593367216440738, "mean_inference_ms": 1.6302433908550913, "mean_action_processing_ms": 0.046351663626147656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1112000, "timers": {"sample_time_ms": 7997.69, "sample_throughput": 500.144, "learn_time_ms": 12174.504, "learn_throughput": 328.555, "update_time_ms": 3.132}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16236605127342046, "cur_lr": 5e-05, "total_loss": 5.151763439178467, "policy_loss": -0.0175666582363192, "vf_loss": 5.167982995510101, "vf_explained_var": 0.4738253951072693, "kl": 0.008296626965602627, "entropy": 0.044900895503815264, "entropy_coeff": 0.0}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 111, "training_iteration": 278, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-36-53", "timestamp": 1618144613, "time_this_iter_s": 20.408178091049194, "time_total_s": 5971.569425106049, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6de70d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5971.569425106049, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 59.43448275862069, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -454.0, "episode_reward_min": -454.0, "episode_reward_mean": -454.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-454.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.49015403761815673, "mean_raw_obs_processing_ms": 0.10593367216440738, "mean_inference_ms": 1.6302433908550913, "mean_action_processing_ms": 0.046351663626147656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1116000, "timers": {"sample_time_ms": 7980.146, "sample_throughput": 501.244, "learn_time_ms": 12193.924, "learn_throughput": 328.032, "update_time_ms": 3.302}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16236605127342046, "cur_lr": 5e-05, "total_loss": 1.1651537381112576, "policy_loss": -0.003921598254237324, "vf_loss": 1.1690750923007727, "vf_explained_var": 0.00035229697823524475, "kl": 1.5832208433153028e-06, "entropy": 0.0033027014578692615, "entropy_coeff": 0.0}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 111, "training_iteration": 279, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-37-14", "timestamp": 1618144634, "time_this_iter_s": 20.115172624588013, "time_total_s": 5991.684597730637, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fccd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5991.684597730637, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 57.86896551724138, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4878515711431426, "mean_raw_obs_processing_ms": 0.10612812656725608, "mean_inference_ms": 1.6300943225385593, "mean_action_processing_ms": 0.04634333244859647}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1120000, "timers": {"sample_time_ms": 7969.688, "sample_throughput": 501.902, "learn_time_ms": 12213.534, "learn_throughput": 327.506, "update_time_ms": 3.315}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08118302563671023, "cur_lr": 5e-05, "total_loss": 0.21566655981587246, "policy_loss": 0.007948670885525644, "vf_loss": 0.20757962251082063, "vf_explained_var": -0.0009612608700990677, "kl": 0.0017031617535394616, "entropy": 0.019019819505047053, "entropy_coeff": 0.0}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 112, "training_iteration": 280, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-37-34", "timestamp": 1618144654, "time_this_iter_s": 20.190093517303467, "time_total_s": 6011.87469124794, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f75d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f0d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6011.87469124794, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 59.07241379310344, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4878515711431426, "mean_raw_obs_processing_ms": 0.10612812656725608, "mean_inference_ms": 1.6300943225385593, "mean_action_processing_ms": 0.04634333244859647}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1124000, "timers": {"sample_time_ms": 7976.357, "sample_throughput": 501.482, "learn_time_ms": 12201.719, "learn_throughput": 327.823, "update_time_ms": 3.367}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 5e-05, "total_loss": 3.6285299584269524, "policy_loss": -0.032296225952450186, "vf_loss": 3.6594908013939857, "vf_explained_var": 0.2252466380596161, "kl": 0.03289875737391412, "entropy": 0.1485205611679703, "entropy_coeff": 0.0}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 112, "training_iteration": 281, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-37-54", "timestamp": 1618144674, "time_this_iter_s": 20.20679783821106, "time_total_s": 6032.081489086151, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6032.081489086151, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 59.12068965517241, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -5.0, "episode_reward_min": -5.0, "episode_reward_mean": -5.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4878515711431426, "mean_raw_obs_processing_ms": 0.10612812656725608, "mean_inference_ms": 1.6300943225385593, "mean_action_processing_ms": 0.04634333244859647}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1128000, "timers": {"sample_time_ms": 7986.04, "sample_throughput": 500.874, "learn_time_ms": 12227.288, "learn_throughput": 327.137, "update_time_ms": 3.337}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.060887269227532674, "cur_lr": 5e-05, "total_loss": 3.7545657008886337, "policy_loss": -0.034810588957043365, "vf_loss": 3.7876216024160385, "vf_explained_var": 0.5562044978141785, "kl": 0.028818952676374465, "entropy": 0.18597291829064488, "entropy_coeff": 0.0}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 112, "training_iteration": 282, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-38-15", "timestamp": 1618144695, "time_this_iter_s": 20.348392248153687, "time_total_s": 6052.429881334305, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6052.429881334305, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 58.98620689655172, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -322.0, "episode_reward_min": -322.0, "episode_reward_mean": -322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48482820264929394, "mean_raw_obs_processing_ms": 0.10642093138607606, "mean_inference_ms": 1.6297743379924354, "mean_action_processing_ms": 0.04633370340130828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1132000, "timers": {"sample_time_ms": 7967.415, "sample_throughput": 502.045, "learn_time_ms": 12233.098, "learn_throughput": 326.982, "update_time_ms": 3.313}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09133090384129901, "cur_lr": 5e-05, "total_loss": 3.40419452637434, "policy_loss": -0.02633261011214927, "vf_loss": 3.428906187415123, "vf_explained_var": 0.49262088537216187, "kl": 0.0177486963220872, "entropy": 0.18861419381573796, "entropy_coeff": 0.0}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 113, "training_iteration": 283, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-38-35", "timestamp": 1618144715, "time_this_iter_s": 20.081942081451416, "time_total_s": 6072.511823415756, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6072.511823415756, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 58.18571428571429, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -322.0, "episode_reward_min": -322.0, "episode_reward_mean": -322.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48482820264929394, "mean_raw_obs_processing_ms": 0.10642093138607606, "mean_inference_ms": 1.6297743379924354, "mean_action_processing_ms": 0.04633370340130828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1136000, "timers": {"sample_time_ms": 7988.745, "sample_throughput": 500.704, "learn_time_ms": 12246.232, "learn_throughput": 326.631, "update_time_ms": 3.309}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09133090384129901, "cur_lr": 5e-05, "total_loss": 3.482745908200741, "policy_loss": -0.029274526867084205, "vf_loss": 3.5104582086205482, "vf_explained_var": 0.24394136667251587, "kl": 0.017105211401940323, "entropy": 0.062008302891626954, "entropy_coeff": 0.0}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 113, "training_iteration": 284, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-38-55", "timestamp": 1618144735, "time_this_iter_s": 20.44956064224243, "time_total_s": 6092.961384057999, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6092.961384057999, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 59.1344827586207, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -187.0, "episode_reward_min": -187.0, "episode_reward_mean": -187.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48282423268041896, "mean_raw_obs_processing_ms": 0.10663081046948623, "mean_inference_ms": 1.6298302742465256, "mean_action_processing_ms": 0.046332630079433446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1140000, "timers": {"sample_time_ms": 7998.313, "sample_throughput": 500.105, "learn_time_ms": 12229.464, "learn_throughput": 327.079, "update_time_ms": 3.324}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09133090384129901, "cur_lr": 5e-05, "total_loss": 2.459788478910923, "policy_loss": -0.03341061982791871, "vf_loss": 2.4918759390711784, "vf_explained_var": 0.41493797302246094, "kl": 0.014487851469311863, "entropy": 0.22683535469695926, "entropy_coeff": 0.0}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 114, "training_iteration": 285, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-39-15", "timestamp": 1618144755, "time_this_iter_s": 20.205893516540527, "time_total_s": 6113.167277574539, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3d710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6113.167277574539, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 59.27241379310345, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -187.0, "episode_reward_min": -187.0, "episode_reward_mean": -187.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48282423268041896, "mean_raw_obs_processing_ms": 0.10663081046948623, "mean_inference_ms": 1.6298302742465256, "mean_action_processing_ms": 0.046332630079433446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1144000, "timers": {"sample_time_ms": 7976.881, "sample_throughput": 501.449, "learn_time_ms": 12243.915, "learn_throughput": 326.693, "update_time_ms": 3.301}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09133090384129901, "cur_lr": 5e-05, "total_loss": 1.7472800463438034, "policy_loss": -0.05089870793744922, "vf_loss": 1.7960858941078186, "vf_explained_var": 0.47289764881134033, "kl": 0.022914932284038514, "entropy": 0.3466205717995763, "entropy_coeff": 0.0}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 114, "training_iteration": 286, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-39-35", "timestamp": 1618144775, "time_this_iter_s": 20.142523527145386, "time_total_s": 6133.309801101685, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222ded0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6133.309801101685, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 58.56896551724137, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -187.0, "episode_reward_min": -187.0, "episode_reward_mean": -187.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.48282423268041896, "mean_raw_obs_processing_ms": 0.10663081046948623, "mean_inference_ms": 1.6298302742465256, "mean_action_processing_ms": 0.046332630079433446}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1148000, "timers": {"sample_time_ms": 7963.197, "sample_throughput": 502.311, "learn_time_ms": 12242.953, "learn_throughput": 326.719, "update_time_ms": 3.276}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.13699635576194852, "cur_lr": 5e-05, "total_loss": 1.2410646602511406, "policy_loss": -0.033361123758368194, "vf_loss": 1.2711967285722494, "vf_explained_var": 0.33972716331481934, "kl": 0.02357047819532454, "entropy": 0.3065401716157794, "entropy_coeff": 0.0}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 114, "training_iteration": 287, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-39-56", "timestamp": 1618144796, "time_this_iter_s": 20.00757145881653, "time_total_s": 6153.317372560501, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6153.317372560501, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 58.36551724137931, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -90.0, "episode_reward_min": -90.0, "episode_reward_mean": -90.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.479664641772019, "mean_raw_obs_processing_ms": 0.1069350549913676, "mean_inference_ms": 1.6295144163322872, "mean_action_processing_ms": 0.04632205924044087}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1152000, "timers": {"sample_time_ms": 7981.976, "sample_throughput": 501.129, "learn_time_ms": 12204.169, "learn_throughput": 327.757, "update_time_ms": 3.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20549453364292278, "cur_lr": 5e-05, "total_loss": 0.47799810231663287, "policy_loss": -0.006854326056782156, "vf_loss": 0.48480712808668613, "vf_explained_var": -0.0029358211904764175, "kl": 0.00022046537048936443, "entropy": 0.026843967207241803, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 115, "training_iteration": 288, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-40-16", "timestamp": 1618144816, "time_this_iter_s": 20.20789337158203, "time_total_s": 6173.525265932083, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6173.525265932083, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 59.07857142857143, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -90.0, "episode_reward_min": -90.0, "episode_reward_mean": -90.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.479664641772019, "mean_raw_obs_processing_ms": 0.1069350549913676, "mean_inference_ms": 1.6295144163322872, "mean_action_processing_ms": 0.04632205924044087}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1156000, "timers": {"sample_time_ms": 7997.136, "sample_throughput": 500.179, "learn_time_ms": 12210.254, "learn_throughput": 327.594, "update_time_ms": 3.052}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10274726682146139, "cur_lr": 5e-05, "total_loss": 0.3355598086491227, "policy_loss": -0.04902753757778555, "vf_loss": 0.3813984412699938, "vf_explained_var": 0.45936572551727295, "kl": 0.031036449479870498, "entropy": 0.2139767250046134, "entropy_coeff": 0.0}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 115, "training_iteration": 289, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-40-36", "timestamp": 1618144836, "time_this_iter_s": 20.324127912521362, "time_total_s": 6193.8493938446045, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6193.8493938446045, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 59.25, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -38.0, "episode_reward_min": -38.0, "episode_reward_mean": -38.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4775569348460719, "mean_raw_obs_processing_ms": 0.10713319154665925, "mean_inference_ms": 1.6293383678608035, "mean_action_processing_ms": 0.04631399938669844}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1160000, "timers": {"sample_time_ms": 7984.731, "sample_throughput": 500.956, "learn_time_ms": 12195.627, "learn_throughput": 327.986, "update_time_ms": 3.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15412090023219208, "cur_lr": 5e-05, "total_loss": 0.35617509589064866, "policy_loss": -0.05095193095621653, "vf_loss": 0.4035349292680621, "vf_explained_var": 0.4498344361782074, "kl": 0.023307028110139072, "entropy": 0.6617132276296616, "entropy_coeff": 0.0}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 116, "training_iteration": 290, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-40-56", "timestamp": 1618144856, "time_this_iter_s": 19.92016315460205, "time_total_s": 6213.7695569992065, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3df50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6927590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6213.7695569992065, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 58.33214285714285, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -38.0, "episode_reward_min": -38.0, "episode_reward_mean": -38.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4775569348460719, "mean_raw_obs_processing_ms": 0.10713319154665925, "mean_inference_ms": 1.6293383678608035, "mean_action_processing_ms": 0.04631399938669844}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1164000, "timers": {"sample_time_ms": 7985.617, "sample_throughput": 500.901, "learn_time_ms": 12188.714, "learn_throughput": 328.172, "update_time_ms": 3.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.23118135034828813, "cur_lr": 5e-05, "total_loss": 0.8357534501701593, "policy_loss": -0.051707035512663424, "vf_loss": 0.8824858106672764, "vf_explained_var": 0.7190240025520325, "kl": 0.021518513996852562, "entropy": 0.4433971354737878, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 116, "training_iteration": 291, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-41-16", "timestamp": 1618144876, "time_this_iter_s": 20.14765477180481, "time_total_s": 6233.917211771011, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c23022d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6233.917211771011, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 59.068965517241374, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -38.0, "episode_reward_min": -38.0, "episode_reward_mean": -38.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4775569348460719, "mean_raw_obs_processing_ms": 0.10713319154665925, "mean_inference_ms": 1.6293383678608035, "mean_action_processing_ms": 0.04631399938669844}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1168000, "timers": {"sample_time_ms": 7977.229, "sample_throughput": 501.427, "learn_time_ms": 12163.312, "learn_throughput": 328.858, "update_time_ms": 3.073}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.15346740931272507, "policy_loss": -0.055011994030792266, "vf_loss": 0.20282538840547204, "vf_explained_var": 0.5305004715919495, "kl": 0.016304699500324205, "entropy": 0.5791965667158365, "entropy_coeff": 0.0}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 116, "training_iteration": 292, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-41-36", "timestamp": 1618144896, "time_this_iter_s": 20.007970333099365, "time_total_s": 6253.925182104111, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6253.925182104111, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 59.05, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -99.0, "episode_reward_min": -99.0, "episode_reward_mean": -99.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47446027692457976, "mean_raw_obs_processing_ms": 0.10742792668493482, "mean_inference_ms": 1.6291371390485074, "mean_action_processing_ms": 0.046308758064950044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1172000, "timers": {"sample_time_ms": 7965.897, "sample_throughput": 502.141, "learn_time_ms": 12183.518, "learn_throughput": 328.312, "update_time_ms": 3.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.0022476154554169625, "policy_loss": -0.036331287992652506, "vf_loss": 0.03284657723270357, "vf_explained_var": -0.0012937262654304504, "kl": 0.01653052808251232, "entropy": 0.5659979861229658, "entropy_coeff": 0.0}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 117, "training_iteration": 293, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-41-56", "timestamp": 1618144916, "time_this_iter_s": 20.175183296203613, "time_total_s": 6274.100365400314, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6274.100365400314, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 58.10344827586207, "ram_util_percent": 27.62758620689656}, "trial_id": "9be58_00000"}
{"episode_reward_max": -99.0, "episode_reward_min": -99.0, "episode_reward_mean": -99.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.47446027692457976, "mean_raw_obs_processing_ms": 0.10742792668493482, "mean_inference_ms": 1.6291371390485074, "mean_action_processing_ms": 0.046308758064950044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1176000, "timers": {"sample_time_ms": 7925.442, "sample_throughput": 504.704, "learn_time_ms": 12182.179, "learn_throughput": 328.348, "update_time_ms": 3.203}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": -0.035879765171557665, "policy_loss": -0.05047338217264041, "vf_loss": 0.008384096450754441, "vf_explained_var": -0.934585452079773, "kl": 0.01790664385771379, "entropy": 0.5790487192571163, "entropy_coeff": 0.0}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 117, "training_iteration": 294, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-42-17", "timestamp": 1618144937, "time_this_iter_s": 20.02853488922119, "time_total_s": 6294.1289002895355, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6294.1289002895355, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 58.789655172413795, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -17.0, "episode_reward_min": -17.0, "episode_reward_mean": -17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4723856886909809, "mean_raw_obs_processing_ms": 0.10761995509705137, "mean_inference_ms": 1.6290240498675959, "mean_action_processing_ms": 0.04630452652800673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1180000, "timers": {"sample_time_ms": 7920.509, "sample_throughput": 505.018, "learn_time_ms": 12185.762, "learn_throughput": 328.252, "update_time_ms": 3.19}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.07837814738741145, "policy_loss": -0.049799486238043755, "vf_loss": 0.12335437082219869, "vf_explained_var": 0.6425015926361084, "kl": 0.013909033499658108, "entropy": 0.5784565415233374, "entropy_coeff": 0.0}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 118, "training_iteration": 295, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-42-37", "timestamp": 1618144957, "time_this_iter_s": 20.19024085998535, "time_total_s": 6314.319141149521, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6314.319141149521, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 58.9655172413793, "ram_util_percent": 27.655172413793107}, "trial_id": "9be58_00000"}
{"episode_reward_max": -17.0, "episode_reward_min": -17.0, "episode_reward_mean": -17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4723856886909809, "mean_raw_obs_processing_ms": 0.10761995509705137, "mean_inference_ms": 1.6290240498675959, "mean_action_processing_ms": 0.04630452652800673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1184000, "timers": {"sample_time_ms": 7920.692, "sample_throughput": 505.006, "learn_time_ms": 12185.533, "learn_throughput": 328.258, "update_time_ms": 3.185}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.09884102025534958, "policy_loss": -0.03725998179288581, "vf_loss": 0.13241056050173938, "vf_explained_var": 0.742027759552002, "kl": 0.010642262830515392, "entropy": 0.5333674075081944, "entropy_coeff": 0.0}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 118, "training_iteration": 296, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-42-57", "timestamp": 1618144977, "time_this_iter_s": 20.145465850830078, "time_total_s": 6334.464607000351, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fce50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6334.464607000351, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 58.99642857142856, "ram_util_percent": 27.600000000000005}, "trial_id": "9be58_00000"}
{"episode_reward_max": -17.0, "episode_reward_min": -17.0, "episode_reward_mean": -17.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4723856886909809, "mean_raw_obs_processing_ms": 0.10761995509705137, "mean_inference_ms": 1.6290240498675959, "mean_action_processing_ms": 0.04630452652800673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1188000, "timers": {"sample_time_ms": 7931.167, "sample_throughput": 504.339, "learn_time_ms": 12193.692, "learn_throughput": 328.038, "update_time_ms": 3.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.7207737248390913, "policy_loss": -0.03880730568198487, "vf_loss": 0.7536595892161131, "vf_explained_var": 0.5243092775344849, "kl": 0.017075895884772763, "entropy": 0.36710893642157316, "entropy_coeff": 0.0}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 118, "training_iteration": 297, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-43-17", "timestamp": 1618144997, "time_this_iter_s": 20.194397926330566, "time_total_s": 6354.6590049266815, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6354.6590049266815, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 58.07241379310344, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -110.0, "episode_reward_min": -110.0, "episode_reward_mean": -110.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4694821076203749, "mean_raw_obs_processing_ms": 0.10791528152349472, "mean_inference_ms": 1.6287706341201056, "mean_action_processing_ms": 0.046298068604178406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1192000, "timers": {"sample_time_ms": 7932.798, "sample_throughput": 504.236, "learn_time_ms": 12193.276, "learn_throughput": 328.05, "update_time_ms": 3.202}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3467720255224322, "cur_lr": 5e-05, "total_loss": 0.2713733265409246, "policy_loss": -0.05339476786321029, "vf_loss": 0.31781958509236574, "vf_explained_var": 0.5976039171218872, "kl": 0.020037690439494327, "entropy": 0.44275832921266556, "entropy_coeff": 0.0}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 119, "training_iteration": 298, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-43-37", "timestamp": 1618145017, "time_this_iter_s": 20.222199201583862, "time_total_s": 6374.881204128265, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6374.881204128265, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 59.3448275862069, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -110.0, "episode_reward_min": -110.0, "episode_reward_mean": -110.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4694821076203749, "mean_raw_obs_processing_ms": 0.10791528152349472, "mean_inference_ms": 1.6287706341201056, "mean_action_processing_ms": 0.046298068604178406}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1196000, "timers": {"sample_time_ms": 7944.862, "sample_throughput": 503.47, "learn_time_ms": 12187.979, "learn_throughput": 328.192, "update_time_ms": 3.234}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.38708205334842205, "policy_loss": -0.022134520608233288, "vf_loss": 0.4039072999730706, "vf_explained_var": 0.5684146881103516, "kl": 0.010207044120761566, "entropy": 0.2660025688819587, "entropy_coeff": 0.0}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 119, "training_iteration": 299, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-43-58", "timestamp": 1618145038, "time_this_iter_s": 20.393399477005005, "time_total_s": 6395.27460360527, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3d6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fce10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6395.27460360527, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 58.87241379310345, "ram_util_percent": 27.606896551724148}, "trial_id": "9be58_00000"}
{"episode_reward_max": -86.0, "episode_reward_min": -86.0, "episode_reward_mean": -86.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46767023095466287, "mean_raw_obs_processing_ms": 0.1081153821013809, "mean_inference_ms": 1.6286413798695696, "mean_action_processing_ms": 0.04630183513880326}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1200000, "timers": {"sample_time_ms": 7959.553, "sample_throughput": 502.541, "learn_time_ms": 12198.466, "learn_throughput": 327.91, "update_time_ms": 3.179}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.288089886540547, "policy_loss": -0.0336393405450508, "vf_loss": 0.3122650384902954, "vf_explained_var": 0.6782026290893555, "kl": 0.01819482198334299, "entropy": 0.4378019394353032, "entropy_coeff": 0.0}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 120, "training_iteration": 300, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-44-18", "timestamp": 1618145058, "time_this_iter_s": 20.173882722854614, "time_total_s": 6415.448486328125, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d9d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6415.448486328125, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 58.63103448275862, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -86.0, "episode_reward_min": -86.0, "episode_reward_mean": -86.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46767023095466287, "mean_raw_obs_processing_ms": 0.1081153821013809, "mean_inference_ms": 1.6286413798695696, "mean_action_processing_ms": 0.04630183513880326}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1204000, "timers": {"sample_time_ms": 7943.365, "sample_throughput": 503.565, "learn_time_ms": 12207.849, "learn_throughput": 327.658, "update_time_ms": 3.134}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.3144108896376565, "policy_loss": -0.041574496834073216, "vf_loss": 0.3510750667192042, "vf_explained_var": 0.683040976524353, "kl": 0.009440053079742938, "entropy": 0.36517149582505226, "entropy_coeff": 0.0}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 120, "training_iteration": 301, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-44-38", "timestamp": 1618145078, "time_this_iter_s": 20.078717708587646, "time_total_s": 6435.527204036713, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33568d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4dd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6435.527204036713, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 58.389655172413796, "ram_util_percent": 27.60344827586208}, "trial_id": "9be58_00000"}
{"episode_reward_max": -86.0, "episode_reward_min": -86.0, "episode_reward_mean": -86.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46767023095466287, "mean_raw_obs_processing_ms": 0.1081153821013809, "mean_inference_ms": 1.6286413798695696, "mean_action_processing_ms": 0.04630183513880326}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1208000, "timers": {"sample_time_ms": 7951.375, "sample_throughput": 503.058, "learn_time_ms": 12233.292, "learn_throughput": 326.977, "update_time_ms": 3.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.10350042779464275, "policy_loss": -0.059381782775744796, "vf_loss": 0.15430737123824656, "vf_explained_var": 0.37574389576911926, "kl": 0.016485070111230016, "entropy": 0.6275947913527489, "entropy_coeff": 0.0}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 120, "training_iteration": 302, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-44-59", "timestamp": 1618145099, "time_this_iter_s": 20.343846082687378, "time_total_s": 6455.8710501194, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22cae50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6455.8710501194, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 59.8206896551724, "ram_util_percent": 27.65862068965518}, "trial_id": "9be58_00000"}
{"episode_reward_max": -43.0, "episode_reward_min": -43.0, "episode_reward_mean": -43.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4648210542822027, "mean_raw_obs_processing_ms": 0.10841107551236993, "mean_inference_ms": 1.6283710957196285, "mean_action_processing_ms": 0.046298484757017415}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1212000, "timers": {"sample_time_ms": 7958.584, "sample_throughput": 502.602, "learn_time_ms": 12228.215, "learn_throughput": 327.112, "update_time_ms": 3.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.01771877659484744, "policy_loss": -0.043307483807438985, "vf_loss": 0.05516493821050972, "vf_explained_var": 0.4357548952102661, "kl": 0.011268347268924117, "entropy": 0.5050195381045341, "entropy_coeff": 0.0}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 121, "training_iteration": 303, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-45-19", "timestamp": 1618145119, "time_this_iter_s": 20.19483733177185, "time_total_s": 6476.065887451172, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22caf10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6476.065887451172, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 59.0448275862069, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -43.0, "episode_reward_min": -43.0, "episode_reward_mean": -43.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4648210542822027, "mean_raw_obs_processing_ms": 0.10841107551236993, "mean_inference_ms": 1.6283710957196285, "mean_action_processing_ms": 0.046298484757017415}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1216000, "timers": {"sample_time_ms": 7965.133, "sample_throughput": 502.189, "learn_time_ms": 12213.915, "learn_throughput": 327.495, "update_time_ms": 3.08}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.1164072816609405, "policy_loss": -0.03310439543565735, "vf_loss": 0.14245620998553932, "vf_explained_var": 0.6653717160224915, "kl": 0.013564078544732183, "entropy": 0.4059264622628689, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 121, "training_iteration": 304, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-45-39", "timestamp": 1618145139, "time_this_iter_s": 19.953880071640015, "time_total_s": 6496.019767522812, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e52d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6496.019767522812, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 58.03928571428572, "ram_util_percent": 27.650000000000002}, "trial_id": "9be58_00000"}
{"episode_reward_max": -30.0, "episode_reward_min": -30.0, "episode_reward_mean": -30.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46294223368745113, "mean_raw_obs_processing_ms": 0.10861028500374169, "mean_inference_ms": 1.6282312205000546, "mean_action_processing_ms": 0.046293055001410156}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1220000, "timers": {"sample_time_ms": 7964.094, "sample_throughput": 502.254, "learn_time_ms": 12212.022, "learn_throughput": 327.546, "update_time_ms": 3.126}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.11601773102302104, "policy_loss": -0.028627922583837062, "vf_loss": 0.13951989961788058, "vf_explained_var": 0.6485903263092041, "kl": 0.009854227435425855, "entropy": 0.3194958185777068, "entropy_coeff": 0.0}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 122, "training_iteration": 305, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-45-59", "timestamp": 1618145159, "time_this_iter_s": 20.16311287879944, "time_total_s": 6516.182880401611, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6516.182880401611, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 59.03448275862069, "ram_util_percent": 27.60000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": -30.0, "episode_reward_min": -30.0, "episode_reward_mean": -30.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46294223368745113, "mean_raw_obs_processing_ms": 0.10861028500374169, "mean_inference_ms": 1.6282312205000546, "mean_action_processing_ms": 0.046293055001410156}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1224000, "timers": {"sample_time_ms": 7987.445, "sample_throughput": 500.786, "learn_time_ms": 12202.005, "learn_throughput": 327.815, "update_time_ms": 3.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.2583261073741596, "policy_loss": -0.04198476715828292, "vf_loss": 0.2946723881177604, "vf_explained_var": 0.5808941125869751, "kl": 0.010839952359674498, "entropy": 0.3474948676303029, "entropy_coeff": 0.0}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 122, "training_iteration": 306, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-46-19", "timestamp": 1618145179, "time_this_iter_s": 20.276989936828613, "time_total_s": 6536.45987033844, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6536.45987033844, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 59.489655172413805, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -30.0, "episode_reward_min": -30.0, "episode_reward_mean": -30.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46294223368745113, "mean_raw_obs_processing_ms": 0.10861028500374169, "mean_inference_ms": 1.6282312205000546, "mean_action_processing_ms": 0.046293055001410156}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1228000, "timers": {"sample_time_ms": 7995.228, "sample_throughput": 500.298, "learn_time_ms": 12208.545, "learn_throughput": 327.639, "update_time_ms": 3.114}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.3207460786215961, "policy_loss": -0.02685563120758161, "vf_loss": 0.34156046411953866, "vf_explained_var": 0.35265418887138367, "kl": 0.011614235729211941, "entropy": 0.2354156794026494, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 122, "training_iteration": 307, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-46-40", "timestamp": 1618145200, "time_this_iter_s": 20.340929985046387, "time_total_s": 6556.800800323486, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22021d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6556.800800323486, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 59.19310344827586, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -49.0, "episode_reward_min": -49.0, "episode_reward_mean": -49.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46070354415791415, "mean_raw_obs_processing_ms": 0.10890308317181403, "mean_inference_ms": 1.6279904528316607, "mean_action_processing_ms": 0.04629359091075335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1232000, "timers": {"sample_time_ms": 8025.493, "sample_throughput": 498.412, "learn_time_ms": 12215.023, "learn_throughput": 327.466, "update_time_ms": 3.125}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5201580382836483, "cur_lr": 5e-05, "total_loss": 0.68487633112818, "policy_loss": -0.06345235311891884, "vf_loss": 0.7233081366866827, "vf_explained_var": 0.05702905356884003, "kl": 0.048101845546625555, "entropy": 0.4363959515467286, "entropy_coeff": 0.0}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 123, "training_iteration": 308, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-47-00", "timestamp": 1618145220, "time_this_iter_s": 20.588478088378906, "time_total_s": 6577.389278411865, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6577.389278411865, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 58.775862068965516, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -49.0, "episode_reward_min": -49.0, "episode_reward_mean": -49.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.46070354415791415, "mean_raw_obs_processing_ms": 0.10890308317181403, "mean_inference_ms": 1.6279904528316607, "mean_action_processing_ms": 0.04629359091075335}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1236000, "timers": {"sample_time_ms": 8041.713, "sample_throughput": 497.406, "learn_time_ms": 12206.23, "learn_throughput": 327.702, "update_time_ms": 3.101}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.2022752743505407, "policy_loss": -0.04903229797491804, "vf_loss": 0.24250489147379994, "vf_explained_var": 0.49315252900123596, "kl": 0.01128206294379197, "entropy": 0.3822604641318321, "entropy_coeff": 0.0}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 123, "training_iteration": 309, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-47-21", "timestamp": 1618145241, "time_this_iter_s": 20.467889547348022, "time_total_s": 6597.857167959213, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6de7110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6597.857167959213, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 58.980000000000004, "ram_util_percent": 27.67333333333334}, "trial_id": "9be58_00000"}
{"episode_reward_max": -60.0, "episode_reward_min": -60.0, "episode_reward_mean": -60.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45905696107025146, "mean_raw_obs_processing_ms": 0.1091314035595843, "mean_inference_ms": 1.6281287703077614, "mean_action_processing_ms": 0.04629561609262656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1240000, "timers": {"sample_time_ms": 8068.589, "sample_throughput": 495.75, "learn_time_ms": 12204.131, "learn_throughput": 327.758, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.19755721656838432, "policy_loss": -0.023667103552725166, "vf_loss": 0.21571729145944118, "vf_explained_var": 0.58935546875, "kl": 0.007058150717057288, "entropy": 0.22479494009166956, "entropy_coeff": 0.0}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 124, "training_iteration": 310, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-47-41", "timestamp": 1618145261, "time_this_iter_s": 20.421814441680908, "time_total_s": 6618.278982400894, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b6de7190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b6de70d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6618.278982400894, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 59.210344827586205, "ram_util_percent": 27.668965517241382}, "trial_id": "9be58_00000"}
{"episode_reward_max": -60.0, "episode_reward_min": -60.0, "episode_reward_mean": -60.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45905696107025146, "mean_raw_obs_processing_ms": 0.1091314035595843, "mean_inference_ms": 1.6281287703077614, "mean_action_processing_ms": 0.04629561609262656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1244000, "timers": {"sample_time_ms": 8082.162, "sample_throughput": 494.917, "learn_time_ms": 12219.016, "learn_throughput": 327.359, "update_time_ms": 3.171}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.18183362332638353, "policy_loss": -0.04748665960505605, "vf_loss": 0.2204344398342073, "vf_explained_var": 0.5516912937164307, "kl": 0.011388651153538376, "entropy": 0.5365300057455897, "entropy_coeff": 0.0}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 124, "training_iteration": 311, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-48-01", "timestamp": 1618145281, "time_this_iter_s": 20.362530946731567, "time_total_s": 6638.641513347626, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d25d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c4390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6638.641513347626, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 59.7448275862069, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -60.0, "episode_reward_min": -60.0, "episode_reward_mean": -60.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45905696107025146, "mean_raw_obs_processing_ms": 0.1091314035595843, "mean_inference_ms": 1.6281287703077614, "mean_action_processing_ms": 0.04629561609262656}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1248000, "timers": {"sample_time_ms": 8075.03, "sample_throughput": 495.354, "learn_time_ms": 12203.626, "learn_throughput": 327.771, "update_time_ms": 3.147}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.10323280826560222, "policy_loss": -0.01443094463320449, "vf_loss": 0.10879790503531694, "vf_explained_var": 0.031124813482165337, "kl": 0.011363019541022368, "entropy": 0.37942173425108194, "entropy_coeff": 0.0}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 124, "training_iteration": 312, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-48-22", "timestamp": 1618145302, "time_this_iter_s": 20.11877727508545, "time_total_s": 6658.760290622711, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fce90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6658.760290622711, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 58.0551724137931, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -40.0, "episode_reward_min": -40.0, "episode_reward_mean": -40.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4564038651635934, "mean_raw_obs_processing_ms": 0.10944483835382521, "mean_inference_ms": 1.6280465633491714, "mean_action_processing_ms": 0.04629286292141235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1252000, "timers": {"sample_time_ms": 8097.911, "sample_throughput": 493.955, "learn_time_ms": 12197.673, "learn_throughput": 327.931, "update_time_ms": 3.189}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.1311947635258548, "policy_loss": -0.05381518020294607, "vf_loss": 0.1724541042931378, "vf_explained_var": 0.5680095553398132, "kl": 0.016092336853034794, "entropy": 0.5923995450139046, "entropy_coeff": 0.0}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 125, "training_iteration": 313, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-48-42", "timestamp": 1618145322, "time_this_iter_s": 20.365214109420776, "time_total_s": 6679.125504732132, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6679.125504732132, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 59.21724137931035, "ram_util_percent": 27.696551724137937}, "trial_id": "9be58_00000"}
{"episode_reward_max": -40.0, "episode_reward_min": -40.0, "episode_reward_mean": -40.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4564038651635934, "mean_raw_obs_processing_ms": 0.10944483835382521, "mean_inference_ms": 1.6280465633491714, "mean_action_processing_ms": 0.04629286292141235}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1256000, "timers": {"sample_time_ms": 8124.164, "sample_throughput": 492.358, "learn_time_ms": 12225.491, "learn_throughput": 327.185, "update_time_ms": 3.145}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.08909245510585606, "policy_loss": -0.05503783549647778, "vf_loss": 0.13423180277459323, "vf_explained_var": 0.5369323492050171, "kl": 0.012686514208326116, "entropy": 0.6110141444951296, "entropy_coeff": 0.0}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 125, "training_iteration": 314, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-49-03", "timestamp": 1618145343, "time_this_iter_s": 20.49439525604248, "time_total_s": 6699.619899988174, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6699.619899988174, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 59.16896551724138, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45469806967426246, "mean_raw_obs_processing_ms": 0.10966696190898816, "mean_inference_ms": 1.6281164718401941, "mean_action_processing_ms": 0.04629384503090961}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1260000, "timers": {"sample_time_ms": 8136.953, "sample_throughput": 491.584, "learn_time_ms": 12219.461, "learn_throughput": 327.347, "update_time_ms": 3.104}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.03975773195270449, "policy_loss": -0.05424275703262538, "vf_loss": 0.0789579072734341, "vf_explained_var": 0.6331105828285217, "kl": 0.019279497704701498, "entropy": 0.5449454747140408, "entropy_coeff": 0.0}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 126, "training_iteration": 315, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-49-23", "timestamp": 1618145363, "time_this_iter_s": 20.228405952453613, "time_total_s": 6719.848305940628, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6719.848305940628, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 59.54827586206897, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45469806967426246, "mean_raw_obs_processing_ms": 0.10966696190898816, "mean_inference_ms": 1.6281164718401941, "mean_action_processing_ms": 0.04629384503090961}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1264000, "timers": {"sample_time_ms": 8124.316, "sample_throughput": 492.349, "learn_time_ms": 12220.372, "learn_throughput": 327.322, "update_time_ms": 3.15}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.02800600294722244, "policy_loss": -0.027515516034327447, "vf_loss": 0.04479365178849548, "vf_explained_var": 0.5025034546852112, "kl": 0.0137494943337515, "entropy": 0.47224354185163975, "entropy_coeff": 0.0}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 126, "training_iteration": 316, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-49-43", "timestamp": 1618145383, "time_this_iter_s": 20.158822774887085, "time_total_s": 6740.007128715515, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221fe10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9d10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6740.007128715515, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 58.16206896551724, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -24.0, "episode_reward_min": -24.0, "episode_reward_mean": -24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45469806967426246, "mean_raw_obs_processing_ms": 0.10966696190898816, "mean_inference_ms": 1.6281164718401941, "mean_action_processing_ms": 0.04629384503090961}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1268000, "timers": {"sample_time_ms": 8133.159, "sample_throughput": 491.814, "learn_time_ms": 12208.857, "learn_throughput": 327.631, "update_time_ms": 3.19}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.08370077644940466, "policy_loss": -0.024725639348616824, "vf_loss": 0.09862431173678488, "vf_explained_var": 0.49410584568977356, "kl": 0.012562977455672808, "entropy": 0.5886418055742979, "entropy_coeff": 0.0}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 126, "training_iteration": 317, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-50-03", "timestamp": 1618145403, "time_this_iter_s": 20.311160564422607, "time_total_s": 6760.318289279938, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1990>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6760.318289279938, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 58.9896551724138, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -9.0, "episode_reward_min": -9.0, "episode_reward_mean": -9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4522585591599095, "mean_raw_obs_processing_ms": 0.10997202631510469, "mean_inference_ms": 1.6279683830613796, "mean_action_processing_ms": 0.0462887016953}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1272000, "timers": {"sample_time_ms": 8106.86, "sample_throughput": 493.409, "learn_time_ms": 12198.652, "learn_throughput": 327.905, "update_time_ms": 3.185}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.013402213546214625, "policy_loss": -0.02648187172599137, "vf_loss": 0.0330896750674583, "vf_explained_var": 0.6364437341690063, "kl": 0.008708132314495742, "entropy": 0.6183435507118702, "entropy_coeff": 0.0}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 127, "training_iteration": 318, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-50-24", "timestamp": 1618145424, "time_this_iter_s": 20.222203254699707, "time_total_s": 6780.540492534637, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a1a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6780.540492534637, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 58.99310344827586, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -9.0, "episode_reward_min": -9.0, "episode_reward_mean": -9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4522585591599095, "mean_raw_obs_processing_ms": 0.10997202631510469, "mean_inference_ms": 1.6279683830613796, "mean_action_processing_ms": 0.0462887016953}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1276000, "timers": {"sample_time_ms": 8076.368, "sample_throughput": 495.272, "learn_time_ms": 12225.961, "learn_throughput": 327.173, "update_time_ms": 3.154}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.08380129933357239, "policy_loss": -0.060313719062833115, "vf_loss": 0.13102580700069666, "vf_explained_var": 0.589111864566803, "kl": 0.016775940282968804, "entropy": 0.6302397008985281, "entropy_coeff": 0.0}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 127, "training_iteration": 319, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-50-44", "timestamp": 1618145444, "time_this_iter_s": 20.436341524124146, "time_total_s": 6800.976834058762, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6800.976834058762, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 59.24827586206897, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45057122710483144, "mean_raw_obs_processing_ms": 0.11016343253498417, "mean_inference_ms": 1.627754301708866, "mean_action_processing_ms": 0.04628095941312365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1280000, "timers": {"sample_time_ms": 8039.412, "sample_throughput": 497.549, "learn_time_ms": 12231.278, "learn_throughput": 327.03, "update_time_ms": 3.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.10366872965823859, "policy_loss": -0.052106877497863024, "vf_loss": 0.1431256807409227, "vf_explained_var": 0.4848218560218811, "kl": 0.0162129259260837, "entropy": 0.6005342807620764, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 128, "training_iteration": 320, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-51-04", "timestamp": 1618145464, "time_this_iter_s": 20.102734804153442, "time_total_s": 6821.079568862915, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6821.079568862915, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 58.510714285714286, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45057122710483144, "mean_raw_obs_processing_ms": 0.11016343253498417, "mean_inference_ms": 1.627754301708866, "mean_action_processing_ms": 0.04628095941312365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1284000, "timers": {"sample_time_ms": 8030.091, "sample_throughput": 498.126, "learn_time_ms": 12211.74, "learn_throughput": 327.554, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.00783242128090933, "policy_loss": -0.035256441798992455, "vf_loss": 0.03672694228589535, "vf_explained_var": 0.5970361232757568, "kl": 0.00815382957807742, "entropy": 0.5725254826247692, "entropy_coeff": 0.0}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 128, "training_iteration": 321, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-51-24", "timestamp": 1618145484, "time_this_iter_s": 20.076561212539673, "time_total_s": 6841.156130075455, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fcb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6841.156130075455, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 59.07241379310344, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -19.0, "episode_reward_min": -19.0, "episode_reward_mean": -19.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.45057122710483144, "mean_raw_obs_processing_ms": 0.11016343253498417, "mean_inference_ms": 1.627754301708866, "mean_action_processing_ms": 0.04628095941312365}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1288000, "timers": {"sample_time_ms": 8017.641, "sample_throughput": 498.9, "learn_time_ms": 12216.483, "learn_throughput": 327.426, "update_time_ms": 3.102}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.0012790770269930363, "policy_loss": -0.057021360902581364, "vf_loss": 0.04724393610376865, "vf_explained_var": 0.42282557487487793, "kl": 0.01417069521266967, "entropy": 0.6511382982134819, "entropy_coeff": 0.0}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 128, "training_iteration": 322, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-51-44", "timestamp": 1618145504, "time_this_iter_s": 20.04426121711731, "time_total_s": 6861.200391292572, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6861.200391292572, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 59.182758620689654, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4479492781266618, "mean_raw_obs_processing_ms": 0.11046185853115636, "mean_inference_ms": 1.627411185614235, "mean_action_processing_ms": 0.04626728118037245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1292000, "timers": {"sample_time_ms": 7987.477, "sample_throughput": 500.784, "learn_time_ms": 12216.272, "learn_throughput": 327.432, "update_time_ms": 3.077}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.05436832120176405, "policy_loss": -0.05605501070385799, "vf_loss": 0.10119476926047355, "vf_explained_var": 0.3460230827331543, "kl": 0.011827894806629047, "entropy": 0.7134539689868689, "entropy_coeff": 0.0}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 129, "training_iteration": 323, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-52-04", "timestamp": 1618145524, "time_this_iter_s": 20.061084985733032, "time_total_s": 6881.261476278305, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2f10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6881.261476278305, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 58.52857142857143, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4479492781266618, "mean_raw_obs_processing_ms": 0.11046185853115636, "mean_inference_ms": 1.627411185614235, "mean_action_processing_ms": 0.04626728118037245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1296000, "timers": {"sample_time_ms": 7981.967, "sample_throughput": 501.13, "learn_time_ms": 12203.899, "learn_throughput": 327.764, "update_time_ms": 3.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.010147461929591373, "policy_loss": -0.0493278595386073, "vf_loss": 0.048801088938489556, "vf_explained_var": 0.5618739128112793, "kl": 0.013680757489055395, "entropy": 0.7694701738655567, "entropy_coeff": 0.0}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 129, "training_iteration": 324, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-52-25", "timestamp": 1618145545, "time_this_iter_s": 20.314451217651367, "time_total_s": 6901.575927495956, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e54d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3da50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6901.575927495956, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 59.38620689655173, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4462319530647597, "mean_raw_obs_processing_ms": 0.11068015589599965, "mean_inference_ms": 1.6274907573936546, "mean_action_processing_ms": 0.046267512383825544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1300000, "timers": {"sample_time_ms": 7974.596, "sample_throughput": 501.593, "learn_time_ms": 12211.559, "learn_throughput": 327.559, "update_time_ms": 3.068}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.14514424273511395, "policy_loss": -0.05856729543302208, "vf_loss": 0.19493798981420696, "vf_explained_var": 0.34767377376556396, "kl": 0.011244718974921852, "entropy": 0.6881469413638115, "entropy_coeff": 0.0}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 130, "training_iteration": 325, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-52-45", "timestamp": 1618145565, "time_this_iter_s": 20.235000371932983, "time_total_s": 6921.810927867889, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6921.810927867889, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 59.334482758620695, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4462319530647597, "mean_raw_obs_processing_ms": 0.11068015589599965, "mean_inference_ms": 1.6274907573936546, "mean_action_processing_ms": 0.046267512383825544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1304000, "timers": {"sample_time_ms": 7960.345, "sample_throughput": 502.491, "learn_time_ms": 12207.925, "learn_throughput": 327.656, "update_time_ms": 3.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.0969501449726522, "policy_loss": -0.05540707032196224, "vf_loss": 0.14323315303772688, "vf_explained_var": 0.47255438566207886, "kl": 0.011693957319948822, "entropy": 0.6432014014571905, "entropy_coeff": 0.0}}, "num_steps_sampled": 1304000, "num_steps_trained": 1304000}, "done": false, "episodes_total": 130, "training_iteration": 326, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-53-05", "timestamp": 1618145585, "time_this_iter_s": 19.983779191970825, "time_total_s": 6941.79470705986, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6941.79470705986, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 58.31724137931034, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 16.0, "episode_reward_min": 16.0, "episode_reward_mean": 16.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4462319530647597, "mean_raw_obs_processing_ms": 0.11068015589599965, "mean_inference_ms": 1.6274907573936546, "mean_action_processing_ms": 0.046267512383825544}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1308000, "timers": {"sample_time_ms": 7958.088, "sample_throughput": 502.633, "learn_time_ms": 12205.82, "learn_throughput": 327.713, "update_time_ms": 3.129}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.0544940335676074, "policy_loss": -0.052873411565087736, "vf_loss": 0.09762445697560906, "vf_explained_var": 0.46612024307250977, "kl": 0.012487214902648702, "entropy": 0.585956521332264, "entropy_coeff": 0.0}}, "num_steps_sampled": 1308000, "num_steps_trained": 1308000}, "done": false, "episodes_total": 130, "training_iteration": 327, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-53-25", "timestamp": 1618145605, "time_this_iter_s": 20.269412994384766, "time_total_s": 6962.064120054245, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6962.064120054245, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 58.87931034482757, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 18.0, "episode_reward_min": 18.0, "episode_reward_mean": 18.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44380048000337724, "mean_raw_obs_processing_ms": 0.11100247964296683, "mean_inference_ms": 1.627372843336691, "mean_action_processing_ms": 0.04626023205506432}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1312000, "timers": {"sample_time_ms": 7962.402, "sample_throughput": 502.361, "learn_time_ms": 12216.962, "learn_throughput": 327.414, "update_time_ms": 3.099}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": -0.00712843012297526, "policy_loss": -0.03236200171522796, "vf_loss": 0.015220042027067393, "vf_explained_var": 0.7785589098930359, "kl": 0.012833956963731907, "entropy": 0.592115418985486, "entropy_coeff": 0.0}}, "num_steps_sampled": 1312000, "num_steps_trained": 1312000}, "done": false, "episodes_total": 131, "training_iteration": 328, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-53-46", "timestamp": 1618145626, "time_this_iter_s": 20.379324197769165, "time_total_s": 6982.443444252014, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21e8c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6982.443444252014, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 59.699999999999996, "ram_util_percent": 27.758620689655164}, "trial_id": "9be58_00000"}
{"episode_reward_max": 18.0, "episode_reward_min": 18.0, "episode_reward_mean": 18.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44380048000337724, "mean_raw_obs_processing_ms": 0.11100247964296683, "mean_inference_ms": 1.627372843336691, "mean_action_processing_ms": 0.04626023205506432}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1316000, "timers": {"sample_time_ms": 7960.451, "sample_throughput": 502.484, "learn_time_ms": 12196.044, "learn_throughput": 327.975, "update_time_ms": 3.121}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.12579378922237083, "policy_loss": -0.014064038638025522, "vf_loss": 0.13369280938059092, "vf_explained_var": 0.48021095991134644, "kl": 0.007901468605268747, "entropy": 0.3448010114952922, "entropy_coeff": 0.0}}, "num_steps_sampled": 1316000, "num_steps_trained": 1316000}, "done": false, "episodes_total": 131, "training_iteration": 329, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-54-06", "timestamp": 1618145646, "time_this_iter_s": 20.20394515991211, "time_total_s": 7002.647389411926, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21e8d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a1590>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7002.647389411926, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 59.2103448275862, "ram_util_percent": 27.78965517241379}, "trial_id": "9be58_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44223074608676594, "mean_raw_obs_processing_ms": 0.11120076515280584, "mean_inference_ms": 1.6271907687308662, "mean_action_processing_ms": 0.046253962227218295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1320000, "timers": {"sample_time_ms": 7970.012, "sample_throughput": 501.881, "learn_time_ms": 12189.005, "learn_throughput": 328.165, "update_time_ms": 3.153}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": 0.030885320156812668, "policy_loss": -0.054169964452739805, "vf_loss": 0.07027859834488481, "vf_explained_var": 0.679867684841156, "kl": 0.01893870934145525, "entropy": 0.47701406572014093, "entropy_coeff": 0.0}}, "num_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 132, "training_iteration": 330, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-54-26", "timestamp": 1618145666, "time_this_iter_s": 20.129318952560425, "time_total_s": 7022.776708364487, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a15d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7022.776708364487, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 58.06551724137931, "ram_util_percent": 27.775862068965516}, "trial_id": "9be58_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44223074608676594, "mean_raw_obs_processing_ms": 0.11120076515280584, "mean_inference_ms": 1.6271907687308662, "mean_action_processing_ms": 0.046253962227218295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1324000, "timers": {"sample_time_ms": 7983.252, "sample_throughput": 501.049, "learn_time_ms": 12192.048, "learn_throughput": 328.083, "update_time_ms": 3.144}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7802370574254724, "cur_lr": 5e-05, "total_loss": -0.01910684144240804, "policy_loss": -0.022848705673823133, "vf_loss": 0.001365169620839879, "vf_explained_var": 0.3231539726257324, "kl": 0.003046115376491798, "entropy": 0.16596399364061654, "entropy_coeff": 0.0}}, "num_steps_sampled": 1324000, "num_steps_trained": 1324000}, "done": false, "episodes_total": 132, "training_iteration": 331, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-54-46", "timestamp": 1618145686, "time_this_iter_s": 20.23725390434265, "time_total_s": 7043.013962268829, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7043.013962268829, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 59.392857142857146, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": -2.0, "episode_reward_min": -2.0, "episode_reward_mean": -2.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.44223074608676594, "mean_raw_obs_processing_ms": 0.11120076515280584, "mean_inference_ms": 1.6271907687308662, "mean_action_processing_ms": 0.046253962227218295}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1328000, "timers": {"sample_time_ms": 8013.505, "sample_throughput": 499.157, "learn_time_ms": 12190.839, "learn_throughput": 328.115, "update_time_ms": 3.132}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3901185287127362, "cur_lr": 5e-05, "total_loss": -0.007899342803284526, "policy_loss": -0.008927054397645406, "vf_loss": 0.00015237533466461173, "vf_explained_var": -0.0018884744495153427, "kl": 0.0022437728839577176, "entropy": 0.09822440100833774, "entropy_coeff": 0.0}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 132, "training_iteration": 332, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-55-07", "timestamp": 1618145707, "time_this_iter_s": 20.333243131637573, "time_total_s": 7063.347205400467, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22cac10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fc50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7063.347205400467, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 59.55666666666666, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4397044993996368, "mean_raw_obs_processing_ms": 0.11151840132956806, "mean_inference_ms": 1.6271482928460437, "mean_action_processing_ms": 0.04626661913955789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1332000, "timers": {"sample_time_ms": 8008.833, "sample_throughput": 499.449, "learn_time_ms": 12199.574, "learn_throughput": 327.88, "update_time_ms": 3.112}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1950592643563681, "cur_lr": 5e-05, "total_loss": -0.013443889853078872, "policy_loss": -0.014406558068003505, "vf_loss": 8.987595707310447e-05, "vf_explained_var": 0.5932646989822388, "kl": 0.00447448809427442, "entropy": 0.09650935349054635, "entropy_coeff": 0.0}}, "num_steps_sampled": 1332000, "num_steps_trained": 1332000}, "done": false, "episodes_total": 133, "training_iteration": 333, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-55-27", "timestamp": 1618145727, "time_this_iter_s": 20.10247802734375, "time_total_s": 7083.449683427811, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7083.449683427811, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 58.13214285714286, "ram_util_percent": 27.75714285714286}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4397044993996368, "mean_raw_obs_processing_ms": 0.11151840132956806, "mean_inference_ms": 1.6271482928460437, "mean_action_processing_ms": 0.04626661913955789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1336000, "timers": {"sample_time_ms": 7984.202, "sample_throughput": 500.989, "learn_time_ms": 12194.461, "learn_throughput": 328.018, "update_time_ms": 3.15}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09752963217818406, "cur_lr": 5e-05, "total_loss": -0.03081264509819448, "policy_loss": -0.0653968456608709, "vf_loss": 0.026055992406327277, "vf_explained_var": 0.4564025402069092, "kl": 0.08744224649854004, "entropy": 0.5533135589212179, "entropy_coeff": 0.0}}, "num_steps_sampled": 1336000, "num_steps_trained": 1336000}, "done": false, "episodes_total": 133, "training_iteration": 334, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-55-47", "timestamp": 1618145747, "time_this_iter_s": 20.015289545059204, "time_total_s": 7103.46497297287, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca890>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21e84d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7103.46497297287, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 59.09310344827586, "ram_util_percent": 27.713793103448285}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4380766060056151, "mean_raw_obs_processing_ms": 0.11172271333541026, "mean_inference_ms": 1.6270644583981488, "mean_action_processing_ms": 0.04626234324328378}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1340000, "timers": {"sample_time_ms": 7984.108, "sample_throughput": 500.995, "learn_time_ms": 12187.41, "learn_throughput": 328.208, "update_time_ms": 3.137}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.14629444826727608, "cur_lr": 5e-05, "total_loss": -0.04231694620102644, "policy_loss": -0.07234802492894232, "vf_loss": 0.009001484060718212, "vf_explained_var": 0.7940143942832947, "kl": 0.1437484121415764, "entropy": 0.43006112799048424, "entropy_coeff": 0.0}}, "num_steps_sampled": 1340000, "num_steps_trained": 1340000}, "done": false, "episodes_total": 134, "training_iteration": 335, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-56-07", "timestamp": 1618145767, "time_this_iter_s": 20.162240982055664, "time_total_s": 7123.6272139549255, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0590>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4ed0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7123.6272139549255, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 59.14137931034483, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4380766060056151, "mean_raw_obs_processing_ms": 0.11172271333541026, "mean_inference_ms": 1.6270644583981488, "mean_action_processing_ms": 0.04626234324328378}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1344000, "timers": {"sample_time_ms": 7987.302, "sample_throughput": 500.795, "learn_time_ms": 12201.643, "learn_throughput": 327.825, "update_time_ms": 2.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2194416724009141, "cur_lr": 5e-05, "total_loss": -0.04529991607705597, "policy_loss": -0.08797740377485752, "vf_loss": 0.01606676576193422, "vf_explained_var": 0.011363837867975235, "kl": 0.1212655808776617, "entropy": 0.4378234641626477, "entropy_coeff": 0.0}}, "num_steps_sampled": 1344000, "num_steps_trained": 1344000}, "done": false, "episodes_total": 134, "training_iteration": 336, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-56-27", "timestamp": 1618145787, "time_this_iter_s": 20.157909393310547, "time_total_s": 7143.785123348236, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9b50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7143.785123348236, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 59.19285714285714, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4380766060056151, "mean_raw_obs_processing_ms": 0.11172271333541026, "mean_inference_ms": 1.6270644583981488, "mean_action_processing_ms": 0.04626234324328378}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1348000, "timers": {"sample_time_ms": 7974.557, "sample_throughput": 501.595, "learn_time_ms": 12220.515, "learn_throughput": 327.318, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3291625086013712, "cur_lr": 5e-05, "total_loss": -0.004319607134675607, "policy_loss": -0.06814497752930038, "vf_loss": 0.04946465895045549, "vf_explained_var": 0.7216860055923462, "kl": 0.04362804355332628, "entropy": 0.5035681892186403, "entropy_coeff": 0.0}}, "num_steps_sampled": 1348000, "num_steps_trained": 1348000}, "done": false, "episodes_total": 134, "training_iteration": 337, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-56-48", "timestamp": 1618145808, "time_this_iter_s": 20.33189105987549, "time_total_s": 7164.117014408112, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7164.117014408112, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 59.49655172413794, "ram_util_percent": 27.793103448275854}, "trial_id": "9be58_00000"}
{"episode_reward_max": 7.0, "episode_reward_min": 7.0, "episode_reward_mean": 7.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4357406732195142, "mean_raw_obs_processing_ms": 0.1120272270186684, "mean_inference_ms": 1.6268899524227693, "mean_action_processing_ms": 0.04625702327242657}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1352000, "timers": {"sample_time_ms": 7969.895, "sample_throughput": 501.889, "learn_time_ms": 12215.467, "learn_throughput": 327.454, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.046254350629169494, "policy_loss": -0.0442566376295872, "vf_loss": 0.08132337313145399, "vf_explained_var": 0.6105692386627197, "kl": 0.018608064798172563, "entropy": 0.5375042278319597, "entropy_coeff": 0.0}}, "num_steps_sampled": 1352000, "num_steps_trained": 1352000}, "done": false, "episodes_total": 135, "training_iteration": 338, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-57-08", "timestamp": 1618145828, "time_this_iter_s": 20.280752658843994, "time_total_s": 7184.397767066956, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7184.397767066956, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 59.49310344827587, "ram_util_percent": 27.793103448275854}, "trial_id": "9be58_00000"}
{"episode_reward_max": 7.0, "episode_reward_min": 7.0, "episode_reward_mean": 7.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4357406732195142, "mean_raw_obs_processing_ms": 0.1120272270186684, "mean_inference_ms": 1.6268899524227693, "mean_action_processing_ms": 0.04625702327242657}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1356000, "timers": {"sample_time_ms": 7975.602, "sample_throughput": 501.53, "learn_time_ms": 12212.104, "learn_throughput": 327.544, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.011426833807490766, "policy_loss": -0.030648034997284412, "vf_loss": 0.03555828146636486, "vf_explained_var": 0.4811995327472687, "kl": 0.013198316941270605, "entropy": 0.47812471352517605, "entropy_coeff": 0.0}}, "num_steps_sampled": 1356000, "num_steps_trained": 1356000}, "done": false, "episodes_total": 135, "training_iteration": 339, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-57-28", "timestamp": 1618145848, "time_this_iter_s": 20.228580713272095, "time_total_s": 7204.626347780228, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fce50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7204.626347780228, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 59.141379310344824, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4341843199903421, "mean_raw_obs_processing_ms": 0.11223952388646252, "mean_inference_ms": 1.6267601282935784, "mean_action_processing_ms": 0.04625381494224755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1360000, "timers": {"sample_time_ms": 7968.61, "sample_throughput": 501.97, "learn_time_ms": 12211.607, "learn_throughput": 327.557, "update_time_ms": 3.234}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.04123557737329975, "policy_loss": -0.04606312664691359, "vf_loss": 0.07808865187689662, "vf_explained_var": 0.37567412853240967, "kl": 0.018653504113899544, "entropy": 0.4547280427068472, "entropy_coeff": 0.0}}, "num_steps_sampled": 1360000, "num_steps_trained": 1360000}, "done": false, "episodes_total": 136, "training_iteration": 340, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-57-48", "timestamp": 1618145868, "time_this_iter_s": 20.05599570274353, "time_total_s": 7224.682343482971, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222dcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338b1d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7224.682343482971, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 58.193103448275856, "ram_util_percent": 27.789655172413784}, "trial_id": "9be58_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4341843199903421, "mean_raw_obs_processing_ms": 0.11223952388646252, "mean_inference_ms": 1.6267601282935784, "mean_action_processing_ms": 0.04625381494224755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1364000, "timers": {"sample_time_ms": 7956.039, "sample_throughput": 502.763, "learn_time_ms": 12231.78, "learn_throughput": 327.017, "update_time_ms": 3.257}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.06458038638811558, "policy_loss": -0.05881507880985737, "vf_loss": 0.11728375381790102, "vf_explained_var": 0.5460268259048462, "kl": 0.012378306855680421, "entropy": 0.5515161324292421, "entropy_coeff": 0.0}}, "num_steps_sampled": 1364000, "num_steps_trained": 1364000}, "done": false, "episodes_total": 136, "training_iteration": 341, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-58-09", "timestamp": 1618145889, "time_this_iter_s": 20.31240963935852, "time_total_s": 7244.99475312233, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356c50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7244.99475312233, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 59.817241379310346, "ram_util_percent": 27.751724137931024}, "trial_id": "9be58_00000"}
{"episode_reward_max": 9.0, "episode_reward_min": 9.0, "episode_reward_mean": 9.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4341843199903421, "mean_raw_obs_processing_ms": 0.11223952388646252, "mean_inference_ms": 1.6267601282935784, "mean_action_processing_ms": 0.04625381494224755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1368000, "timers": {"sample_time_ms": 7954.677, "sample_throughput": 502.849, "learn_time_ms": 12233.586, "learn_throughput": 326.969, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4937437629020568, "cur_lr": 5e-05, "total_loss": 0.05596503691049293, "policy_loss": -0.06078286375850439, "vf_loss": 0.10641235788352787, "vf_explained_var": 0.4592352509498596, "kl": 0.020933012827299535, "entropy": 0.53712766058743, "entropy_coeff": 0.0}}, "num_steps_sampled": 1368000, "num_steps_trained": 1368000}, "done": false, "episodes_total": 136, "training_iteration": 342, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-58-29", "timestamp": 1618145909, "time_this_iter_s": 20.337830066680908, "time_total_s": 7265.332583189011, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e2d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7265.332583189011, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 59.327586206896555, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 34.0, "episode_reward_min": 34.0, "episode_reward_mean": 34.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4318461820797446, "mean_raw_obs_processing_ms": 0.11253473188632498, "mean_inference_ms": 1.6266358528461706, "mean_action_processing_ms": 0.04625283455389078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1372000, "timers": {"sample_time_ms": 7960.34, "sample_throughput": 502.491, "learn_time_ms": 12232.649, "learn_throughput": 326.994, "update_time_ms": 3.304}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 0.0554758989601396, "policy_loss": -0.04180126276332885, "vf_loss": 0.08905163174495101, "vf_explained_var": 0.7264851331710815, "kl": 0.011106340345577337, "entropy": 0.5480335131287575, "entropy_coeff": 0.0}}, "num_steps_sampled": 1372000, "num_steps_trained": 1372000}, "done": false, "episodes_total": 137, "training_iteration": 343, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-58-49", "timestamp": 1618145929, "time_this_iter_s": 20.14829182624817, "time_total_s": 7285.480875015259, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7285.480875015259, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 59.2103448275862, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 34.0, "episode_reward_min": 34.0, "episode_reward_mean": 34.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4318461820797446, "mean_raw_obs_processing_ms": 0.11253473188632498, "mean_inference_ms": 1.6266358528461706, "mean_action_processing_ms": 0.04625283455389078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1376000, "timers": {"sample_time_ms": 7962.486, "sample_throughput": 502.356, "learn_time_ms": 12228.276, "learn_throughput": 327.111, "update_time_ms": 3.29}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 0.08902619738364592, "policy_loss": -0.03441811370430514, "vf_loss": 0.11498182010836899, "vf_explained_var": 0.6594386100769043, "kl": 0.011426293203840032, "entropy": 0.5721880830824375, "entropy_coeff": 0.0}}, "num_steps_sampled": 1376000, "num_steps_trained": 1376000}, "done": false, "episodes_total": 137, "training_iteration": 344, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-59-09", "timestamp": 1618145949, "time_this_iter_s": 19.995157718658447, "time_total_s": 7305.476032733917, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f7cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22caa50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7305.476032733917, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 58.542857142857144, "ram_util_percent": 27.700000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 24.0, "episode_reward_min": 24.0, "episode_reward_mean": 24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43029250428684, "mean_raw_obs_processing_ms": 0.11274339653787767, "mean_inference_ms": 1.6265782286527242, "mean_action_processing_ms": 0.04625068557617707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1380000, "timers": {"sample_time_ms": 7963.144, "sample_throughput": 502.314, "learn_time_ms": 12254.939, "learn_throughput": 326.399, "update_time_ms": 3.346}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7406156443530851, "cur_lr": 5e-05, "total_loss": 0.03783996752463281, "policy_loss": -0.04976038431050256, "vf_loss": 0.06545401446055621, "vf_explained_var": 0.5448489189147949, "kl": 0.029902607901021838, "entropy": 0.4894451219588518, "entropy_coeff": 0.0}}, "num_steps_sampled": 1380000, "num_steps_trained": 1380000}, "done": false, "episodes_total": 138, "training_iteration": 345, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-59-30", "timestamp": 1618145970, "time_this_iter_s": 20.434829235076904, "time_total_s": 7325.910861968994, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7325.910861968994, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 59.519999999999996, "ram_util_percent": 27.73666666666666}, "trial_id": "9be58_00000"}
{"episode_reward_max": 24.0, "episode_reward_min": 24.0, "episode_reward_mean": 24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43029250428684, "mean_raw_obs_processing_ms": 0.11274339653787767, "mean_inference_ms": 1.6265782286527242, "mean_action_processing_ms": 0.04625068557617707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1384000, "timers": {"sample_time_ms": 7982.479, "sample_throughput": 501.097, "learn_time_ms": 12260.922, "learn_throughput": 326.24, "update_time_ms": 3.402}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": -0.002572793047875166, "policy_loss": -0.04074201581533998, "vf_loss": 0.03064362093573436, "vf_explained_var": 0.7710056304931641, "kl": 0.006774185996619053, "entropy": 0.48088995460420847, "entropy_coeff": 0.0}}, "num_steps_sampled": 1384000, "num_steps_trained": 1384000}, "done": false, "episodes_total": 138, "training_iteration": 346, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_12-59-50", "timestamp": 1618145990, "time_this_iter_s": 20.411405563354492, "time_total_s": 7346.322267532349, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7346.322267532349, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 59.213793103448275, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 24.0, "episode_reward_min": 24.0, "episode_reward_mean": 24.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.43029250428684, "mean_raw_obs_processing_ms": 0.11274339653787767, "mean_inference_ms": 1.6265782286527242, "mean_action_processing_ms": 0.04625068557617707}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1388000, "timers": {"sample_time_ms": 7978.443, "sample_throughput": 501.351, "learn_time_ms": 12259.469, "learn_throughput": 326.278, "update_time_ms": 3.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": -0.016414201236329973, "policy_loss": -0.028389900515321642, "vf_loss": 0.005466454167617485, "vf_explained_var": -0.007122252136468887, "kl": 0.005859309385414235, "entropy": 0.5281152119860053, "entropy_coeff": 0.0}}, "num_steps_sampled": 1388000, "num_steps_trained": 1388000}, "done": false, "episodes_total": 138, "training_iteration": 347, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-00-10", "timestamp": 1618146010, "time_this_iter_s": 20.27622652053833, "time_total_s": 7366.598494052887, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0c90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7366.598494052887, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 58.46206896551724, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 6.0, "episode_reward_min": 6.0, "episode_reward_mean": 6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.42796593133416366, "mean_raw_obs_processing_ms": 0.11305803793603991, "mean_inference_ms": 1.6265796158558012, "mean_action_processing_ms": 0.04624866155013508}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1392000, "timers": {"sample_time_ms": 7973.316, "sample_throughput": 501.673, "learn_time_ms": 12266.684, "learn_throughput": 326.086, "update_time_ms": 3.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.059936293051578104, "policy_loss": -0.032185415795538574, "vf_loss": 0.08308755583129823, "vf_explained_var": 0.7637687921524048, "kl": 0.008132115952321328, "entropy": 0.5275818994268775, "entropy_coeff": 0.0}}, "num_steps_sampled": 1392000, "num_steps_trained": 1392000}, "done": false, "episodes_total": 139, "training_iteration": 348, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-00-31", "timestamp": 1618146031, "time_this_iter_s": 20.30193567276001, "time_total_s": 7386.900429725647, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302b10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7386.900429725647, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 6.0, "episode_reward_min": 6.0, "episode_reward_mean": 6.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.42796593133416366, "mean_raw_obs_processing_ms": 0.11305803793603991, "mean_inference_ms": 1.6265796158558012, "mean_action_processing_ms": 0.04624866155013508}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1396000, "timers": {"sample_time_ms": 7977.139, "sample_throughput": 501.433, "learn_time_ms": 12264.185, "learn_throughput": 326.153, "update_time_ms": 3.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.14726577512919903, "policy_loss": -0.04342124779941514, "vf_loss": 0.1824261210858822, "vf_explained_var": 0.6766006350517273, "kl": 0.007436067870003171, "entropy": 0.5220939619466662, "entropy_coeff": 0.0}}, "num_steps_sampled": 1396000, "num_steps_trained": 1396000}, "done": false, "episodes_total": 139, "training_iteration": 349, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-00-51", "timestamp": 1618146051, "time_this_iter_s": 20.24088478088379, "time_total_s": 7407.141314506531, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338ad50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7407.141314506531, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 59.448275862068975, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 128.0, "episode_reward_min": 128.0, "episode_reward_mean": 128.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4264392448125856, "mean_raw_obs_processing_ms": 0.11327763316957783, "mean_inference_ms": 1.6266320792965487, "mean_action_processing_ms": 0.04625153609803696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1400000, "timers": {"sample_time_ms": 7993.466, "sample_throughput": 500.409, "learn_time_ms": 12275.528, "learn_throughput": 325.852, "update_time_ms": 3.394}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 1.4238020069897175, "policy_loss": -0.04406674124766141, "vf_loss": 1.4585922062397003, "vf_explained_var": 0.4841969907283783, "kl": 0.0083502965135267, "entropy": 0.5509151443839073, "entropy_coeff": 0.0}}, "num_steps_sampled": 1400000, "num_steps_trained": 1400000}, "done": false, "episodes_total": 140, "training_iteration": 350, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-01-11", "timestamp": 1618146071, "time_this_iter_s": 20.33217692375183, "time_total_s": 7427.473491430283, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7427.473491430283, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 59.841379310344834, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 128.0, "episode_reward_min": 128.0, "episode_reward_mean": 128.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4264392448125856, "mean_raw_obs_processing_ms": 0.11327763316957783, "mean_inference_ms": 1.6266320792965487, "mean_action_processing_ms": 0.04625153609803696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1404000, "timers": {"sample_time_ms": 7976.088, "sample_throughput": 501.499, "learn_time_ms": 12260.175, "learn_throughput": 326.26, "update_time_ms": 3.404}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.7761153765022755, "policy_loss": -0.04775772872380912, "vf_loss": 0.8136095451191068, "vf_explained_var": 0.5338619351387024, "kl": 0.009238770246156491, "entropy": 0.4953646305948496, "entropy_coeff": 0.0}}, "num_steps_sampled": 1404000, "num_steps_trained": 1404000}, "done": false, "episodes_total": 140, "training_iteration": 351, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-01-31", "timestamp": 1618146091, "time_this_iter_s": 19.984246969223022, "time_total_s": 7447.457738399506, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2205450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5650>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7447.457738399506, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 58.332142857142856, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 128.0, "episode_reward_min": 128.0, "episode_reward_mean": 128.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4264392448125856, "mean_raw_obs_processing_ms": 0.11327763316957783, "mean_inference_ms": 1.6266320792965487, "mean_action_processing_ms": 0.04625153609803696}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1408000, "timers": {"sample_time_ms": 7965.095, "sample_throughput": 502.191, "learn_time_ms": 12250.289, "learn_throughput": 326.523, "update_time_ms": 3.404}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.19401903776451945, "policy_loss": -0.03423618228407577, "vf_loss": 0.21907484717667103, "vf_explained_var": 0.26138216257095337, "kl": 0.008263731680926867, "entropy": 0.4062354117631912, "entropy_coeff": 0.0}}, "num_steps_sampled": 1408000, "num_steps_trained": 1408000}, "done": false, "episodes_total": 140, "training_iteration": 352, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-01-52", "timestamp": 1618146112, "time_this_iter_s": 20.12638211250305, "time_total_s": 7467.584120512009, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22056d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2205050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7467.584120512009, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 59.237931034482756, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 113.0, "episode_reward_min": 113.0, "episode_reward_mean": 113.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4242261051568955, "mean_raw_obs_processing_ms": 0.11357441479261093, "mean_inference_ms": 1.6263072733455102, "mean_action_processing_ms": 0.04623974839561019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1412000, "timers": {"sample_time_ms": 7964.046, "sample_throughput": 502.257, "learn_time_ms": 12259.058, "learn_throughput": 326.289, "update_time_ms": 3.4}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.774339584633708, "policy_loss": -0.05463404330657795, "vf_loss": 0.8202130440622568, "vf_explained_var": 0.6352502107620239, "kl": 0.007885857587098144, "entropy": 0.42894168850034475, "entropy_coeff": 0.0}}, "num_steps_sampled": 1412000, "num_steps_trained": 1412000}, "done": false, "episodes_total": 141, "training_iteration": 353, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-02-12", "timestamp": 1618146132, "time_this_iter_s": 20.224452018737793, "time_total_s": 7487.8085725307465, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c23020d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7487.8085725307465, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 59.289655172413795, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 113.0, "episode_reward_min": 113.0, "episode_reward_mean": 113.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4242261051568955, "mean_raw_obs_processing_ms": 0.11357441479261093, "mean_inference_ms": 1.6263072733455102, "mean_action_processing_ms": 0.04623974839561019}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1416000, "timers": {"sample_time_ms": 7974.949, "sample_throughput": 501.571, "learn_time_ms": 12270.832, "learn_throughput": 325.976, "update_time_ms": 3.396}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 1.9249948225915432, "policy_loss": -0.0372229726635851, "vf_loss": 1.9526986926794052, "vf_explained_var": 0.6600611805915833, "kl": 0.008568663208279759, "entropy": 0.46869244892150164, "entropy_coeff": 0.0}}, "num_steps_sampled": 1416000, "num_steps_trained": 1416000}, "done": false, "episodes_total": 141, "training_iteration": 354, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-02-32", "timestamp": 1618146152, "time_this_iter_s": 20.22009038925171, "time_total_s": 7508.028662919998, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7508.028662919998, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 58.62413793103448, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 336.0, "episode_reward_min": 336.0, "episode_reward_mean": 336.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4228108774780632, "mean_raw_obs_processing_ms": 0.11378423273636211, "mean_inference_ms": 1.6263506614978742, "mean_action_processing_ms": 0.046239043635280086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1420000, "timers": {"sample_time_ms": 7987.736, "sample_throughput": 500.768, "learn_time_ms": 12253.697, "learn_throughput": 326.432, "update_time_ms": 3.349}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 1.605539657175541, "policy_loss": -0.053468175436137244, "vf_loss": 1.6495065055787563, "vf_explained_var": 0.7584087252616882, "kl": 0.00855261982360389, "entropy": 0.4739001290872693, "entropy_coeff": 0.0}}, "num_steps_sampled": 1420000, "num_steps_trained": 1420000}, "done": false, "episodes_total": 142, "training_iteration": 355, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-02-53", "timestamp": 1618146173, "time_this_iter_s": 20.389649868011475, "time_total_s": 7528.41831278801, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3dbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7528.41831278801, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 59.341379310344834, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 336.0, "episode_reward_min": 336.0, "episode_reward_mean": 336.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4228108774780632, "mean_raw_obs_processing_ms": 0.11378423273636211, "mean_inference_ms": 1.6263506614978742, "mean_action_processing_ms": 0.046239043635280086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1424000, "timers": {"sample_time_ms": 7999.738, "sample_throughput": 500.016, "learn_time_ms": 12231.002, "learn_throughput": 327.038, "update_time_ms": 3.32}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1109234665296277, "cur_lr": 5e-05, "total_loss": 0.005399464804213494, "policy_loss": 0.0009910496009979397, "vf_loss": 0.003664973883132916, "vf_explained_var": -0.006210207939147949, "kl": 0.0006692112519885995, "entropy": 0.2960762148723006, "entropy_coeff": 0.0}}, "num_steps_sampled": 1424000, "num_steps_trained": 1424000}, "done": false, "episodes_total": 142, "training_iteration": 356, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-03-13", "timestamp": 1618146193, "time_this_iter_s": 20.299970865249634, "time_total_s": 7548.718283653259, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7548.718283653259, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 59.25172413793104, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 336.0, "episode_reward_min": 336.0, "episode_reward_mean": 336.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4228108774780632, "mean_raw_obs_processing_ms": 0.11378423273636211, "mean_inference_ms": 1.6263506614978742, "mean_action_processing_ms": 0.046239043635280086}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1428000, "timers": {"sample_time_ms": 7996.305, "sample_throughput": 500.231, "learn_time_ms": 12228.89, "learn_throughput": 327.094, "update_time_ms": 3.145}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": -0.0019429107196629047, "policy_loss": -0.02135180658660829, "vf_loss": 0.015543430708930828, "vf_explained_var": 0.4108136296272278, "kl": 0.006959010999707971, "entropy": 0.3002522885799408, "entropy_coeff": 0.0}}, "num_steps_sampled": 1428000, "num_steps_trained": 1428000}, "done": false, "episodes_total": 142, "training_iteration": 357, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-03-33", "timestamp": 1618146213, "time_this_iter_s": 20.21781635284424, "time_total_s": 7568.9361000061035, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7568.9361000061035, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 59.11034482758622, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4207799901044576, "mean_raw_obs_processing_ms": 0.11407647011809594, "mean_inference_ms": 1.6261800469810277, "mean_action_processing_ms": 0.04623266007083903}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1432000, "timers": {"sample_time_ms": 7985.014, "sample_throughput": 500.938, "learn_time_ms": 12229.015, "learn_throughput": 327.091, "update_time_ms": 3.138}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 0.2514543659053743, "policy_loss": -0.021205733297392726, "vf_loss": 0.26870440039783716, "vf_explained_var": 0.6015385389328003, "kl": 0.00712145832949318, "entropy": 0.333533201366663, "entropy_coeff": 0.0}}, "num_steps_sampled": 1432000, "num_steps_trained": 1432000}, "done": false, "episodes_total": 143, "training_iteration": 358, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-03-53", "timestamp": 1618146233, "time_this_iter_s": 20.19195580482483, "time_total_s": 7589.128055810928, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d24d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7589.128055810928, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 58.699999999999996, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4207799901044576, "mean_raw_obs_processing_ms": 0.11407647011809594, "mean_inference_ms": 1.6261800469810277, "mean_action_processing_ms": 0.04623266007083903}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1436000, "timers": {"sample_time_ms": 7992.327, "sample_throughput": 500.48, "learn_time_ms": 12236.875, "learn_throughput": 326.881, "update_time_ms": 3.12}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5554617332648139, "cur_lr": 5e-05, "total_loss": 0.6231180122122169, "policy_loss": -0.06679419183637947, "vf_loss": 0.6734740845859051, "vf_explained_var": 0.702672004699707, "kl": 0.029593583138193935, "entropy": 0.46823336463421583, "entropy_coeff": 0.0}}, "num_steps_sampled": 1436000, "num_steps_trained": 1436000}, "done": false, "episodes_total": 143, "training_iteration": 359, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-04-14", "timestamp": 1618146254, "time_this_iter_s": 20.392095804214478, "time_total_s": 7609.520151615143, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0750>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3dbd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7609.520151615143, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 59.3103448275862, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 124.0, "episode_reward_min": 124.0, "episode_reward_mean": 124.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41941894935724194, "mean_raw_obs_processing_ms": 0.11429505590130717, "mean_inference_ms": 1.6261963387724745, "mean_action_processing_ms": 0.04624043720522677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1440000, "timers": {"sample_time_ms": 7994.561, "sample_throughput": 500.34, "learn_time_ms": 12240.034, "learn_throughput": 326.796, "update_time_ms": 3.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 0.6502570463344455, "policy_loss": -0.04118119439226575, "vf_loss": 0.6844915701076388, "vf_explained_var": 0.8485686182975769, "kl": 0.00833742506802082, "entropy": 0.35189884901046753, "entropy_coeff": 0.0}}, "num_steps_sampled": 1440000, "num_steps_trained": 1440000}, "done": false, "episodes_total": 144, "training_iteration": 360, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-04-34", "timestamp": 1618146274, "time_this_iter_s": 20.388845920562744, "time_total_s": 7629.908997535706, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7629.908997535706, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 59.141379310344824, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 124.0, "episode_reward_min": 124.0, "episode_reward_mean": 124.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41941894935724194, "mean_raw_obs_processing_ms": 0.11429505590130717, "mean_inference_ms": 1.6261963387724745, "mean_action_processing_ms": 0.04624043720522677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1444000, "timers": {"sample_time_ms": 8002.575, "sample_throughput": 499.839, "learn_time_ms": 12241.23, "learn_throughput": 326.765, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 1.229419430717826, "policy_loss": -0.04411604721099138, "vf_loss": 1.2649329714477062, "vf_explained_var": 0.6966870427131653, "kl": 0.010324769289582036, "entropy": 0.5232627522200346, "entropy_coeff": 0.0}}, "num_steps_sampled": 1444000, "num_steps_trained": 1444000}, "done": false, "episodes_total": 144, "training_iteration": 361, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-04-54", "timestamp": 1618146294, "time_this_iter_s": 20.076704740524292, "time_total_s": 7649.98570227623, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d95d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7649.98570227623, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 58.3206896551724, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 124.0, "episode_reward_min": 124.0, "episode_reward_mean": 124.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41941894935724194, "mean_raw_obs_processing_ms": 0.11429505590130717, "mean_inference_ms": 1.6261963387724745, "mean_action_processing_ms": 0.04624043720522677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1448000, "timers": {"sample_time_ms": 8008.617, "sample_throughput": 499.462, "learn_time_ms": 12246.508, "learn_throughput": 326.624, "update_time_ms": 3.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 1.579181469976902, "policy_loss": -0.05105948681011796, "vf_loss": 1.622144803404808, "vf_explained_var": 0.7494494915008545, "kl": 0.00971699322690256, "entropy": 0.4757330324500799, "entropy_coeff": 0.0}}, "num_steps_sampled": 1448000, "num_steps_trained": 1448000}, "done": false, "episodes_total": 144, "training_iteration": 362, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-05-15", "timestamp": 1618146315, "time_this_iter_s": 20.24223017692566, "time_total_s": 7670.2279324531555, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22c5a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22b9390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7670.2279324531555, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 59.34137931034482, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 186.0, "episode_reward_min": 186.0, "episode_reward_mean": 186.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41738779507863977, "mean_raw_obs_processing_ms": 0.11461814298062686, "mean_inference_ms": 1.6261850382483023, "mean_action_processing_ms": 0.046240420882304144}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1452000, "timers": {"sample_time_ms": 8056.104, "sample_throughput": 496.518, "learn_time_ms": 12223.487, "learn_throughput": 327.239, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 1.7129384651780128, "policy_loss": -0.017101174220442772, "vf_loss": 1.7225225493311882, "vf_explained_var": 0.7007694840431213, "kl": 0.009022054829983972, "entropy": 0.32099298760294914, "entropy_coeff": 0.0}}, "num_steps_sampled": 1452000, "num_steps_trained": 1452000}, "done": false, "episodes_total": 145, "training_iteration": 363, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-05-35", "timestamp": 1618146335, "time_this_iter_s": 20.466866731643677, "time_total_s": 7690.694799184799, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22b9410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22c5550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7690.694799184799, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 60.03448275862069, "ram_util_percent": 27.879310344827584}, "trial_id": "9be58_00000"}
{"episode_reward_max": 186.0, "episode_reward_min": 186.0, "episode_reward_mean": 186.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41738779507863977, "mean_raw_obs_processing_ms": 0.11461814298062686, "mean_inference_ms": 1.6261850382483023, "mean_action_processing_ms": 0.046240420882304144}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1456000, "timers": {"sample_time_ms": 8048.337, "sample_throughput": 496.997, "learn_time_ms": 12229.969, "learn_throughput": 327.065, "update_time_ms": 3.025}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 0.1260611584293656, "policy_loss": -0.028157472901511937, "vf_loss": 0.14561481610871851, "vf_explained_var": 0.4789971113204956, "kl": 0.0103263214987237, "entropy": 0.2184258233755827, "entropy_coeff": 0.0}}, "num_steps_sampled": 1456000, "num_steps_trained": 1456000}, "done": false, "episodes_total": 145, "training_iteration": 364, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-05-55", "timestamp": 1618146355, "time_this_iter_s": 20.210112810134888, "time_total_s": 7710.904911994934, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22c5f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f22d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7710.904911994934, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 59.172413793103445, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 12.0, "episode_reward_min": 12.0, "episode_reward_mean": 12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41615886908740063, "mean_raw_obs_processing_ms": 0.11482123469732167, "mean_inference_ms": 1.6260549562975466, "mean_action_processing_ms": 0.04623691138638823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1460000, "timers": {"sample_time_ms": 8046.945, "sample_throughput": 497.083, "learn_time_ms": 12245.585, "learn_throughput": 326.648, "update_time_ms": 3.052}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 0.0075650320504792035, "policy_loss": -0.019254723942140117, "vf_loss": 0.021904335910221562, "vf_explained_var": -0.0735434889793396, "kl": 0.005899497842619894, "entropy": 0.18901321850717068, "entropy_coeff": 0.0}}, "num_steps_sampled": 1460000, "num_steps_trained": 1460000}, "done": false, "episodes_total": 146, "training_iteration": 365, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-06-16", "timestamp": 1618146376, "time_this_iter_s": 20.534496307373047, "time_total_s": 7731.439408302307, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7731.439408302307, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 58.60344827586207, "ram_util_percent": 27.803448275862063}, "trial_id": "9be58_00000"}
{"episode_reward_max": 12.0, "episode_reward_min": 12.0, "episode_reward_mean": 12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41615886908740063, "mean_raw_obs_processing_ms": 0.11482123469732167, "mean_inference_ms": 1.6260549562975466, "mean_action_processing_ms": 0.04623691138638823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1464000, "timers": {"sample_time_ms": 8087.69, "sample_throughput": 494.579, "learn_time_ms": 12262.577, "learn_throughput": 326.196, "update_time_ms": 3.04}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8331925998972207, "cur_lr": 5e-05, "total_loss": 0.1318592082534451, "policy_loss": -0.058797670411877334, "vf_loss": 0.1727979751303792, "vf_explained_var": 0.6194860935211182, "kl": 0.02143430642900057, "entropy": 0.23082108981907368, "entropy_coeff": 0.0}}, "num_steps_sampled": 1464000, "num_steps_trained": 1464000}, "done": false, "episodes_total": 146, "training_iteration": 366, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-06-37", "timestamp": 1618146397, "time_this_iter_s": 20.877070665359497, "time_total_s": 7752.316478967667, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33567d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7752.316478967667, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 59.470000000000006, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 12.0, "episode_reward_min": 12.0, "episode_reward_mean": 12.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41615886908740063, "mean_raw_obs_processing_ms": 0.11482123469732167, "mean_inference_ms": 1.6260549562975466, "mean_action_processing_ms": 0.04623691138638823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1468000, "timers": {"sample_time_ms": 8154.949, "sample_throughput": 490.5, "learn_time_ms": 12270.103, "learn_throughput": 325.996, "update_time_ms": 3.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": -0.007610753091285005, "policy_loss": -0.029474038601620123, "vf_loss": 0.014764181600185111, "vf_explained_var": 0.01256159134209156, "kl": 0.005680242930793611, "entropy": 0.03835363552207127, "entropy_coeff": 0.0}}, "num_steps_sampled": 1468000, "num_steps_trained": 1468000}, "done": false, "episodes_total": 146, "training_iteration": 367, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-06-58", "timestamp": 1618146418, "time_this_iter_s": 20.966549396514893, "time_total_s": 7773.2830283641815, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fcdd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68ced50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7773.2830283641815, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 60.06666666666667, "ram_util_percent": 27.85333333333333}, "trial_id": "9be58_00000"}
{"episode_reward_max": 27.0, "episode_reward_min": 27.0, "episode_reward_mean": 27.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.414356929948322, "mean_raw_obs_processing_ms": 0.11515276409593304, "mean_inference_ms": 1.626509927200705, "mean_action_processing_ms": 0.04624097730337341}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1472000, "timers": {"sample_time_ms": 8165.481, "sample_throughput": 489.867, "learn_time_ms": 12271.292, "learn_throughput": 325.964, "update_time_ms": 3.049}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 0.5642141569405794, "policy_loss": -0.0442848558886908, "vf_loss": 0.5986016001552343, "vf_explained_var": 0.6416049003601074, "kl": 0.00791926757665351, "entropy": 0.2466185661032796, "entropy_coeff": 0.0}}, "num_steps_sampled": 1472000, "num_steps_trained": 1472000}, "done": false, "episodes_total": 147, "training_iteration": 368, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-07-18", "timestamp": 1618146438, "time_this_iter_s": 20.306981325149536, "time_total_s": 7793.590009689331, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fcb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7793.590009689331, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 59.434482758620696, "ram_util_percent": 27.799999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 27.0, "episode_reward_min": 27.0, "episode_reward_mean": 27.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.414356929948322, "mean_raw_obs_processing_ms": 0.11515276409593304, "mean_inference_ms": 1.626509927200705, "mean_action_processing_ms": 0.04624097730337341}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1476000, "timers": {"sample_time_ms": 8146.599, "sample_throughput": 491.002, "learn_time_ms": 12256.792, "learn_throughput": 326.35, "update_time_ms": 3.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 1.3652928713709116, "policy_loss": -0.04220140667166561, "vf_loss": 1.3991734161973, "vf_explained_var": 0.7968242764472961, "kl": 0.0066578045225469396, "entropy": 0.38694225531071424, "entropy_coeff": 0.0}}, "num_steps_sampled": 1476000, "num_steps_trained": 1476000}, "done": false, "episodes_total": 147, "training_iteration": 369, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-07-38", "timestamp": 1618146458, "time_this_iter_s": 20.061323642730713, "time_total_s": 7813.651333332062, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222d910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fd90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7813.651333332062, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 58.30357142857143, "ram_util_percent": 27.842857142857138}, "trial_id": "9be58_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4130917913796849, "mean_raw_obs_processing_ms": 0.11535361734143164, "mean_inference_ms": 1.6264167478461087, "mean_action_processing_ms": 0.046235620665187986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1480000, "timers": {"sample_time_ms": 8149.686, "sample_throughput": 490.816, "learn_time_ms": 12259.186, "learn_throughput": 326.286, "update_time_ms": 3.08}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 1.2239200826734304, "policy_loss": -0.04156797181349248, "vf_loss": 1.25585956312716, "vf_explained_var": 0.5963642001152039, "kl": 0.007704095944063738, "entropy": 0.3915461953729391, "entropy_coeff": 0.0}}, "num_steps_sampled": 1480000, "num_steps_trained": 1480000}, "done": false, "episodes_total": 148, "training_iteration": 370, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-07-59", "timestamp": 1618146479, "time_this_iter_s": 20.43844771385193, "time_total_s": 7834.089781045914, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d5d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7834.089781045914, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 59.34, "ram_util_percent": 27.869999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4130917913796849, "mean_raw_obs_processing_ms": 0.11535361734143164, "mean_inference_ms": 1.6264167478461087, "mean_action_processing_ms": 0.046235620665187986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1484000, "timers": {"sample_time_ms": 8201.622, "sample_throughput": 487.708, "learn_time_ms": 12301.782, "learn_throughput": 325.156, "update_time_ms": 3.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 1.3115903232246637, "policy_loss": -0.03696300627780147, "vf_loss": 1.3397590890526772, "vf_explained_var": 0.5688122510910034, "kl": 0.00703658776183147, "entropy": 0.3745383573696017, "entropy_coeff": 0.0}}, "num_steps_sampled": 1484000, "num_steps_trained": 1484000}, "done": false, "episodes_total": 148, "training_iteration": 371, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-08-20", "timestamp": 1618146500, "time_this_iter_s": 21.0220148563385, "time_total_s": 7855.111795902252, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7855.111795902252, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 60.07333333333333, "ram_util_percent": 27.869999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 257.0, "episode_reward_min": 257.0, "episode_reward_mean": 257.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4130917913796849, "mean_raw_obs_processing_ms": 0.11535361734143164, "mean_inference_ms": 1.6264167478461087, "mean_action_processing_ms": 0.046235620665187986}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1488000, "timers": {"sample_time_ms": 8259.217, "sample_throughput": 484.307, "learn_time_ms": 12351.363, "learn_throughput": 323.851, "update_time_ms": 3.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 6.168883383274078, "policy_loss": -0.05315586907090619, "vf_loss": 6.211526706814766, "vf_explained_var": 0.6154001951217651, "kl": 0.00841150812630076, "entropy": 0.3879083963111043, "entropy_coeff": 0.0}}, "num_steps_sampled": 1488000, "num_steps_trained": 1488000}, "done": false, "episodes_total": 148, "training_iteration": 372, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-08-41", "timestamp": 1618146521, "time_this_iter_s": 21.31229567527771, "time_total_s": 7876.42409157753, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68c7ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68cebd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7876.42409157753, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 59.50999999999999, "ram_util_percent": 27.86999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 491.0, "episode_reward_min": 491.0, "episode_reward_mean": 491.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [491.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41121564110172204, "mean_raw_obs_processing_ms": 0.11573822241984978, "mean_inference_ms": 1.627074502357354, "mean_action_processing_ms": 0.046252300369162905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1492000, "timers": {"sample_time_ms": 8271.768, "sample_throughput": 483.573, "learn_time_ms": 12391.211, "learn_throughput": 322.809, "update_time_ms": 3.113}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 5.670903220772743, "policy_loss": -0.04423915015649982, "vf_loss": 5.704226434230804, "vf_explained_var": 0.5466488003730774, "kl": 0.008734256902243942, "entropy": 0.36490126606076956, "entropy_coeff": 0.0}}, "num_steps_sampled": 1492000, "num_steps_trained": 1492000}, "done": false, "episodes_total": 149, "training_iteration": 373, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-09-02", "timestamp": 1618146542, "time_this_iter_s": 20.994044542312622, "time_total_s": 7897.4181361198425, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ebd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33a0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7897.4181361198425, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 59.61, "ram_util_percent": 27.896666666666658}, "trial_id": "9be58_00000"}
{"episode_reward_max": 491.0, "episode_reward_min": 491.0, "episode_reward_mean": 491.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [491.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41121564110172204, "mean_raw_obs_processing_ms": 0.11573822241984978, "mean_inference_ms": 1.627074502357354, "mean_action_processing_ms": 0.046252300369162905}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1496000, "timers": {"sample_time_ms": 8340.253, "sample_throughput": 479.602, "learn_time_ms": 12440.99, "learn_throughput": 321.518, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 7.095111832022667, "policy_loss": -0.04712847538758069, "vf_loss": 7.133892014622688, "vf_explained_var": 0.28273600339889526, "kl": 0.006679703379631974, "entropy": 0.3699794393032789, "entropy_coeff": 0.0}}, "num_steps_sampled": 1496000, "num_steps_trained": 1496000}, "done": false, "episodes_total": 149, "training_iteration": 374, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-09-23", "timestamp": 1618146563, "time_this_iter_s": 21.39335608482361, "time_total_s": 7918.811492204666, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7918.811492204666, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 59.4516129032258, "ram_util_percent": 27.86451612903225}, "trial_id": "9be58_00000"}
{"episode_reward_max": 694.0, "episode_reward_min": 694.0, "episode_reward_mean": 694.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [694.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41002130734856773, "mean_raw_obs_processing_ms": 0.11600196750203509, "mean_inference_ms": 1.6275898821184231, "mean_action_processing_ms": 0.04626813506084697}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1500000, "timers": {"sample_time_ms": 8378.093, "sample_throughput": 477.436, "learn_time_ms": 12481.079, "learn_throughput": 320.485, "update_time_ms": 3.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.249788899845831, "cur_lr": 5e-05, "total_loss": 4.723052442073822, "policy_loss": -0.026600908837281168, "vf_loss": 4.743868514895439, "vf_explained_var": 0.5881316661834717, "kl": 0.004628695925930515, "entropy": 0.17905213730409741, "entropy_coeff": 0.0}}, "num_steps_sampled": 1500000, "num_steps_trained": 1500000}, "done": false, "episodes_total": 150, "training_iteration": 375, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-09-45", "timestamp": 1618146585, "time_this_iter_s": 21.317429542541504, "time_total_s": 7940.128921747208, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e41d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7940.128921747208, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 59.03333333333333, "ram_util_percent": 27.883333333333326}, "trial_id": "9be58_00000"}
{"episode_reward_max": 694.0, "episode_reward_min": 694.0, "episode_reward_mean": 694.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [694.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41002130734856773, "mean_raw_obs_processing_ms": 0.11600196750203509, "mean_inference_ms": 1.6275898821184231, "mean_action_processing_ms": 0.04626813506084697}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1504000, "timers": {"sample_time_ms": 8401.029, "sample_throughput": 476.132, "learn_time_ms": 12493.843, "learn_throughput": 320.158, "update_time_ms": 3.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 5.756506323814392, "policy_loss": -0.05782726337201893, "vf_loss": 5.804806277155876, "vf_explained_var": 0.6242315769195557, "kl": 0.015246212511556223, "entropy": 0.38826240599155426, "entropy_coeff": 0.0}}, "num_steps_sampled": 1504000, "num_steps_trained": 1504000}, "done": false, "episodes_total": 150, "training_iteration": 376, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-10-06", "timestamp": 1618146606, "time_this_iter_s": 21.237566709518433, "time_total_s": 7961.366488456726, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7961.366488456726, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 59.61, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 694.0, "episode_reward_min": 694.0, "episode_reward_mean": 694.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [694.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.41002130734856773, "mean_raw_obs_processing_ms": 0.11600196750203509, "mean_inference_ms": 1.6275898821184231, "mean_action_processing_ms": 0.04626813506084697}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1508000, "timers": {"sample_time_ms": 8380.769, "sample_throughput": 477.283, "learn_time_ms": 12486.664, "learn_throughput": 320.342, "update_time_ms": 3.107}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 4.488953553140163, "policy_loss": -0.03896057786187157, "vf_loss": 4.520422242581844, "vf_explained_var": 0.643163800239563, "kl": 0.011989057456958108, "entropy": 0.34919906221330166, "entropy_coeff": 0.0}}, "num_steps_sampled": 1508000, "num_steps_trained": 1508000}, "done": false, "episodes_total": 150, "training_iteration": 377, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-10-27", "timestamp": 1618146627, "time_this_iter_s": 20.69278359413147, "time_total_s": 7982.0592720508575, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280f50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d2a10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7982.0592720508575, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 59.339999999999996, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 465.0, "episode_reward_min": 465.0, "episode_reward_mean": 465.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [465.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4082920293484901, "mean_raw_obs_processing_ms": 0.11637900665182709, "mean_inference_ms": 1.6281470274888032, "mean_action_processing_ms": 0.04628651054768077}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1512000, "timers": {"sample_time_ms": 8405.427, "sample_throughput": 475.883, "learn_time_ms": 12480.917, "learn_throughput": 320.489, "update_time_ms": 3.168}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 2.271795980632305, "policy_loss": -0.0369834930752404, "vf_loss": 2.2970045059919357, "vf_explained_var": 0.5691056251525879, "kl": 0.01884310328750871, "entropy": 0.3268554573878646, "entropy_coeff": 0.0}}, "num_steps_sampled": 1512000, "num_steps_trained": 1512000}, "done": false, "episodes_total": 151, "training_iteration": 378, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-10-47", "timestamp": 1618146647, "time_this_iter_s": 20.495137453079224, "time_total_s": 8002.554409503937, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2d90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bcd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8002.554409503937, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 59.482758620689665, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 465.0, "episode_reward_min": 465.0, "episode_reward_mean": 465.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [465.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4082920293484901, "mean_raw_obs_processing_ms": 0.11637900665182709, "mean_inference_ms": 1.6281470274888032, "mean_action_processing_ms": 0.04628651054768077}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1516000, "timers": {"sample_time_ms": 8434.383, "sample_throughput": 474.249, "learn_time_ms": 12507.924, "learn_throughput": 319.797, "update_time_ms": 3.148}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 1.3201246745884418, "policy_loss": -0.025556084234267473, "vf_loss": 1.3356417957693338, "vf_explained_var": 0.5075183510780334, "kl": 0.01606507715769112, "entropy": 0.3657951997593045, "entropy_coeff": 0.0}}, "num_steps_sampled": 1516000, "num_steps_trained": 1516000}, "done": false, "episodes_total": 151, "training_iteration": 379, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-11-08", "timestamp": 1618146668, "time_this_iter_s": 20.620155334472656, "time_total_s": 8023.174564838409, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8023.174564838409, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 59.35, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 348.0, "episode_reward_min": 348.0, "episode_reward_mean": 348.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4071504118077691, "mean_raw_obs_processing_ms": 0.11659052983457703, "mean_inference_ms": 1.6281149991547978, "mean_action_processing_ms": 0.046286451324122846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1520000, "timers": {"sample_time_ms": 8428.994, "sample_throughput": 474.552, "learn_time_ms": 12495.377, "learn_throughput": 320.118, "update_time_ms": 3.12}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6248944499229155, "cur_lr": 5e-05, "total_loss": 5.30800898373127, "policy_loss": -0.06002538313623518, "vf_loss": 5.351941287517548, "vf_explained_var": 0.5579599738121033, "kl": 0.0257532783143688, "entropy": 0.36267929803580046, "entropy_coeff": 0.0}}, "num_steps_sampled": 1520000, "num_steps_trained": 1520000}, "done": false, "episodes_total": 152, "training_iteration": 380, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-11-28", "timestamp": 1618146688, "time_this_iter_s": 20.25922203063965, "time_total_s": 8043.433786869049, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c349bcd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8043.433786869049, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 58.23448275862069, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 348.0, "episode_reward_min": 348.0, "episode_reward_mean": 348.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4071504118077691, "mean_raw_obs_processing_ms": 0.11659052983457703, "mean_inference_ms": 1.6281149991547978, "mean_action_processing_ms": 0.046286451324122846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1524000, "timers": {"sample_time_ms": 8422.31, "sample_throughput": 474.929, "learn_time_ms": 12460.412, "learn_throughput": 321.017, "update_time_ms": 3.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 5.609958678483963, "policy_loss": -0.04415096458978951, "vf_loss": 5.644043803215027, "vf_explained_var": 0.5856429934501648, "kl": 0.010738699173089117, "entropy": 0.3453024923801422, "entropy_coeff": 0.0}}, "num_steps_sampled": 1524000, "num_steps_trained": 1524000}, "done": false, "episodes_total": 152, "training_iteration": 381, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-11-49", "timestamp": 1618146709, "time_this_iter_s": 20.605583667755127, "time_total_s": 8064.039370536804, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33a0c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8064.039370536804, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 60.05517241379311, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 348.0, "episode_reward_min": 348.0, "episode_reward_mean": 348.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4071504118077691, "mean_raw_obs_processing_ms": 0.11659052983457703, "mean_inference_ms": 1.6281149991547978, "mean_action_processing_ms": 0.046286451324122846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1528000, "timers": {"sample_time_ms": 8403.464, "sample_throughput": 475.994, "learn_time_ms": 12406.88, "learn_throughput": 322.402, "update_time_ms": 3.176}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 5.860955521464348, "policy_loss": -0.0408645179704763, "vf_loss": 5.89319808781147, "vf_explained_var": 0.592284619808197, "kl": 0.009198322761221789, "entropy": 0.33096829429268837, "entropy_coeff": 0.0}}, "num_steps_sampled": 1528000, "num_steps_trained": 1528000}, "done": false, "episodes_total": 152, "training_iteration": 382, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-12-10", "timestamp": 1618146730, "time_this_iter_s": 20.58792805671692, "time_total_s": 8084.627298593521, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338aad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8084.627298593521, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 59.476666666666674, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 453.0, "episode_reward_min": 453.0, "episode_reward_mean": 453.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4054072895496047, "mean_raw_obs_processing_ms": 0.1169228962429243, "mean_inference_ms": 1.628302978847155, "mean_action_processing_ms": 0.046294050619539694}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1532000, "timers": {"sample_time_ms": 8360.843, "sample_throughput": 478.421, "learn_time_ms": 12380.345, "learn_throughput": 323.093, "update_time_ms": 3.139}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 1.9628820829093456, "policy_loss": -0.024528561043553054, "vf_loss": 1.9798523895442486, "vf_explained_var": 0.6691959500312805, "kl": 0.008063514294917695, "entropy": 0.3570100134238601, "entropy_coeff": 0.0}}, "num_steps_sampled": 1532000, "num_steps_trained": 1532000}, "done": false, "episodes_total": 153, "training_iteration": 383, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-12-30", "timestamp": 1618146750, "time_this_iter_s": 20.299214363098145, "time_total_s": 8104.926512956619, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222de50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8104.926512956619, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 59.08275862068965, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 453.0, "episode_reward_min": 453.0, "episode_reward_mean": 453.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4054072895496047, "mean_raw_obs_processing_ms": 0.1169228962429243, "mean_inference_ms": 1.628302978847155, "mean_action_processing_ms": 0.046294050619539694}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1536000, "timers": {"sample_time_ms": 8294.087, "sample_throughput": 482.271, "learn_time_ms": 12316.893, "learn_throughput": 324.757, "update_time_ms": 3.118}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 3.5580525919795036, "policy_loss": -0.04864821466617286, "vf_loss": 3.596580609679222, "vf_explained_var": 0.5111156702041626, "kl": 0.010796684990054928, "entropy": 0.3794145416468382, "entropy_coeff": 0.0}}, "num_steps_sampled": 1536000, "num_steps_trained": 1536000}, "done": false, "episodes_total": 153, "training_iteration": 384, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-12-50", "timestamp": 1618146770, "time_this_iter_s": 20.091294050216675, "time_total_s": 8125.017807006836, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222dfd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c23027d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8125.017807006836, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 58.42142857142857, "ram_util_percent": 27.899999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 340.0, "episode_reward_min": 340.0, "episode_reward_mean": 340.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40438435106913745, "mean_raw_obs_processing_ms": 0.11711830779642457, "mean_inference_ms": 1.6281521527852196, "mean_action_processing_ms": 0.04628947305182018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1540000, "timers": {"sample_time_ms": 8266.221, "sample_throughput": 483.897, "learn_time_ms": 12262.962, "learn_throughput": 326.185, "update_time_ms": 3.015}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 3.0597737953066826, "policy_loss": -0.03699262969894335, "vf_loss": 3.0827952288091183, "vf_explained_var": 0.49247345328330994, "kl": 0.014905071584507823, "entropy": 0.2900512586347759, "entropy_coeff": 0.0}}, "num_steps_sampled": 1540000, "num_steps_trained": 1540000}, "done": false, "episodes_total": 154, "training_iteration": 385, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-13-11", "timestamp": 1618146791, "time_this_iter_s": 20.493011236190796, "time_total_s": 8145.510818243027, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d03d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8145.510818243027, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 59.989655172413784, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 340.0, "episode_reward_min": 340.0, "episode_reward_mean": 340.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40438435106913745, "mean_raw_obs_processing_ms": 0.11711830779642457, "mean_inference_ms": 1.6281521527852196, "mean_action_processing_ms": 0.04628947305182018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1544000, "timers": {"sample_time_ms": 8183.939, "sample_throughput": 488.762, "learn_time_ms": 12245.116, "learn_throughput": 326.661, "update_time_ms": 3.007}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 2.4505481012165546, "policy_loss": -0.03259719378547743, "vf_loss": 2.477683451026678, "vf_explained_var": 0.5668930411338806, "kl": 0.005826960470585618, "entropy": 0.1377636690158397, "entropy_coeff": 0.0}}, "num_steps_sampled": 1544000, "num_steps_trained": 1544000}, "done": false, "episodes_total": 154, "training_iteration": 386, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-13-31", "timestamp": 1618146811, "time_this_iter_s": 20.233185529708862, "time_total_s": 8165.744003772736, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4e6d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a1c10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8165.744003772736, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 59.017241379310335, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 340.0, "episode_reward_min": 340.0, "episode_reward_mean": 340.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40438435106913745, "mean_raw_obs_processing_ms": 0.11711830779642457, "mean_inference_ms": 1.6281521527852196, "mean_action_processing_ms": 0.04628947305182018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1548000, "timers": {"sample_time_ms": 8156.784, "sample_throughput": 490.389, "learn_time_ms": 12228.189, "learn_throughput": 327.113, "update_time_ms": 3.022}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 1.2788675781339407, "policy_loss": -0.023322154418565333, "vf_loss": 1.2969526667147875, "vf_explained_var": 0.577684760093689, "kl": 0.005587132662185468, "entropy": 0.12634054408408701, "entropy_coeff": 0.0}}, "num_steps_sampled": 1548000, "num_steps_trained": 1548000}, "done": false, "episodes_total": 154, "training_iteration": 387, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-13-51", "timestamp": 1618146831, "time_this_iter_s": 20.253119468688965, "time_total_s": 8185.997123241425, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a3d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8185.997123241425, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 58.45172413793104, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 215.0, "episode_reward_min": 215.0, "episode_reward_mean": 215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40286259971816923, "mean_raw_obs_processing_ms": 0.1174222038111092, "mean_inference_ms": 1.6279362080546769, "mean_action_processing_ms": 0.04628218170884653}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1552000, "timers": {"sample_time_ms": 8155.397, "sample_throughput": 490.473, "learn_time_ms": 12219.158, "learn_throughput": 327.355, "update_time_ms": 2.997}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 4.643336735665798, "policy_loss": -0.04523160413373262, "vf_loss": 4.674358859658241, "vf_explained_var": 0.623629093170166, "kl": 0.015159365022554994, "entropy": 0.27127467282116413, "entropy_coeff": 0.0}}, "num_steps_sampled": 1552000, "num_steps_trained": 1552000}, "done": false, "episodes_total": 155, "training_iteration": 388, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-14-11", "timestamp": 1618146851, "time_this_iter_s": 20.3936984539032, "time_total_s": 8206.390821695328, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8206.390821695328, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 59.33793103448276, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 215.0, "episode_reward_min": 215.0, "episode_reward_mean": 215.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40286259971816923, "mean_raw_obs_processing_ms": 0.1174222038111092, "mean_inference_ms": 1.6279362080546769, "mean_action_processing_ms": 0.04628218170884653}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1556000, "timers": {"sample_time_ms": 8151.428, "sample_throughput": 490.712, "learn_time_ms": 12196.038, "learn_throughput": 327.975, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9373416748843733, "cur_lr": 5e-05, "total_loss": 0.27217303263023496, "policy_loss": -0.0008375938632525504, "vf_loss": 0.26997597329318523, "vf_explained_var": -0.005498487502336502, "kl": 0.003237507538869977, "entropy": 0.12493888521566987, "entropy_coeff": 0.0}}, "num_steps_sampled": 1556000, "num_steps_trained": 1556000}, "done": false, "episodes_total": 155, "training_iteration": 389, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-14-32", "timestamp": 1618146872, "time_this_iter_s": 20.347137451171875, "time_total_s": 8226.7379591465, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8226.7379591465, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 59.648275862068964, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 206.0, "episode_reward_min": 206.0, "episode_reward_mean": 206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4018779336491877, "mean_raw_obs_processing_ms": 0.11761717424603847, "mean_inference_ms": 1.6276936410265168, "mean_action_processing_ms": 0.046275295646884866}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1560000, "timers": {"sample_time_ms": 8135.182, "sample_throughput": 491.691, "learn_time_ms": 12200.659, "learn_throughput": 327.851, "update_time_ms": 3.461}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4686708374421866, "cur_lr": 5e-05, "total_loss": 4.216440454125404, "policy_loss": -0.050026100827381015, "vf_loss": 4.25722349435091, "vf_explained_var": 0.6192222833633423, "kl": 0.019722031895071268, "entropy": 0.2933829794637859, "entropy_coeff": 0.0}}, "num_steps_sampled": 1560000, "num_steps_trained": 1560000}, "done": false, "episodes_total": 156, "training_iteration": 390, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-14-52", "timestamp": 1618146892, "time_this_iter_s": 20.14568781852722, "time_total_s": 8246.883646965027, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d20d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e55d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8246.883646965027, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 58.468965517241365, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 206.0, "episode_reward_min": 206.0, "episode_reward_mean": 206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4018779336491877, "mean_raw_obs_processing_ms": 0.11761717424603847, "mean_inference_ms": 1.6276936410265168, "mean_action_processing_ms": 0.046275295646884866}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1564000, "timers": {"sample_time_ms": 8115.511, "sample_throughput": 492.883, "learn_time_ms": 12184.567, "learn_throughput": 328.284, "update_time_ms": 3.456}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4686708374421866, "cur_lr": 5e-05, "total_loss": 2.675387967377901, "policy_loss": -0.07267734708148055, "vf_loss": 2.7193149738013744, "vf_explained_var": 0.6547508239746094, "kl": 0.061344453948549926, "entropy": 0.3140534283593297, "entropy_coeff": 0.0}}, "num_steps_sampled": 1564000, "num_steps_trained": 1564000}, "done": false, "episodes_total": 156, "training_iteration": 391, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-15-12", "timestamp": 1618146912, "time_this_iter_s": 20.24781107902527, "time_total_s": 8267.131458044052, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22cae90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8267.131458044052, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 59.28275862068965, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 206.0, "episode_reward_min": 206.0, "episode_reward_mean": 206.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.4018779336491877, "mean_raw_obs_processing_ms": 0.11761717424603847, "mean_inference_ms": 1.6276936410265168, "mean_action_processing_ms": 0.046275295646884866}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1568000, "timers": {"sample_time_ms": 8091.88, "sample_throughput": 494.323, "learn_time_ms": 12177.005, "learn_throughput": 328.488, "update_time_ms": 3.448}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 2.4055971913039684, "policy_loss": -0.04098665883066133, "vf_loss": 2.4335307218134403, "vf_explained_var": 0.5092763304710388, "kl": 0.018567634921055287, "entropy": 0.23275607824325562, "entropy_coeff": 0.0}}, "num_steps_sampled": 1568000, "num_steps_trained": 1568000}, "done": false, "episodes_total": 156, "training_iteration": 392, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-15-33", "timestamp": 1618146933, "time_this_iter_s": 20.276416540145874, "time_total_s": 8287.407874584198, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca8d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8287.407874584198, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 59.148275862068964, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 293.0, "episode_reward_min": 293.0, "episode_reward_mean": 293.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40044693127901415, "mean_raw_obs_processing_ms": 0.11792103303955095, "mean_inference_ms": 1.6274754416962685, "mean_action_processing_ms": 0.04626616099191014}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1572000, "timers": {"sample_time_ms": 8102.288, "sample_throughput": 493.688, "learn_time_ms": 12166.268, "learn_throughput": 328.778, "update_time_ms": 3.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 2.2163368314504623, "policy_loss": -0.026688490237575024, "vf_loss": 2.2371577955782413, "vf_explained_var": 0.41344600915908813, "kl": 0.00834636298532132, "entropy": 0.1935635143890977, "entropy_coeff": 0.0}}, "num_steps_sampled": 1572000, "num_steps_trained": 1572000}, "done": false, "episodes_total": 157, "training_iteration": 393, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-15-53", "timestamp": 1618146953, "time_this_iter_s": 20.297308683395386, "time_total_s": 8307.705183267593, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d00d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8307.705183267593, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 59.227586206896554, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 293.0, "episode_reward_min": 293.0, "episode_reward_mean": 293.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.40044693127901415, "mean_raw_obs_processing_ms": 0.11792103303955095, "mean_inference_ms": 1.6274754416962685, "mean_action_processing_ms": 0.04626616099191014}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1576000, "timers": {"sample_time_ms": 8118.3, "sample_throughput": 492.714, "learn_time_ms": 12163.594, "learn_throughput": 328.85, "update_time_ms": 3.473}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7030062561632799, "cur_lr": 5e-05, "total_loss": 1.4223509225994349, "policy_loss": -0.03526968343066983, "vf_loss": 1.436995616182685, "vf_explained_var": 0.4739532470703125, "kl": 0.029338324355194345, "entropy": 0.2766861501149833, "entropy_coeff": 0.0}}, "num_steps_sampled": 1576000, "num_steps_trained": 1576000}, "done": false, "episodes_total": 157, "training_iteration": 394, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-16-13", "timestamp": 1618146973, "time_this_iter_s": 20.22289228439331, "time_total_s": 8327.928075551987, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8327.928075551987, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 59.065517241379304, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 69.0, "episode_reward_min": 69.0, "episode_reward_mean": 69.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3994141564694546, "mean_raw_obs_processing_ms": 0.11813402349586619, "mean_inference_ms": 1.6273834578989508, "mean_action_processing_ms": 0.04626403759620794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1580000, "timers": {"sample_time_ms": 8105.138, "sample_throughput": 493.514, "learn_time_ms": 12148.112, "learn_throughput": 329.269, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0545093842449198, "cur_lr": 5e-05, "total_loss": 0.17918376601301134, "policy_loss": 0.002190250379499048, "vf_loss": 0.17486804397776723, "vf_explained_var": -0.015183448791503906, "kl": 0.0020156039390712976, "entropy": 0.2530796183273196, "entropy_coeff": 0.0}}, "num_steps_sampled": 1580000, "num_steps_trained": 1580000}, "done": false, "episodes_total": 158, "training_iteration": 395, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-16-33", "timestamp": 1618146993, "time_this_iter_s": 20.208809852600098, "time_total_s": 8348.136885404587, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0d10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fcf10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8348.136885404587, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 59.23448275862069, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 69.0, "episode_reward_min": 69.0, "episode_reward_mean": 69.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3994141564694546, "mean_raw_obs_processing_ms": 0.11813402349586619, "mean_inference_ms": 1.6273834578989508, "mean_action_processing_ms": 0.04626403759620794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1584000, "timers": {"sample_time_ms": 8117.093, "sample_throughput": 492.787, "learn_time_ms": 12159.291, "learn_throughput": 328.967, "update_time_ms": 3.468}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 0.7093737870454788, "policy_loss": -0.029822883487213403, "vf_loss": 0.7339813131839037, "vf_explained_var": 0.738597571849823, "kl": 0.009891527006402612, "entropy": 0.2697509750723839, "entropy_coeff": 0.0}}, "num_steps_sampled": 1584000, "num_steps_trained": 1584000}, "done": false, "episodes_total": 158, "training_iteration": 396, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-16-54", "timestamp": 1618147014, "time_this_iter_s": 20.468819618225098, "time_total_s": 8368.605705022812, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3da50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8368.605705022812, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 60.14137931034483, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 69.0, "episode_reward_min": 69.0, "episode_reward_mean": 69.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3994141564694546, "mean_raw_obs_processing_ms": 0.11813402349586619, "mean_inference_ms": 1.6273834578989508, "mean_action_processing_ms": 0.04626403759620794}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1588000, "timers": {"sample_time_ms": 8097.87, "sample_throughput": 493.957, "learn_time_ms": 12150.352, "learn_throughput": 329.209, "update_time_ms": 3.44}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 0.27999846637248993, "policy_loss": -0.023574806342367083, "vf_loss": 0.2961449106223881, "vf_explained_var": 0.3187941014766693, "kl": 0.01408875422202982, "entropy": 0.08004321984481066, "entropy_coeff": 0.0}}, "num_steps_sampled": 1588000, "num_steps_trained": 1588000}, "done": false, "episodes_total": 158, "training_iteration": 397, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-17-14", "timestamp": 1618147034, "time_this_iter_s": 19.97093629837036, "time_total_s": 8388.576641321182, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f44d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4db90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8388.576641321182, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 58.40344827586207, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 98.0, "episode_reward_min": 98.0, "episode_reward_mean": 98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3978725977581008, "mean_raw_obs_processing_ms": 0.11844746733959505, "mean_inference_ms": 1.627328666683547, "mean_action_processing_ms": 0.046260647433604044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1592000, "timers": {"sample_time_ms": 8117.827, "sample_throughput": 492.743, "learn_time_ms": 12170.743, "learn_throughput": 328.657, "update_time_ms": 3.437}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5272546921224599, "cur_lr": 5e-05, "total_loss": 3.174915701150894, "policy_loss": -0.030130522092804313, "vf_loss": 3.193980745971203, "vf_explained_var": 0.3427063226699829, "kl": 0.020986972929676995, "entropy": 0.2326552220620215, "entropy_coeff": 0.0}}, "num_steps_sampled": 1592000, "num_steps_trained": 1592000}, "done": false, "episodes_total": 159, "training_iteration": 398, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-17-35", "timestamp": 1618147055, "time_this_iter_s": 20.79473853111267, "time_total_s": 8409.371379852295, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f4110>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3dfd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8409.371379852295, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 59.779310344827586, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 98.0, "episode_reward_min": 98.0, "episode_reward_mean": 98.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3978725977581008, "mean_raw_obs_processing_ms": 0.11844746733959505, "mean_inference_ms": 1.627328666683547, "mean_action_processing_ms": 0.046260647433604044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1596000, "timers": {"sample_time_ms": 8142.115, "sample_throughput": 491.273, "learn_time_ms": 12200.051, "learn_throughput": 327.867, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7908820381836899, "cur_lr": 5e-05, "total_loss": 5.300859346985817, "policy_loss": -0.052437874663155526, "vf_loss": 5.321673937141895, "vf_explained_var": 0.7504004240036011, "kl": 0.0399847985827364, "entropy": 0.24065364617854357, "entropy_coeff": 0.0}}, "num_steps_sampled": 1596000, "num_steps_trained": 1596000}, "done": false, "episodes_total": 159, "training_iteration": 399, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-17-56", "timestamp": 1618147076, "time_this_iter_s": 20.8854877948761, "time_total_s": 8430.256867647171, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302e10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4710>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8430.256867647171, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 59.97333333333333, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 478.0, "episode_reward_min": 478.0, "episode_reward_mean": 478.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39677979138269037, "mean_raw_obs_processing_ms": 0.11869223761091725, "mean_inference_ms": 1.627609101878499, "mean_action_processing_ms": 0.04626653893948655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1600000, "timers": {"sample_time_ms": 8186.997, "sample_throughput": 488.58, "learn_time_ms": 12191.38, "learn_throughput": 328.101, "update_time_ms": 2.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1863230572755348, "cur_lr": 5e-05, "total_loss": 3.0725925639271736, "policy_loss": -0.015305038075894117, "vf_loss": 3.082029826939106, "vf_explained_var": 0.8230603933334351, "kl": 0.004946188826579601, "entropy": 0.21832331037148833, "entropy_coeff": 0.0}}, "num_steps_sampled": 1600000, "num_steps_trained": 1600000}, "done": false, "episodes_total": 160, "training_iteration": 400, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-18-16", "timestamp": 1618147096, "time_this_iter_s": 20.50710892677307, "time_total_s": 8450.763976573944, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4d7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f7d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8450.763976573944, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 59.44137931034483, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 478.0, "episode_reward_min": 478.0, "episode_reward_mean": 478.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39677979138269037, "mean_raw_obs_processing_ms": 0.11869223761091725, "mean_inference_ms": 1.627609101878499, "mean_action_processing_ms": 0.04626653893948655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1604000, "timers": {"sample_time_ms": 8152.514, "sample_throughput": 490.646, "learn_time_ms": 12204.677, "learn_throughput": 327.743, "update_time_ms": 3.13}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5931615286377674, "cur_lr": 5e-05, "total_loss": 1.5643732137978077, "policy_loss": -0.032756809174316004, "vf_loss": 1.5843662917613983, "vf_explained_var": 0.6813607811927795, "kl": 0.02151814117678441, "entropy": 0.32932820450514555, "entropy_coeff": 0.0}}, "num_steps_sampled": 1604000, "num_steps_trained": 1604000}, "done": false, "episodes_total": 160, "training_iteration": 401, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-18-36", "timestamp": 1618147116, "time_this_iter_s": 20.040472507476807, "time_total_s": 8470.80444908142, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8470.80444908142, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 58.32758620689657, "ram_util_percent": 27.9103448275862}, "trial_id": "9be58_00000"}
{"episode_reward_max": 478.0, "episode_reward_min": 478.0, "episode_reward_mean": 478.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39677979138269037, "mean_raw_obs_processing_ms": 0.11869223761091725, "mean_inference_ms": 1.627609101878499, "mean_action_processing_ms": 0.04626653893948655}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1608000, "timers": {"sample_time_ms": 8154.341, "sample_throughput": 490.536, "learn_time_ms": 12239.451, "learn_throughput": 326.812, "update_time_ms": 3.178}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.991172045469284, "policy_loss": -0.04121245030546561, "vf_loss": 7.023440405726433, "vf_explained_var": 0.5413081049919128, "kl": 0.010052455414552242, "entropy": 0.23636941891163588, "entropy_coeff": 0.0}}, "num_steps_sampled": 1608000, "num_steps_trained": 1608000}, "done": false, "episodes_total": 160, "training_iteration": 402, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-18-57", "timestamp": 1618147137, "time_this_iter_s": 20.645768404006958, "time_total_s": 8491.450217485428, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8491.450217485428, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 60.03666666666666, "ram_util_percent": 27.95}, "trial_id": "9be58_00000"}
{"episode_reward_max": 551.0, "episode_reward_min": 551.0, "episode_reward_mean": 551.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3951411308866538, "mean_raw_obs_processing_ms": 0.11900131354443114, "mean_inference_ms": 1.6276027884641762, "mean_action_processing_ms": 0.046262503699835665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1612000, "timers": {"sample_time_ms": 8179.333, "sample_throughput": 489.037, "learn_time_ms": 12247.744, "learn_throughput": 326.591, "update_time_ms": 3.169}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.134520053863525, "policy_loss": -0.03218825423391536, "vf_loss": 6.149951219558716, "vf_explained_var": 0.6993303298950195, "kl": 0.01883373360033147, "entropy": 0.1638060389086604, "entropy_coeff": 0.0}}, "num_steps_sampled": 1612000, "num_steps_trained": 1612000}, "done": false, "episodes_total": 161, "training_iteration": 403, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-19-18", "timestamp": 1618147158, "time_this_iter_s": 20.629068613052368, "time_total_s": 8512.07928609848, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c3356a90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8512.07928609848, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 59.68275862068966, "ram_util_percent": 27.94482758620689}, "trial_id": "9be58_00000"}
{"episode_reward_max": 551.0, "episode_reward_min": 551.0, "episode_reward_mean": 551.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [551.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3951411308866538, "mean_raw_obs_processing_ms": 0.11900131354443114, "mean_inference_ms": 1.6276027884641762, "mean_action_processing_ms": 0.046262503699835665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1616000, "timers": {"sample_time_ms": 8171.402, "sample_throughput": 489.512, "learn_time_ms": 12260.683, "learn_throughput": 326.246, "update_time_ms": 3.211}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 6.794881850481033, "policy_loss": -0.022746051661670208, "vf_loss": 6.81150496006012, "vf_explained_var": 0.5491490364074707, "kl": 0.0068816215061815456, "entropy": 0.20632513659074903, "entropy_coeff": 0.0}}, "num_steps_sampled": 1616000, "num_steps_trained": 1616000}, "done": false, "episodes_total": 161, "training_iteration": 404, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-19-38", "timestamp": 1618147178, "time_this_iter_s": 20.27256989479065, "time_total_s": 8532.35185599327, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5e10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8532.35185599327, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 59.41034482758621, "ram_util_percent": 27.92068965517241}, "trial_id": "9be58_00000"}
{"episode_reward_max": 641.0, "episode_reward_min": 641.0, "episode_reward_mean": 641.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [641.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3940354493364197, "mean_raw_obs_processing_ms": 0.11919269003538784, "mean_inference_ms": 1.6274429399304284, "mean_action_processing_ms": 0.04625689055957013}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1620000, "timers": {"sample_time_ms": 8147.015, "sample_throughput": 490.977, "learn_time_ms": 12290.127, "learn_throughput": 325.465, "update_time_ms": 3.232}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 5.679490379989147, "policy_loss": -0.03867546177934855, "vf_loss": 5.706342816352844, "vf_explained_var": 0.5712722539901733, "kl": 0.013288169488077983, "entropy": 0.2518233275040984, "entropy_coeff": 0.0}}, "num_steps_sampled": 1620000, "num_steps_trained": 1620000}, "done": false, "episodes_total": 162, "training_iteration": 405, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-19-58", "timestamp": 1618147198, "time_this_iter_s": 20.258177280426025, "time_total_s": 8552.610033273697, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1290>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e06d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8552.610033273697, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 58.372413793103455, "ram_util_percent": 27.91379310344827}, "trial_id": "9be58_00000"}
{"episode_reward_max": 641.0, "episode_reward_min": 641.0, "episode_reward_mean": 641.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [641.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3940354493364197, "mean_raw_obs_processing_ms": 0.11919269003538784, "mean_inference_ms": 1.6274429399304284, "mean_action_processing_ms": 0.04625689055957013}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1624000, "timers": {"sample_time_ms": 8167.895, "sample_throughput": 489.722, "learn_time_ms": 12287.625, "learn_throughput": 325.531, "update_time_ms": 3.257}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 8.11528143286705, "policy_loss": -0.0364731386071071, "vf_loss": 8.143350258469582, "vf_explained_var": 0.5535311102867126, "kl": 0.009445813571801409, "entropy": 0.19140153797343373, "entropy_coeff": 0.0}}, "num_steps_sampled": 1624000, "num_steps_trained": 1624000}, "done": false, "episodes_total": 162, "training_iteration": 406, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-20-19", "timestamp": 1618147219, "time_this_iter_s": 20.64858841896057, "time_total_s": 8573.258621692657, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ed50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8573.258621692657, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 59.440000000000005, "ram_util_percent": 27.933333333333326}, "trial_id": "9be58_00000"}
{"episode_reward_max": 641.0, "episode_reward_min": 641.0, "episode_reward_mean": 641.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [641.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3940354493364197, "mean_raw_obs_processing_ms": 0.11919269003538784, "mean_inference_ms": 1.6274429399304284, "mean_action_processing_ms": 0.04625689055957013}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1628000, "timers": {"sample_time_ms": 8221.007, "sample_throughput": 486.558, "learn_time_ms": 12324.411, "learn_throughput": 324.559, "update_time_ms": 3.3}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8897422929566511, "cur_lr": 5e-05, "total_loss": 13.246424734592438, "policy_loss": -0.04907424177508801, "vf_loss": 13.277015179395676, "vf_explained_var": 0.6452896595001221, "kl": 0.020774371456354856, "entropy": 0.2297705770470202, "entropy_coeff": 0.0}}, "num_steps_sampled": 1628000, "num_steps_trained": 1628000}, "done": false, "episodes_total": 162, "training_iteration": 407, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-20-40", "timestamp": 1618147240, "time_this_iter_s": 20.868043422698975, "time_total_s": 8594.126665115356, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a6310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8594.126665115356, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 60.19655172413793, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1145.0, "episode_reward_min": 1145.0, "episode_reward_mean": 1145.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1145.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3924545036411907, "mean_raw_obs_processing_ms": 0.11955460256683655, "mean_inference_ms": 1.6277132706133346, "mean_action_processing_ms": 0.046259345081250444}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1632000, "timers": {"sample_time_ms": 8192.781, "sample_throughput": 488.235, "learn_time_ms": 12350.786, "learn_throughput": 323.866, "update_time_ms": 3.328}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3346134394349767, "cur_lr": 5e-05, "total_loss": 8.982653841376305, "policy_loss": -0.02371056954143569, "vf_loss": 9.000201433897018, "vf_explained_var": 0.6671299934387207, "kl": 0.004617748782038689, "entropy": 0.1390918625984341, "entropy_coeff": 0.0}}, "num_steps_sampled": 1632000, "num_steps_trained": 1632000}, "done": false, "episodes_total": 163, "training_iteration": 408, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-21-01", "timestamp": 1618147261, "time_this_iter_s": 20.778149127960205, "time_total_s": 8614.904814243317, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2fd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8614.904814243317, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 59.550000000000004, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1145.0, "episode_reward_min": 1145.0, "episode_reward_mean": 1145.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1145.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3924545036411907, "mean_raw_obs_processing_ms": 0.11955460256683655, "mean_inference_ms": 1.6277132706133346, "mean_action_processing_ms": 0.046259345081250444}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1636000, "timers": {"sample_time_ms": 8156.096, "sample_throughput": 490.431, "learn_time_ms": 12346.266, "learn_throughput": 323.985, "update_time_ms": 3.511}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6673067197174883, "cur_lr": 5e-05, "total_loss": 6.397773116827011, "policy_loss": -0.028422547096852213, "vf_loss": 6.421138778328896, "vf_explained_var": 0.46450531482696533, "kl": 0.0075780446495627984, "entropy": 0.1740679950453341, "entropy_coeff": 0.0}}, "num_steps_sampled": 1636000, "num_steps_trained": 1636000}, "done": false, "episodes_total": 163, "training_iteration": 409, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-21-21", "timestamp": 1618147281, "time_this_iter_s": 20.475478410720825, "time_total_s": 8635.380292654037, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8635.380292654037, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 58.51724137931034, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1188.0, "episode_reward_min": 1188.0, "episode_reward_mean": 1188.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1188.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39136613963456196, "mean_raw_obs_processing_ms": 0.1197646227799921, "mean_inference_ms": 1.6277279010363255, "mean_action_processing_ms": 0.046257453572775886}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1640000, "timers": {"sample_time_ms": 8137.362, "sample_throughput": 491.56, "learn_time_ms": 12371.402, "learn_throughput": 323.326, "update_time_ms": 3.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6673067197174883, "cur_lr": 5e-05, "total_loss": 6.4274206310510635, "policy_loss": -0.07762194919632748, "vf_loss": 6.480496168136597, "vf_explained_var": 0.6629491448402405, "kl": 0.036784334981348366, "entropy": 0.2335565979592502, "entropy_coeff": 0.0}}, "num_steps_sampled": 1640000, "num_steps_trained": 1640000}, "done": false, "episodes_total": 164, "training_iteration": 410, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-21-42", "timestamp": 1618147302, "time_this_iter_s": 20.570915460586548, "time_total_s": 8655.951208114624, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcb50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c219a750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8655.951208114624, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 59.349999999999994, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1188.0, "episode_reward_min": 1188.0, "episode_reward_mean": 1188.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1188.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39136613963456196, "mean_raw_obs_processing_ms": 0.1197646227799921, "mean_inference_ms": 1.6277279010363255, "mean_action_processing_ms": 0.046257453572775886}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1644000, "timers": {"sample_time_ms": 8202.715, "sample_throughput": 487.643, "learn_time_ms": 12375.237, "learn_throughput": 323.226, "update_time_ms": 3.347}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 5.375245034694672, "policy_loss": -0.03357589722145349, "vf_loss": 5.401669681072235, "vf_explained_var": 0.3782753050327301, "kl": 0.007144489041820634, "entropy": 0.16938578942790627, "entropy_coeff": 0.0}}, "num_steps_sampled": 1644000, "num_steps_trained": 1644000}, "done": false, "episodes_total": 164, "training_iteration": 411, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-22-02", "timestamp": 1618147322, "time_this_iter_s": 20.73079228401184, "time_total_s": 8676.682000398636, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a1cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8676.682000398636, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 60.099999999999994, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1188.0, "episode_reward_min": 1188.0, "episode_reward_mean": 1188.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1188.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39136613963456196, "mean_raw_obs_processing_ms": 0.1197646227799921, "mean_inference_ms": 1.6277279010363255, "mean_action_processing_ms": 0.046257453572775886}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1648000, "timers": {"sample_time_ms": 8209.783, "sample_throughput": 487.224, "learn_time_ms": 12361.791, "learn_throughput": 323.578, "update_time_ms": 3.273}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 5.77430547773838, "policy_loss": -0.018485044973203912, "vf_loss": 5.787227183580399, "vf_explained_var": 0.41644853353500366, "kl": 0.005557995042181574, "entropy": 0.2065494004637003, "entropy_coeff": 0.0}}, "num_steps_sampled": 1648000, "num_steps_trained": 1648000}, "done": false, "episodes_total": 164, "training_iteration": 412, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-22-23", "timestamp": 1618147343, "time_this_iter_s": 20.578944206237793, "time_total_s": 8697.260944604874, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2e90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8697.260944604874, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 59.27333333333333, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1232.0, "episode_reward_min": 1232.0, "episode_reward_mean": 1232.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1232.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39002500465311135, "mean_raw_obs_processing_ms": 0.12009128838714456, "mean_inference_ms": 1.6278180594646616, "mean_action_processing_ms": 0.046257936778448215}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1652000, "timers": {"sample_time_ms": 8196.65, "sample_throughput": 488.004, "learn_time_ms": 12374.783, "learn_throughput": 323.238, "update_time_ms": 3.248}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 7.836183190345764, "policy_loss": -0.042817124689463526, "vf_loss": 7.862151578068733, "vf_explained_var": 0.5470514893531799, "kl": 0.01683256807154976, "entropy": 0.2193321418017149, "entropy_coeff": 0.0}}, "num_steps_sampled": 1652000, "num_steps_trained": 1652000}, "done": false, "episodes_total": 165, "training_iteration": 413, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-22-44", "timestamp": 1618147364, "time_this_iter_s": 20.627296686172485, "time_total_s": 8717.888241291046, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3de10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8717.888241291046, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 59.065517241379304, "ram_util_percent": 27.94827586206896}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1232.0, "episode_reward_min": 1232.0, "episode_reward_mean": 1232.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1232.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.39002500465311135, "mean_raw_obs_processing_ms": 0.12009128838714456, "mean_inference_ms": 1.6278180594646616, "mean_action_processing_ms": 0.046257936778448215}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1656000, "timers": {"sample_time_ms": 8222.216, "sample_throughput": 486.487, "learn_time_ms": 12396.287, "learn_throughput": 322.677, "update_time_ms": 3.221}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 7.6055943220853806, "policy_loss": -0.03972974233329296, "vf_loss": 7.63706111907959, "vf_explained_var": 0.559363067150116, "kl": 0.008255003704107367, "entropy": 0.20542585710063577, "entropy_coeff": 0.0}}, "num_steps_sampled": 1656000, "num_steps_trained": 1656000}, "done": false, "episodes_total": 165, "training_iteration": 414, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-23-04", "timestamp": 1618147384, "time_this_iter_s": 20.742676258087158, "time_total_s": 8738.630917549133, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22b9ed0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f7510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8738.630917549133, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 58.923333333333325, "ram_util_percent": 27.969999999999995}, "trial_id": "9be58_00000"}
{"episode_reward_max": 981.0, "episode_reward_min": 981.0, "episode_reward_mean": 981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38911697705468595, "mean_raw_obs_processing_ms": 0.12029739768191185, "mean_inference_ms": 1.627816043481002, "mean_action_processing_ms": 0.046256667445291194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1660000, "timers": {"sample_time_ms": 8250.797, "sample_throughput": 484.802, "learn_time_ms": 12403.311, "learn_throughput": 322.495, "update_time_ms": 3.165}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 5.48578155040741, "policy_loss": -0.037757625919766724, "vf_loss": 5.515127241611481, "vf_explained_var": 0.7972019910812378, "kl": 0.008403850952163339, "entropy": 0.20440035685896873, "entropy_coeff": 0.0}}, "num_steps_sampled": 1660000, "num_steps_trained": 1660000}, "done": false, "episodes_total": 166, "training_iteration": 415, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-23-25", "timestamp": 1618147405, "time_this_iter_s": 20.614043712615967, "time_total_s": 8759.24496126175, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5a50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4eb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8759.24496126175, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 59.63448275862069, "ram_util_percent": 27.972413793103446}, "trial_id": "9be58_00000"}
{"episode_reward_max": 981.0, "episode_reward_min": 981.0, "episode_reward_mean": 981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38911697705468595, "mean_raw_obs_processing_ms": 0.12029739768191185, "mean_inference_ms": 1.627816043481002, "mean_action_processing_ms": 0.046256667445291194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1664000, "timers": {"sample_time_ms": 8250.234, "sample_throughput": 484.835, "learn_time_ms": 12416.157, "learn_throughput": 322.161, "update_time_ms": 3.121}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0009600795762326, "cur_lr": 5e-05, "total_loss": 5.178950488567352, "policy_loss": -0.027547588251763955, "vf_loss": 5.201703175902367, "vf_explained_var": 0.24530577659606934, "kl": 0.004790360897459323, "entropy": 0.15541738225147128, "entropy_coeff": 0.0}}, "num_steps_sampled": 1664000, "num_steps_trained": 1664000}, "done": false, "episodes_total": 166, "training_iteration": 416, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-23-46", "timestamp": 1618147426, "time_this_iter_s": 20.77415633201599, "time_total_s": 8780.019117593765, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca9d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221f910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8780.019117593765, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 59.43666666666666, "ram_util_percent": 27.95333333333333}, "trial_id": "9be58_00000"}
{"episode_reward_max": 981.0, "episode_reward_min": 981.0, "episode_reward_mean": 981.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [981.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38911697705468595, "mean_raw_obs_processing_ms": 0.12029739768191185, "mean_inference_ms": 1.627816043481002, "mean_action_processing_ms": 0.046256667445291194}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1668000, "timers": {"sample_time_ms": 8224.19, "sample_throughput": 486.37, "learn_time_ms": 12433.589, "learn_throughput": 321.709, "update_time_ms": 3.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 8.199540942907333, "policy_loss": -0.03733158143586479, "vf_loss": 8.231321319937706, "vf_explained_var": 0.2476181983947754, "kl": 0.011091876702266745, "entropy": 0.17630640300922096, "entropy_coeff": 0.0}}, "num_steps_sampled": 1668000, "num_steps_trained": 1668000}, "done": false, "episodes_total": 166, "training_iteration": 417, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-24-07", "timestamp": 1618147447, "time_this_iter_s": 20.781977653503418, "time_total_s": 8800.801095247269, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca910>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8800.801095247269, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 59.52666666666667, "ram_util_percent": 27.943333333333328}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1484.0, "episode_reward_min": 1484.0, "episode_reward_mean": 1484.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1484.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38747203575716216, "mean_raw_obs_processing_ms": 0.1206343983951739, "mean_inference_ms": 1.6279800535327438, "mean_action_processing_ms": 0.04626340215246462}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1672000, "timers": {"sample_time_ms": 8211.109, "sample_throughput": 487.145, "learn_time_ms": 12435.67, "learn_throughput": 321.655, "update_time_ms": 3.225}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 7.5247742384672165, "policy_loss": -0.05121505761053413, "vf_loss": 7.56662517786026, "vf_explained_var": 0.5571027994155884, "kl": 0.01871028440655209, "entropy": 0.20318504190072417, "entropy_coeff": 0.0}}, "num_steps_sampled": 1672000, "num_steps_trained": 1672000}, "done": false, "episodes_total": 167, "training_iteration": 418, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-24-27", "timestamp": 1618147467, "time_this_iter_s": 20.66909956932068, "time_total_s": 8821.47019481659, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8821.47019481659, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 59.35862068965517, "ram_util_percent": 27.944827586206895}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1484.0, "episode_reward_min": 1484.0, "episode_reward_mean": 1484.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1484.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38747203575716216, "mean_raw_obs_processing_ms": 0.1206343983951739, "mean_inference_ms": 1.6279800535327438, "mean_action_processing_ms": 0.04626340215246462}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1676000, "timers": {"sample_time_ms": 8243.862, "sample_throughput": 485.209, "learn_time_ms": 12446.88, "learn_throughput": 321.366, "update_time_ms": 3.026}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5004800397881163, "cur_lr": 5e-05, "total_loss": 7.370607778429985, "policy_loss": -0.0678194115171209, "vf_loss": 7.426515221595764, "vf_explained_var": 0.6097865104675293, "kl": 0.023801226692739874, "entropy": 0.2060677632689476, "entropy_coeff": 0.0}}, "num_steps_sampled": 1676000, "num_steps_trained": 1676000}, "done": false, "episodes_total": 167, "training_iteration": 419, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-24-48", "timestamp": 1618147488, "time_this_iter_s": 20.911328077316284, "time_total_s": 8842.381522893906, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33568d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8842.381522893906, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 59.25333333333333, "ram_util_percent": 27.89999999999999}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38640563350310014, "mean_raw_obs_processing_ms": 0.12087053316437621, "mean_inference_ms": 1.6283119847894467, "mean_action_processing_ms": 0.04627026048848478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1680000, "timers": {"sample_time_ms": 8267.894, "sample_throughput": 483.799, "learn_time_ms": 12461.823, "learn_throughput": 320.98, "update_time_ms": 3.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7507200596821744, "cur_lr": 5e-05, "total_loss": 5.095151290297508, "policy_loss": -0.02533963561290875, "vf_loss": 5.1153343841433525, "vf_explained_var": 0.4368966519832611, "kl": 0.006868849610327743, "entropy": 0.17734955297783017, "entropy_coeff": 0.0}}, "num_steps_sampled": 1680000, "num_steps_trained": 1680000}, "done": false, "episodes_total": 168, "training_iteration": 420, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-25-09", "timestamp": 1618147509, "time_this_iter_s": 20.960883855819702, "time_total_s": 8863.342406749725, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c338a690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22ca150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8863.342406749725, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 59.730000000000004, "ram_util_percent": 27.939999999999998}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38640563350310014, "mean_raw_obs_processing_ms": 0.12087053316437621, "mean_inference_ms": 1.6283119847894467, "mean_action_processing_ms": 0.04627026048848478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1684000, "timers": {"sample_time_ms": 8281.286, "sample_throughput": 483.017, "learn_time_ms": 12491.506, "learn_throughput": 320.218, "update_time_ms": 3.022}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7507200596821744, "cur_lr": 5e-05, "total_loss": 9.920607894659042, "policy_loss": -0.05057799135101959, "vf_loss": 9.951572000980377, "vf_explained_var": 0.5595828294754028, "kl": 0.02612676180433482, "entropy": 0.2243795315735042, "entropy_coeff": 0.0}}, "num_steps_sampled": 1684000, "num_steps_trained": 1684000}, "done": false, "episodes_total": 168, "training_iteration": 421, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-25-31", "timestamp": 1618147531, "time_this_iter_s": 21.162094593048096, "time_total_s": 8884.504501342773, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22b9e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68ceb10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8884.504501342773, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 59.843333333333334, "ram_util_percent": 27.973333333333336}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38640563350310014, "mean_raw_obs_processing_ms": 0.12087053316437621, "mean_inference_ms": 1.6283119847894467, "mean_action_processing_ms": 0.04627026048848478}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1688000, "timers": {"sample_time_ms": 8281.882, "sample_throughput": 482.982, "learn_time_ms": 12537.354, "learn_throughput": 319.047, "update_time_ms": 3.059}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 6.17985612154007, "policy_loss": -0.03954956022789702, "vf_loss": 6.212130159139633, "vf_explained_var": 0.32949620485305786, "kl": 0.006460887525463477, "entropy": 0.2158812452107668, "entropy_coeff": 0.0}}, "num_steps_sampled": 1688000, "num_steps_trained": 1688000}, "done": false, "episodes_total": 168, "training_iteration": 422, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-25-52", "timestamp": 1618147552, "time_this_iter_s": 21.046757698059082, "time_total_s": 8905.551259040833, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2236a10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22364d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8905.551259040833, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 59.823333333333345, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 883.0, "episode_reward_min": 883.0, "episode_reward_mean": 883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3849408445404884, "mean_raw_obs_processing_ms": 0.121226724374698, "mean_inference_ms": 1.6286878398107412, "mean_action_processing_ms": 0.04627897030522775}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1692000, "timers": {"sample_time_ms": 8293.476, "sample_throughput": 482.307, "learn_time_ms": 12580.397, "learn_throughput": 317.955, "update_time_ms": 3.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 6.476447954773903, "policy_loss": -0.04488407063763589, "vf_loss": 6.511503711342812, "vf_explained_var": 0.5237216353416443, "kl": 0.008727908265427686, "entropy": 0.21965740574523807, "entropy_coeff": 0.0}}, "num_steps_sampled": 1692000, "num_steps_trained": 1692000}, "done": false, "episodes_total": 169, "training_iteration": 423, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-26-13", "timestamp": 1618147573, "time_this_iter_s": 21.174561500549316, "time_total_s": 8926.725820541382, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2236c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a68d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8926.725820541382, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 60.03225806451613, "ram_util_percent": 27.945161290322577}, "trial_id": "9be58_00000"}
{"episode_reward_max": 883.0, "episode_reward_min": 883.0, "episode_reward_mean": 883.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [883.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3849408445404884, "mean_raw_obs_processing_ms": 0.121226724374698, "mean_inference_ms": 1.6286878398107412, "mean_action_processing_ms": 0.04627897030522775}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1696000, "timers": {"sample_time_ms": 8325.502, "sample_throughput": 480.452, "learn_time_ms": 12590.661, "learn_throughput": 317.696, "update_time_ms": 3.2}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 7.070357874035835, "policy_loss": -0.0364904361194931, "vf_loss": 7.088296175003052, "vf_explained_var": 0.5178361535072327, "kl": 0.01647497431258671, "entropy": 0.20134876109659672, "entropy_coeff": 0.0}}, "num_steps_sampled": 1696000, "num_steps_trained": 1696000}, "done": false, "episodes_total": 169, "training_iteration": 424, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-26-34", "timestamp": 1618147594, "time_this_iter_s": 21.16668462753296, "time_total_s": 8947.892505168915, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fc390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc4d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8947.892505168915, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 58.82333333333333, "ram_util_percent": 27.94}, "trial_id": "9be58_00000"}
{"episode_reward_max": 811.0, "episode_reward_min": 811.0, "episode_reward_mean": 811.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [811.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38466476294560237, "mean_raw_obs_processing_ms": 0.12147214756417071, "mean_inference_ms": 1.628966064820727, "mean_action_processing_ms": 0.046286728923375146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1700000, "timers": {"sample_time_ms": 8452.861, "sample_throughput": 473.213, "learn_time_ms": 12639.126, "learn_throughput": 316.478, "update_time_ms": 3.377}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 6.006532400846481, "policy_loss": -0.029067922296235338, "vf_loss": 6.027590394020081, "vf_explained_var": 0.3712056279182434, "kl": 0.007113173429388553, "entropy": 0.2164215543307364, "entropy_coeff": 0.0}}, "num_steps_sampled": 1700000, "num_steps_trained": 1700000}, "done": false, "episodes_total": 170, "training_iteration": 425, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-26-57", "timestamp": 1618147617, "time_this_iter_s": 22.376242637634277, "time_total_s": 8970.268747806549, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33b2410>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4db90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8970.268747806549, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 59.96875, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 811.0, "episode_reward_min": 811.0, "episode_reward_mean": 811.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [811.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38466476294560237, "mean_raw_obs_processing_ms": 0.12147214756417071, "mean_inference_ms": 1.628966064820727, "mean_action_processing_ms": 0.046286728923375146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1704000, "timers": {"sample_time_ms": 8584.444, "sample_throughput": 465.959, "learn_time_ms": 12642.24, "learn_throughput": 316.4, "update_time_ms": 3.448}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1260800895232617, "cur_lr": 5e-05, "total_loss": 6.620860353112221, "policy_loss": -0.021019059233367443, "vf_loss": 6.637272194027901, "vf_explained_var": 0.5993009805679321, "kl": 0.004091333474207204, "entropy": 0.11680745240300894, "entropy_coeff": 0.0}}, "num_steps_sampled": 1704000, "num_steps_trained": 1704000}, "done": false, "episodes_total": 170, "training_iteration": 426, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-27-19", "timestamp": 1618147639, "time_this_iter_s": 22.122539520263672, "time_total_s": 8992.391287326813, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f22d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fa90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8992.391287326813, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 59.26129032258065, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 811.0, "episode_reward_min": 811.0, "episode_reward_mean": 811.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [811.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38466476294560237, "mean_raw_obs_processing_ms": 0.12147214756417071, "mean_inference_ms": 1.628966064820727, "mean_action_processing_ms": 0.046286728923375146}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1708000, "timers": {"sample_time_ms": 8619.919, "sample_throughput": 464.042, "learn_time_ms": 12631.286, "learn_throughput": 316.674, "update_time_ms": 3.476}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5630400447616308, "cur_lr": 5e-05, "total_loss": 0.6865142937749624, "policy_loss": -0.003597704111598432, "vf_loss": 0.690111855044961, "vf_explained_var": -0.0006146952509880066, "kl": 2.685850524208888e-07, "entropy": 0.0007367247380898334, "entropy_coeff": 0.0}}, "num_steps_sampled": 1708000, "num_steps_trained": 1708000}, "done": false, "episodes_total": 170, "training_iteration": 427, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-27-40", "timestamp": 1618147660, "time_this_iter_s": 21.027772188186646, "time_total_s": 9013.419059515, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221f090>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9013.419059515, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 60.406666666666666, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 187.0, "episode_reward_min": 187.0, "episode_reward_mean": 187.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38408535315462183, "mean_raw_obs_processing_ms": 0.12182412596403178, "mean_inference_ms": 1.6293859338175556, "mean_action_processing_ms": 0.04629735868874043}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1712000, "timers": {"sample_time_ms": 8675.196, "sample_throughput": 461.085, "learn_time_ms": 12627.964, "learn_throughput": 316.757, "update_time_ms": 3.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2815200223808154, "cur_lr": 5e-05, "total_loss": 0.13122311607003212, "policy_loss": -0.0005198389990255237, "vf_loss": 0.1317424150183797, "vf_explained_var": -0.001991458237171173, "kl": 1.8897922835492409e-06, "entropy": 0.0008968003730842611, "entropy_coeff": 0.0}}, "num_steps_sampled": 1712000, "num_steps_trained": 1712000}, "done": false, "episodes_total": 171, "training_iteration": 428, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-28-01", "timestamp": 1618147681, "time_this_iter_s": 21.186521291732788, "time_total_s": 9034.605580806732, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222dc10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7ad0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9034.605580806732, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 59.74838709677419, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 187.0, "episode_reward_min": 187.0, "episode_reward_mean": 187.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38408535315462183, "mean_raw_obs_processing_ms": 0.12182412596403178, "mean_inference_ms": 1.6293859338175556, "mean_action_processing_ms": 0.04629735868874043}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1716000, "timers": {"sample_time_ms": 8703.548, "sample_throughput": 459.583, "learn_time_ms": 12627.557, "learn_throughput": 316.768, "update_time_ms": 3.324}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1407600111904077, "cur_lr": 5e-05, "total_loss": 0.027417374309152365, "policy_loss": 0.004428352054674178, "vf_loss": 0.022988957061897963, "vf_explained_var": -0.0003467928618192673, "kl": 4.5583811925098416e-07, "entropy": 0.0009786294504010584, "entropy_coeff": 0.0}}, "num_steps_sampled": 1716000, "num_steps_trained": 1716000}, "done": false, "episodes_total": 171, "training_iteration": 429, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-28-22", "timestamp": 1618147702, "time_this_iter_s": 21.193827390670776, "time_total_s": 9055.799408197403, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc4d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9055.799408197403, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 59.91999999999999, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 76.0, "episode_reward_min": 76.0, "episode_reward_mean": 76.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3832903373191253, "mean_raw_obs_processing_ms": 0.12206150751293134, "mean_inference_ms": 1.629751187331188, "mean_action_processing_ms": 0.046305711710143665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1720000, "timers": {"sample_time_ms": 8725.822, "sample_throughput": 458.41, "learn_time_ms": 12627.825, "learn_throughput": 316.761, "update_time_ms": 3.345}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.07038000559520385, "cur_lr": 5e-05, "total_loss": 2.46406652033329, "policy_loss": -0.06807218329049647, "vf_loss": 2.528422225266695, "vf_explained_var": 0.8235121965408325, "kl": 0.05280616006348282, "entropy": 0.10015792725607753, "entropy_coeff": 0.0}}, "num_steps_sampled": 1720000, "num_steps_trained": 1720000}, "done": false, "episodes_total": 172, "training_iteration": 430, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-28-43", "timestamp": 1618147723, "time_this_iter_s": 21.18413233757019, "time_total_s": 9076.983540534973, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9076.983540534973, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 59.48000000000001, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 76.0, "episode_reward_min": 76.0, "episode_reward_mean": 76.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3832903373191253, "mean_raw_obs_processing_ms": 0.12206150751293134, "mean_inference_ms": 1.629751187331188, "mean_action_processing_ms": 0.046305711710143665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1724000, "timers": {"sample_time_ms": 8809.663, "sample_throughput": 454.047, "learn_time_ms": 12618.124, "learn_throughput": 317.004, "update_time_ms": 3.32}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10557000839280578, "cur_lr": 5e-05, "total_loss": 5.997700899839401, "policy_loss": -0.08983751817140728, "vf_loss": 6.0767612755298615, "vf_explained_var": 0.6939062476158142, "kl": 0.10208489838987589, "entropy": 0.2823454737663269, "entropy_coeff": 0.0}}, "num_steps_sampled": 1724000, "num_steps_trained": 1724000}, "done": false, "episodes_total": 172, "training_iteration": 431, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-29-05", "timestamp": 1618147745, "time_this_iter_s": 21.900747537612915, "time_total_s": 9098.884288072586, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dc310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9098.884288072586, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 60.21290322580646, "ram_util_percent": 28.003225806451614}, "trial_id": "9be58_00000"}
{"episode_reward_max": 76.0, "episode_reward_min": 76.0, "episode_reward_mean": 76.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3832903373191253, "mean_raw_obs_processing_ms": 0.12206150751293134, "mean_inference_ms": 1.629751187331188, "mean_action_processing_ms": 0.046305711710143665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1728000, "timers": {"sample_time_ms": 9016.089, "sample_throughput": 443.651, "learn_time_ms": 12588.521, "learn_throughput": 317.75, "update_time_ms": 3.35}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15835501258920867, "cur_lr": 5e-05, "total_loss": 7.518433511257172, "policy_loss": -0.03372619621222839, "vf_loss": 7.547575667500496, "vf_explained_var": 0.4819676876068115, "kl": 0.028947593120392412, "entropy": 0.1839592675678432, "entropy_coeff": 0.0}}, "num_steps_sampled": 1728000, "num_steps_trained": 1728000}, "done": false, "episodes_total": 172, "training_iteration": 432, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-29-28", "timestamp": 1618147768, "time_this_iter_s": 22.814292192459106, "time_total_s": 9121.698580265045, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33565d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9121.698580265045, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 59.24545454545454, "ram_util_percent": 28.07878787878788}, "trial_id": "9be58_00000"}
{"episode_reward_max": 655.0, "episode_reward_min": 655.0, "episode_reward_mean": 655.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [655.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38353995325890755, "mean_raw_obs_processing_ms": 0.12243257321614433, "mean_inference_ms": 1.630180971799413, "mean_action_processing_ms": 0.046325501159042076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1732000, "timers": {"sample_time_ms": 9033.851, "sample_throughput": 442.779, "learn_time_ms": 12552.763, "learn_throughput": 318.655, "update_time_ms": 3.377}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.237532518883813, "cur_lr": 5e-05, "total_loss": 3.178562417626381, "policy_loss": -0.009743307658936828, "vf_loss": 3.1855285242199898, "vf_explained_var": 0.3041347563266754, "kl": 0.011692104279063642, "entropy": 0.10688224411569536, "entropy_coeff": 0.0}}, "num_steps_sampled": 1732000, "num_steps_trained": 1732000}, "done": false, "episodes_total": 173, "training_iteration": 433, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-29-49", "timestamp": 1618147789, "time_this_iter_s": 20.994460582733154, "time_total_s": 9142.693040847778, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c3356bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a17d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9142.693040847778, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 59.50333333333333, "ram_util_percent": 28.063333333333336}, "trial_id": "9be58_00000"}
{"episode_reward_max": 655.0, "episode_reward_min": 655.0, "episode_reward_mean": 655.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [655.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.38353995325890755, "mean_raw_obs_processing_ms": 0.12243257321614433, "mean_inference_ms": 1.630180971799413, "mean_action_processing_ms": 0.046325501159042076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1736000, "timers": {"sample_time_ms": 9167.591, "sample_throughput": 436.32, "learn_time_ms": 12546.93, "learn_throughput": 318.803, "update_time_ms": 3.342}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.237532518883813, "cur_lr": 5e-05, "total_loss": 9.027495801448822, "policy_loss": -0.03895151655888185, "vf_loss": 9.058001548051834, "vf_explained_var": 0.5051025152206421, "kl": 0.03555633846735873, "entropy": 0.13323847146239132, "entropy_coeff": 0.0}}, "num_steps_sampled": 1736000, "num_steps_trained": 1736000}, "done": false, "episodes_total": 173, "training_iteration": 434, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-30-12", "timestamp": 1618147812, "time_this_iter_s": 22.445953845977783, "time_total_s": 9165.138994693756, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d0e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fca90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9165.138994693756, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 59.387499999999996, "ram_util_percent": 28.009375}, "trial_id": "9be58_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3835885742769719, "mean_raw_obs_processing_ms": 0.12267349745625174, "mean_inference_ms": 1.630474756270059, "mean_action_processing_ms": 0.04633546775167869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1740000, "timers": {"sample_time_ms": 9094.407, "sample_throughput": 439.831, "learn_time_ms": 12520.406, "learn_throughput": 319.478, "update_time_ms": 3.18}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3562987783257195, "cur_lr": 5e-05, "total_loss": 5.683060377836227, "policy_loss": -0.01855271094245836, "vf_loss": 5.6987593695521355, "vf_explained_var": 0.7273759245872498, "kl": 0.008009503639186732, "entropy": 0.23376757744699717, "entropy_coeff": 0.0}}, "num_steps_sampled": 1740000, "num_steps_trained": 1740000}, "done": false, "episodes_total": 174, "training_iteration": 435, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-30-33", "timestamp": 1618147833, "time_this_iter_s": 21.375120878219604, "time_total_s": 9186.514115571976, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a6950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9186.514115571976, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 60.19354838709677, "ram_util_percent": 28.077419354838717}, "trial_id": "9be58_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3835885742769719, "mean_raw_obs_processing_ms": 0.12267349745625174, "mean_inference_ms": 1.630474756270059, "mean_action_processing_ms": 0.04633546775167869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1744000, "timers": {"sample_time_ms": 8972.049, "sample_throughput": 445.829, "learn_time_ms": 12534.68, "learn_throughput": 319.115, "update_time_ms": 3.144}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3562987783257195, "cur_lr": 5e-05, "total_loss": 7.849996462464333, "policy_loss": -0.09981252206489444, "vf_loss": 7.911926507949829, "vf_explained_var": 0.6828975677490234, "kl": 0.10632241819985211, "entropy": 0.2673396421596408, "entropy_coeff": 0.0}}, "num_steps_sampled": 1744000, "num_steps_trained": 1744000}, "done": false, "episodes_total": 174, "training_iteration": 436, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-30-54", "timestamp": 1618147854, "time_this_iter_s": 21.039369106292725, "time_total_s": 9207.553484678268, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc6b68c7ad0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9207.553484678268, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 59.69333333333332, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 469.0, "episode_reward_min": 469.0, "episode_reward_mean": 469.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3835885742769719, "mean_raw_obs_processing_ms": 0.12267349745625174, "mean_inference_ms": 1.630474756270059, "mean_action_processing_ms": 0.04633546775167869}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1748000, "timers": {"sample_time_ms": 8980.285, "sample_throughput": 445.42, "learn_time_ms": 12554.386, "learn_throughput": 318.614, "update_time_ms": 3.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5344481674885793, "cur_lr": 5e-05, "total_loss": 6.3151955008506775, "policy_loss": -0.0880400532623753, "vf_loss": 6.352304689586163, "vf_explained_var": 0.776045560836792, "kl": 0.0952960872091353, "entropy": 0.21257331129163504, "entropy_coeff": 0.0}}, "num_steps_sampled": 1748000, "num_steps_trained": 1748000}, "done": false, "episodes_total": 174, "training_iteration": 437, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-31-15", "timestamp": 1618147875, "time_this_iter_s": 21.31009554862976, "time_total_s": 9228.863580226898, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6850>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d95d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9228.863580226898, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 58.93, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 853.0, "episode_reward_min": 853.0, "episode_reward_mean": 853.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [853.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3825325865917067, "mean_raw_obs_processing_ms": 0.12298619735710431, "mean_inference_ms": 1.6304537631307643, "mean_action_processing_ms": 0.046335486333512324}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1752000, "timers": {"sample_time_ms": 8927.416, "sample_throughput": 448.058, "learn_time_ms": 12540.353, "learn_throughput": 318.97, "update_time_ms": 3.613}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8016722512328689, "cur_lr": 5e-05, "total_loss": 9.3389353454113, "policy_loss": -0.02586393032106571, "vf_loss": 9.357766255736351, "vf_explained_var": 0.4250621199607849, "kl": 0.008772972287260927, "entropy": 0.11851584305986762, "entropy_coeff": 0.0}}, "num_steps_sampled": 1752000, "num_steps_trained": 1752000}, "done": false, "episodes_total": 175, "training_iteration": 438, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-31-36", "timestamp": 1618147896, "time_this_iter_s": 20.518996715545654, "time_total_s": 9249.382576942444, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4ed50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22a1050>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9249.382576942444, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 59.55172413793103, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 853.0, "episode_reward_min": 853.0, "episode_reward_mean": 853.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [853.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3825325865917067, "mean_raw_obs_processing_ms": 0.12298619735710431, "mean_inference_ms": 1.6304537631307643, "mean_action_processing_ms": 0.046335486333512324}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1756000, "timers": {"sample_time_ms": 8923.809, "sample_throughput": 448.239, "learn_time_ms": 12549.366, "learn_throughput": 318.741, "update_time_ms": 3.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8016722512328689, "cur_lr": 5e-05, "total_loss": 9.923770040273666, "policy_loss": -0.04051415654248558, "vf_loss": 9.94560432434082, "vf_explained_var": 0.4528464674949646, "kl": 0.023300796194234863, "entropy": 0.13749262015335262, "entropy_coeff": 0.0}}, "num_steps_sampled": 1756000, "num_steps_trained": 1756000}, "done": false, "episodes_total": 175, "training_iteration": 439, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-31-57", "timestamp": 1618147917, "time_this_iter_s": 21.246358633041382, "time_total_s": 9270.628935575485, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6950>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9270.628935575485, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 60.47096774193548, "ram_util_percent": 28.041935483870965}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1422.0, "episode_reward_min": 1422.0, "episode_reward_mean": 1422.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1422.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3817238151938096, "mean_raw_obs_processing_ms": 0.12320990199666339, "mean_inference_ms": 1.6307362356235338, "mean_action_processing_ms": 0.04633989965866554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1760000, "timers": {"sample_time_ms": 8906.974, "sample_throughput": 449.086, "learn_time_ms": 12541.241, "learn_throughput": 318.948, "update_time_ms": 3.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2025083768493032, "cur_lr": 5e-05, "total_loss": 7.1166776567697525, "policy_loss": -0.03759048043866642, "vf_loss": 7.134073778986931, "vf_explained_var": 0.5298363566398621, "kl": 0.016793524191598408, "entropy": 0.11763264099135995, "entropy_coeff": 0.0}}, "num_steps_sampled": 1760000, "num_steps_trained": 1760000}, "done": false, "episodes_total": 176, "training_iteration": 440, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-32-18", "timestamp": 1618147938, "time_this_iter_s": 20.938011407852173, "time_total_s": 9291.566946983337, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222d250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9291.566946983337, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 59.99333333333335, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1422.0, "episode_reward_min": 1422.0, "episode_reward_mean": 1422.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1422.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3817238151938096, "mean_raw_obs_processing_ms": 0.12320990199666339, "mean_inference_ms": 1.6307362356235338, "mean_action_processing_ms": 0.04633989965866554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1764000, "timers": {"sample_time_ms": 8780.282, "sample_throughput": 455.566, "learn_time_ms": 12546.063, "learn_throughput": 318.825, "update_time_ms": 3.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2025083768493032, "cur_lr": 5e-05, "total_loss": 10.255437448620796, "policy_loss": -0.031466208514757454, "vf_loss": 10.272716015577316, "vf_explained_var": 0.3631366491317749, "kl": 0.011798380728578195, "entropy": 0.11018739617429674, "entropy_coeff": 0.0}}, "num_steps_sampled": 1764000, "num_steps_trained": 1764000}, "done": false, "episodes_total": 176, "training_iteration": 441, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-32-39", "timestamp": 1618147959, "time_this_iter_s": 20.681119203567505, "time_total_s": 9312.248066186905, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2236dd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2236350>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9312.248066186905, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 59.765517241379314, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1422.0, "episode_reward_min": 1422.0, "episode_reward_mean": 1422.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1422.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3817238151938096, "mean_raw_obs_processing_ms": 0.12320990199666339, "mean_inference_ms": 1.6307362356235338, "mean_action_processing_ms": 0.04633989965866554}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1768000, "timers": {"sample_time_ms": 8561.129, "sample_throughput": 467.228, "learn_time_ms": 12547.716, "learn_throughput": 318.783, "update_time_ms": 3.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2025083768493032, "cur_lr": 5e-05, "total_loss": 11.403582662343979, "policy_loss": -0.022773507138481364, "vf_loss": 11.417670607566833, "vf_explained_var": 0.641162097454071, "kl": 0.007222836706205271, "entropy": 0.10824137437157333, "entropy_coeff": 0.0}}, "num_steps_sampled": 1768000, "num_steps_trained": 1768000}, "done": false, "episodes_total": 176, "training_iteration": 442, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-33-00", "timestamp": 1618147980, "time_this_iter_s": 20.6392183303833, "time_total_s": 9332.887284517288, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c221fe10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9332.887284517288, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 58.766666666666666, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1346.0, "episode_reward_min": 1346.0, "episode_reward_mean": 1346.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1346.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3803302369563582, "mean_raw_obs_processing_ms": 0.123527206482433, "mean_inference_ms": 1.6308518732524435, "mean_action_processing_ms": 0.046342439445055485}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1772000, "timers": {"sample_time_ms": 8551.908, "sample_throughput": 467.732, "learn_time_ms": 12553.414, "learn_throughput": 318.638, "update_time_ms": 3.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2025083768493032, "cur_lr": 5e-05, "total_loss": 10.522546499967575, "policy_loss": -0.016614702239166945, "vf_loss": 10.534470945596695, "vf_explained_var": 0.5516413450241089, "kl": 0.0039003148485790007, "entropy": 0.09388261032290757, "entropy_coeff": 0.0}}, "num_steps_sampled": 1772000, "num_steps_trained": 1772000}, "done": false, "episodes_total": 177, "training_iteration": 443, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-33-21", "timestamp": 1618148001, "time_this_iter_s": 20.95924425125122, "time_total_s": 9353.84652876854, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9353.84652876854, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 60.12999999999999, "ram_util_percent": 28.040000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1346.0, "episode_reward_min": 1346.0, "episode_reward_mean": 1346.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1346.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3803302369563582, "mean_raw_obs_processing_ms": 0.123527206482433, "mean_inference_ms": 1.6308518732524435, "mean_action_processing_ms": 0.046342439445055485}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1776000, "timers": {"sample_time_ms": 8387.875, "sample_throughput": 476.879, "learn_time_ms": 12545.637, "learn_throughput": 318.836, "update_time_ms": 3.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5e-05, "total_loss": 9.204114943742752, "policy_loss": -0.029045957082416862, "vf_loss": 9.223806902766228, "vf_explained_var": 0.5434112548828125, "kl": 0.015557464212179184, "entropy": 0.12835220340639353, "entropy_coeff": 0.0}}, "num_steps_sampled": 1776000, "num_steps_trained": 1776000}, "done": false, "episodes_total": 177, "training_iteration": 444, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-33-41", "timestamp": 1618148021, "time_this_iter_s": 20.726127862930298, "time_total_s": 9374.57265663147, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22fce10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c33568d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9374.57265663147, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 59.848275862068974, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 813.0, "episode_reward_min": 813.0, "episode_reward_mean": 813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3794697085643998, "mean_raw_obs_processing_ms": 0.12374320351453129, "mean_inference_ms": 1.6309683300434887, "mean_action_processing_ms": 0.04634567145714128}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1780000, "timers": {"sample_time_ms": 8353.06, "sample_throughput": 478.866, "learn_time_ms": 12535.945, "learn_throughput": 319.082, "update_time_ms": 3.579}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5e-05, "total_loss": 8.119163304567337, "policy_loss": -0.01567338639870286, "vf_loss": 8.128652513027191, "vf_explained_var": 0.6980136632919312, "kl": 0.010285365948220715, "entropy": 0.08180835319217294, "entropy_coeff": 0.0}}, "num_steps_sampled": 1780000, "num_steps_trained": 1780000}, "done": false, "episodes_total": 178, "training_iteration": 445, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-34-02", "timestamp": 1618148042, "time_this_iter_s": 20.933037281036377, "time_total_s": 9395.505693912506, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e4c90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4ead0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9395.505693912506, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 59.78666666666667, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 813.0, "episode_reward_min": 813.0, "episode_reward_mean": 813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3794697085643998, "mean_raw_obs_processing_ms": 0.12374320351453129, "mean_inference_ms": 1.6309683300434887, "mean_action_processing_ms": 0.04634567145714128}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1784000, "timers": {"sample_time_ms": 8346.843, "sample_throughput": 479.223, "learn_time_ms": 12521.557, "learn_throughput": 319.449, "update_time_ms": 3.627}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5e-05, "total_loss": 7.3727171421051025, "policy_loss": -0.02040147705702111, "vf_loss": 7.389566317200661, "vf_explained_var": 0.7495127320289612, "kl": 0.005907964499783702, "entropy": 0.07116380531806499, "entropy_coeff": 0.0}}, "num_steps_sampled": 1784000, "num_steps_trained": 1784000}, "done": false, "episodes_total": 178, "training_iteration": 446, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-34-23", "timestamp": 1618148063, "time_this_iter_s": 20.83479070663452, "time_total_s": 9416.34048461914, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22fc390>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9416.34048461914, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 59.489999999999995, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 813.0, "episode_reward_min": 813.0, "episode_reward_mean": 813.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [813.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3794697085643998, "mean_raw_obs_processing_ms": 0.12374320351453129, "mean_inference_ms": 1.6309683300434887, "mean_action_processing_ms": 0.04634567145714128}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1788000, "timers": {"sample_time_ms": 8323.594, "sample_throughput": 480.562, "learn_time_ms": 12520.366, "learn_throughput": 319.479, "update_time_ms": 3.141}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6012541884246516, "cur_lr": 5e-05, "total_loss": 9.362093478441238, "policy_loss": -0.05886703316355124, "vf_loss": 9.388714760541916, "vf_explained_var": 0.5204436779022217, "kl": 0.05363072722684592, "entropy": 0.19040369149297476, "entropy_coeff": 0.0}}, "num_steps_sampled": 1788000, "num_steps_trained": 1788000}, "done": false, "episodes_total": 178, "training_iteration": 447, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-34-44", "timestamp": 1618148084, "time_this_iter_s": 21.062400579452515, "time_total_s": 9437.402885198593, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162cd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302b50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9437.402885198593, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 59.63333333333333, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 662.0, "episode_reward_min": 662.0, "episode_reward_mean": 662.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [662.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3782824548451478, "mean_raw_obs_processing_ms": 0.12407246319874739, "mean_inference_ms": 1.6311311421836228, "mean_action_processing_ms": 0.04634899454433827}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1792000, "timers": {"sample_time_ms": 8361.463, "sample_throughput": 478.385, "learn_time_ms": 12528.493, "learn_throughput": 319.272, "update_time_ms": 3.128}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9018812826369774, "cur_lr": 5e-05, "total_loss": 5.131084650754929, "policy_loss": -0.008140063408063725, "vf_loss": 5.136968642473221, "vf_explained_var": 0.5315940976142883, "kl": 0.0025014179409481585, "entropy": 0.04172104183817282, "entropy_coeff": 0.0}}, "num_steps_sampled": 1792000, "num_steps_trained": 1792000}, "done": false, "episodes_total": 179, "training_iteration": 448, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-35-05", "timestamp": 1618148105, "time_this_iter_s": 20.979716300964355, "time_total_s": 9458.382601499557, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9458.382601499557, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 59.80666666666666, "ram_util_percent": 28.019999999999996}, "trial_id": "9be58_00000"}
{"episode_reward_max": 662.0, "episode_reward_min": 662.0, "episode_reward_mean": 662.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [662.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3782824548451478, "mean_raw_obs_processing_ms": 0.12407246319874739, "mean_inference_ms": 1.6311311421836228, "mean_action_processing_ms": 0.04634899454433827}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1796000, "timers": {"sample_time_ms": 8354.606, "sample_throughput": 478.778, "learn_time_ms": 12504.025, "learn_throughput": 319.897, "update_time_ms": 3.291}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4509406413184887, "cur_lr": 5e-05, "total_loss": 4.556119382381439, "policy_loss": -0.03286916593788192, "vf_loss": 4.574519477784634, "vf_explained_var": 0.6030842065811157, "kl": 0.032086364983115345, "entropy": 0.10922573274001479, "entropy_coeff": 0.0}}, "num_steps_sampled": 1796000, "num_steps_trained": 1796000}, "done": false, "episodes_total": 179, "training_iteration": 449, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-35-26", "timestamp": 1618148126, "time_this_iter_s": 20.934561491012573, "time_total_s": 9479.31716299057, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22b9790>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9479.31716299057, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 59.783333333333324, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 434.0, "episode_reward_min": 434.0, "episode_reward_mean": 434.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [434.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37766972448274344, "mean_raw_obs_processing_ms": 0.12429762848985985, "mean_inference_ms": 1.6313696822245407, "mean_action_processing_ms": 0.04635897590800946}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1800000, "timers": {"sample_time_ms": 8387.412, "sample_throughput": 476.905, "learn_time_ms": 12506.255, "learn_throughput": 319.84, "update_time_ms": 3.296}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 9.016384229063988, "policy_loss": -0.03114513272885233, "vf_loss": 9.035885989665985, "vf_explained_var": 0.46010473370552063, "kl": 0.017213439772604033, "entropy": 0.13780620135366917, "entropy_coeff": 0.0}}, "num_steps_sampled": 1800000, "num_steps_trained": 1800000}, "done": false, "episodes_total": 180, "training_iteration": 450, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-35-48", "timestamp": 1618148148, "time_this_iter_s": 21.284729957580566, "time_total_s": 9500.60189294815, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22b9d50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22b9210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9500.60189294815, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 59.54666666666667, "ram_util_percent": 28.0}, "trial_id": "9be58_00000"}
{"episode_reward_max": 434.0, "episode_reward_min": 434.0, "episode_reward_mean": 434.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [434.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37766972448274344, "mean_raw_obs_processing_ms": 0.12429762848985985, "mean_inference_ms": 1.6313696822245407, "mean_action_processing_ms": 0.04635897590800946}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1804000, "timers": {"sample_time_ms": 8401.794, "sample_throughput": 476.089, "learn_time_ms": 12518.791, "learn_throughput": 319.52, "update_time_ms": 3.288}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 12.216588467359543, "policy_loss": -0.03180900576990098, "vf_loss": 12.242316752672195, "vf_explained_var": 0.41018301248550415, "kl": 0.008989414622192271, "entropy": 0.1024126943666488, "entropy_coeff": 0.0}}, "num_steps_sampled": 1804000, "num_steps_trained": 1804000}, "done": false, "episodes_total": 180, "training_iteration": 451, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-36-09", "timestamp": 1618148169, "time_this_iter_s": 20.953298807144165, "time_total_s": 9521.555191755295, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1650>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22b9a50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9521.555191755295, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 60.31666666666668, "ram_util_percent": 28.003333333333334}, "trial_id": "9be58_00000"}
{"episode_reward_max": 434.0, "episode_reward_min": 434.0, "episode_reward_mean": 434.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [434.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37766972448274344, "mean_raw_obs_processing_ms": 0.12429762848985985, "mean_inference_ms": 1.6313696822245407, "mean_action_processing_ms": 0.04635897590800946}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1808000, "timers": {"sample_time_ms": 8403.418, "sample_throughput": 475.997, "learn_time_ms": 12514.673, "learn_throughput": 319.625, "update_time_ms": 3.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 9.314090684056282, "policy_loss": -0.03247730963630602, "vf_loss": 9.333633452653885, "vf_explained_var": 0.637548565864563, "kl": 0.01912226778222248, "entropy": 0.12356852507218719, "entropy_coeff": 0.0}}, "num_steps_sampled": 1808000, "num_steps_trained": 1808000}, "done": false, "episodes_total": 180, "training_iteration": 452, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-36-29", "timestamp": 1618148189, "time_this_iter_s": 20.61319899559021, "time_total_s": 9542.168390750885, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e54d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338ad90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9542.168390750885, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 58.74, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1204.0, "episode_reward_min": 1204.0, "episode_reward_mean": 1204.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1204.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37632919246799934, "mean_raw_obs_processing_ms": 0.12460694662527078, "mean_inference_ms": 1.631461021804982, "mean_action_processing_ms": 0.04635968897165988}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1812000, "timers": {"sample_time_ms": 8384.149, "sample_throughput": 477.091, "learn_time_ms": 12537.174, "learn_throughput": 319.051, "update_time_ms": 3.235}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6764109619777331, "cur_lr": 5e-05, "total_loss": 9.318886876106262, "policy_loss": -0.010265099874231964, "vf_loss": 9.32671020925045, "vf_explained_var": 0.4214935004711151, "kl": 0.0036099636818107683, "entropy": 0.09222986246459186, "entropy_coeff": 0.0}}, "num_steps_sampled": 1812000, "num_steps_trained": 1812000}, "done": false, "episodes_total": 181, "training_iteration": 453, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-36-50", "timestamp": 1618148210, "time_this_iter_s": 20.991315841674805, "time_total_s": 9563.15970659256, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b4df10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c219a6d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9563.15970659256, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 60.35000000000001, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1204.0, "episode_reward_min": 1204.0, "episode_reward_mean": 1204.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1204.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37632919246799934, "mean_raw_obs_processing_ms": 0.12460694662527078, "mean_inference_ms": 1.631461021804982, "mean_action_processing_ms": 0.04635968897165988}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1816000, "timers": {"sample_time_ms": 8387.054, "sample_throughput": 476.926, "learn_time_ms": 12528.517, "learn_throughput": 319.272, "update_time_ms": 3.249}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33820548098886655, "cur_lr": 5e-05, "total_loss": 11.57680657505989, "policy_loss": -0.027633312507532537, "vf_loss": 11.601059094071388, "vf_explained_var": 0.3405175507068634, "kl": 0.009996024920837954, "entropy": 0.09585111739579588, "entropy_coeff": 0.0}}, "num_steps_sampled": 1816000, "num_steps_trained": 1816000}, "done": false, "episodes_total": 181, "training_iteration": 454, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-37-11", "timestamp": 1618148231, "time_this_iter_s": 20.67094874382019, "time_total_s": 9583.83065533638, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0e90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4d850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9583.83065533638, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 60.037931034482774, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1011.0, "episode_reward_min": 1011.0, "episode_reward_mean": 1011.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1011.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37550780196846506, "mean_raw_obs_processing_ms": 0.12482839029330255, "mean_inference_ms": 1.6315873835933747, "mean_action_processing_ms": 0.04636160627110049}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1820000, "timers": {"sample_time_ms": 8390.011, "sample_throughput": 476.757, "learn_time_ms": 12513.793, "learn_throughput": 319.647, "update_time_ms": 3.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.33820548098886655, "cur_lr": 5e-05, "total_loss": 8.660263612866402, "policy_loss": -0.09923468960914761, "vf_loss": 8.721250742673874, "vf_explained_var": 0.652334988117218, "kl": 0.11308962712064385, "entropy": 0.2420229958370328, "entropy_coeff": 0.0}}, "num_steps_sampled": 1820000, "num_steps_trained": 1820000}, "done": false, "episodes_total": 182, "training_iteration": 455, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-37-32", "timestamp": 1618148252, "time_this_iter_s": 20.82092595100403, "time_total_s": 9604.651581287384, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a0910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0210>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9604.651581287384, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 59.54666666666666, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1011.0, "episode_reward_min": 1011.0, "episode_reward_mean": 1011.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1011.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37550780196846506, "mean_raw_obs_processing_ms": 0.12482839029330255, "mean_inference_ms": 1.6315873835933747, "mean_action_processing_ms": 0.04636160627110049}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1824000, "timers": {"sample_time_ms": 8394.342, "sample_throughput": 476.511, "learn_time_ms": 12515.767, "learn_throughput": 319.597, "update_time_ms": 3.293}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5073082214832998, "cur_lr": 5e-05, "total_loss": 6.98646904528141, "policy_loss": -0.028212353761773556, "vf_loss": 7.008933007717133, "vf_explained_var": 0.27898961305618286, "kl": 0.011331084795529023, "entropy": 0.08715586410835385, "entropy_coeff": 0.0}}, "num_steps_sampled": 1824000, "num_steps_trained": 1824000}, "done": false, "episodes_total": 182, "training_iteration": 456, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-37-53", "timestamp": 1618148273, "time_this_iter_s": 20.896812438964844, "time_total_s": 9625.548393726349, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a02d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a0190>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9625.548393726349, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 59.779999999999994, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1011.0, "episode_reward_min": 1011.0, "episode_reward_mean": 1011.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1011.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37550780196846506, "mean_raw_obs_processing_ms": 0.12482839029330255, "mean_inference_ms": 1.6315873835933747, "mean_action_processing_ms": 0.04636160627110049}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1828000, "timers": {"sample_time_ms": 8408.932, "sample_throughput": 475.685, "learn_time_ms": 12496.876, "learn_throughput": 320.08, "update_time_ms": 3.288}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5073082214832998, "cur_lr": 5e-05, "total_loss": 9.91094595193863, "policy_loss": -0.10803090815898031, "vf_loss": 9.949727684259415, "vf_explained_var": 0.6372156739234924, "kl": 0.1365031294990331, "entropy": 0.31089993100613356, "entropy_coeff": 0.0}}, "num_steps_sampled": 1828000, "num_steps_trained": 1828000}, "done": false, "episodes_total": 182, "training_iteration": 457, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-38-14", "timestamp": 1618148294, "time_this_iter_s": 21.022359371185303, "time_total_s": 9646.570753097534, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a0bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c349bdd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9646.570753097534, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 59.47666666666667, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1370.0, "episode_reward_min": 1370.0, "episode_reward_mean": 1370.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1370.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37430110548617224, "mean_raw_obs_processing_ms": 0.12516784967397335, "mean_inference_ms": 1.6318645263166, "mean_action_processing_ms": 0.046372409145386824}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1832000, "timers": {"sample_time_ms": 8404.853, "sample_throughput": 475.916, "learn_time_ms": 12491.495, "learn_throughput": 320.218, "update_time_ms": 3.341}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7609623322249497, "cur_lr": 5e-05, "total_loss": 6.021953716874123, "policy_loss": -0.013491013465682045, "vf_loss": 6.031705364584923, "vf_explained_var": 0.3112790882587433, "kl": 0.00491391585819656, "entropy": 0.08096291206311435, "entropy_coeff": 0.0}}, "num_steps_sampled": 1832000, "num_steps_trained": 1832000}, "done": false, "episodes_total": 183, "training_iteration": 458, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-38-35", "timestamp": 1618148315, "time_this_iter_s": 20.88569927215576, "time_total_s": 9667.45645236969, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a01d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9667.45645236969, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 59.870000000000005, "ram_util_percent": 28.05}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1370.0, "episode_reward_min": 1370.0, "episode_reward_mean": 1370.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1370.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37430110548617224, "mean_raw_obs_processing_ms": 0.12516784967397335, "mean_inference_ms": 1.6318645263166, "mean_action_processing_ms": 0.046372409145386824}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1836000, "timers": {"sample_time_ms": 8422.367, "sample_throughput": 474.926, "learn_time_ms": 12512.035, "learn_throughput": 319.692, "update_time_ms": 3.246}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.38048116611247484, "cur_lr": 5e-05, "total_loss": 11.147466391324997, "policy_loss": -0.0472682165709557, "vf_loss": 11.168269157409668, "vf_explained_var": 0.49089038372039795, "kl": 0.06955815176479518, "entropy": 0.19037810852751136, "entropy_coeff": 0.0}}, "num_steps_sampled": 1836000, "num_steps_trained": 1836000}, "done": false, "episodes_total": 183, "training_iteration": 459, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-38-56", "timestamp": 1618148336, "time_this_iter_s": 21.31179428100586, "time_total_s": 9688.768246650696, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c221fbd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b4e810>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9688.768246650696, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 59.92333333333333, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1026.0, "episode_reward_min": 1026.0, "episode_reward_mean": 1026.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1026.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37368848630097734, "mean_raw_obs_processing_ms": 0.1254000725997497, "mean_inference_ms": 1.6320741658087397, "mean_action_processing_ms": 0.04637648314016426}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1840000, "timers": {"sample_time_ms": 8397.418, "sample_throughput": 476.337, "learn_time_ms": 12511.04, "learn_throughput": 319.718, "update_time_ms": 3.254}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5707217491687122, "cur_lr": 5e-05, "total_loss": 10.932187214493752, "policy_loss": -0.04915313987294212, "vf_loss": 10.962106496095657, "vf_explained_var": 0.5760692954063416, "kl": 0.03370081906905398, "entropy": 0.1327469910029322, "entropy_coeff": 0.0}}, "num_steps_sampled": 1840000, "num_steps_trained": 1840000}, "done": false, "episodes_total": 184, "training_iteration": 460, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-39-17", "timestamp": 1618148357, "time_this_iter_s": 21.02972984313965, "time_total_s": 9709.797976493835, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e5710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f4490>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9709.797976493835, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 60.73333333333333, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1026.0, "episode_reward_min": 1026.0, "episode_reward_mean": 1026.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1026.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37368848630097734, "mean_raw_obs_processing_ms": 0.1254000725997497, "mean_inference_ms": 1.6320741658087397, "mean_action_processing_ms": 0.04637648314016426}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1844000, "timers": {"sample_time_ms": 8378.415, "sample_throughput": 477.417, "learn_time_ms": 12499.729, "learn_throughput": 320.007, "update_time_ms": 3.257}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8560826237530683, "cur_lr": 5e-05, "total_loss": 9.283060744404793, "policy_loss": -0.019444400182692334, "vf_loss": 9.298528417944908, "vf_explained_var": 0.5870957970619202, "kl": 0.004645416776838829, "entropy": 0.08085005893371999, "entropy_coeff": 0.0}}, "num_steps_sampled": 1844000, "num_steps_trained": 1844000}, "done": false, "episodes_total": 184, "training_iteration": 461, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-39-38", "timestamp": 1618148378, "time_this_iter_s": 20.6504909992218, "time_total_s": 9730.448467493057, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e56d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9730.448467493057, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 59.68, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1026.0, "episode_reward_min": 1026.0, "episode_reward_mean": 1026.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1026.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37368848630097734, "mean_raw_obs_processing_ms": 0.1254000725997497, "mean_inference_ms": 1.6320741658087397, "mean_action_processing_ms": 0.04637648314016426}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1848000, "timers": {"sample_time_ms": 8375.807, "sample_throughput": 477.566, "learn_time_ms": 12495.415, "learn_throughput": 320.117, "update_time_ms": 3.299}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42804131187653416, "cur_lr": 5e-05, "total_loss": 5.5829232558608055, "policy_loss": -0.024566029955167323, "vf_loss": 5.6041426211595535, "vf_explained_var": 0.21136659383773804, "kl": 0.007818722835509107, "entropy": 0.0764811139088124, "entropy_coeff": 0.0}}, "num_steps_sampled": 1848000, "num_steps_trained": 1848000}, "done": false, "episodes_total": 184, "training_iteration": 462, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-39-58", "timestamp": 1618148398, "time_this_iter_s": 20.5450222492218, "time_total_s": 9750.993489742279, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0390>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e0950>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9750.993489742279, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 59.04827586206897, "ram_util_percent": 28.137931034482765}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1788.0, "episode_reward_min": 1788.0, "episode_reward_mean": 1788.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1788.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3723503151992464, "mean_raw_obs_processing_ms": 0.12571055478870963, "mean_inference_ms": 1.632130442549904, "mean_action_processing_ms": 0.04637574524987931}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1852000, "timers": {"sample_time_ms": 8385.204, "sample_throughput": 477.031, "learn_time_ms": 12456.018, "learn_throughput": 321.13, "update_time_ms": 3.296}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42804131187653416, "cur_lr": 5e-05, "total_loss": 4.22154425829649, "policy_loss": -0.030382815515622497, "vf_loss": 4.244981981813908, "vf_explained_var": 0.30753275752067566, "kl": 0.0162254644674249, "entropy": 0.0921301533235237, "entropy_coeff": 0.0}}, "num_steps_sampled": 1852000, "num_steps_trained": 1852000}, "done": false, "episodes_total": 185, "training_iteration": 463, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-40-19", "timestamp": 1618148419, "time_this_iter_s": 20.693961143493652, "time_total_s": 9771.687450885773, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a06d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b7fd1890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9771.687450885773, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 59.79666666666666, "ram_util_percent": 28.130000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1788.0, "episode_reward_min": 1788.0, "episode_reward_mean": 1788.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1788.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3723503151992464, "mean_raw_obs_processing_ms": 0.12571055478870963, "mean_inference_ms": 1.632130442549904, "mean_action_processing_ms": 0.04637574524987931}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1856000, "timers": {"sample_time_ms": 8413.689, "sample_throughput": 475.416, "learn_time_ms": 12471.032, "learn_throughput": 320.743, "update_time_ms": 3.29}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.42804131187653416, "cur_lr": 5e-05, "total_loss": 10.723410665988922, "policy_loss": -0.09332915794220753, "vf_loss": 10.773951679468155, "vf_explained_var": 0.6185283660888672, "kl": 0.09996264008805156, "entropy": 0.23993412218987942, "entropy_coeff": 0.0}}, "num_steps_sampled": 1856000, "num_steps_trained": 1856000}, "done": false, "episodes_total": 185, "training_iteration": 464, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-40-40", "timestamp": 1618148440, "time_this_iter_s": 21.103120803833008, "time_total_s": 9792.790571689606, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0510>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9792.790571689606, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 60.470000000000006, "ram_util_percent": 28.14666666666668}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1488.0, "episode_reward_min": 1488.0, "episode_reward_mean": 1488.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1488.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3715872817718826, "mean_raw_obs_processing_ms": 0.1259211336218523, "mean_inference_ms": 1.6322220909934344, "mean_action_processing_ms": 0.046376688952352155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1860000, "timers": {"sample_time_ms": 8383.546, "sample_throughput": 477.125, "learn_time_ms": 12494.015, "learn_throughput": 320.153, "update_time_ms": 3.291}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6420619678148012, "cur_lr": 5e-05, "total_loss": 5.393851608037949, "policy_loss": -0.014667720504803583, "vf_loss": 5.406009078025818, "vf_explained_var": 0.28933632373809814, "kl": 0.0039096287910069805, "entropy": 0.06595502072013915, "entropy_coeff": 0.0}}, "num_steps_sampled": 1860000, "num_steps_trained": 1860000}, "done": false, "episodes_total": 186, "training_iteration": 465, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-41-01", "timestamp": 1618148461, "time_this_iter_s": 20.740543127059937, "time_total_s": 9813.531114816666, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a0bd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9813.531114816666, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 60.068965517241374, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1488.0, "episode_reward_min": 1488.0, "episode_reward_mean": 1488.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1488.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3715872817718826, "mean_raw_obs_processing_ms": 0.1259211336218523, "mean_inference_ms": 1.6322220909934344, "mean_action_processing_ms": 0.046376688952352155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1864000, "timers": {"sample_time_ms": 8356.531, "sample_throughput": 478.668, "learn_time_ms": 12470.031, "learn_throughput": 320.769, "update_time_ms": 3.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3210309839074006, "cur_lr": 5e-05, "total_loss": 6.037256807088852, "policy_loss": -0.027270357706584036, "vf_loss": 6.062300801277161, "vf_explained_var": 0.2857445776462555, "kl": 0.006935457240615506, "entropy": 0.06681748054688796, "entropy_coeff": 0.0}}, "num_steps_sampled": 1864000, "num_steps_trained": 1864000}, "done": false, "episodes_total": 186, "training_iteration": 466, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-41-21", "timestamp": 1618148481, "time_this_iter_s": 20.38385319709778, "time_total_s": 9833.914968013763, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5290>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9833.914968013763, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 58.95172413793103, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1488.0, "episode_reward_min": 1488.0, "episode_reward_mean": 1488.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1488.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3715872817718826, "mean_raw_obs_processing_ms": 0.1259211336218523, "mean_inference_ms": 1.6322220909934344, "mean_action_processing_ms": 0.046376688952352155}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1868000, "timers": {"sample_time_ms": 8329.093, "sample_throughput": 480.244, "learn_time_ms": 12454.457, "learn_throughput": 321.17, "update_time_ms": 3.138}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3210309839074006, "cur_lr": 5e-05, "total_loss": 4.633081138134003, "policy_loss": -0.02359147457173094, "vf_loss": 4.654115259647369, "vf_explained_var": 0.26660192012786865, "kl": 0.007965946926560719, "entropy": 0.07421558501664549, "entropy_coeff": 0.0}}, "num_steps_sampled": 1868000, "num_steps_trained": 1868000}, "done": false, "episodes_total": 186, "training_iteration": 467, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-41-42", "timestamp": 1618148502, "time_this_iter_s": 20.591224431991577, "time_total_s": 9854.506192445755, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a7d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a6bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9854.506192445755, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 59.79666666666667, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1804.0, "episode_reward_min": 1804.0, "episode_reward_mean": 1804.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1804.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.370485716150138, "mean_raw_obs_processing_ms": 0.1262368335077325, "mean_inference_ms": 1.632338844618565, "mean_action_processing_ms": 0.046377455892579585}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1872000, "timers": {"sample_time_ms": 8360.829, "sample_throughput": 478.421, "learn_time_ms": 12460.01, "learn_throughput": 321.027, "update_time_ms": 3.155}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3210309839074006, "cur_lr": 5e-05, "total_loss": 10.023785069584846, "policy_loss": -0.08212896733311936, "vf_loss": 10.085798040032387, "vf_explained_var": 0.5817726850509644, "kl": 0.06266098818741739, "entropy": 0.169802725315094, "entropy_coeff": 0.0}}, "num_steps_sampled": 1872000, "num_steps_trained": 1872000}, "done": false, "episodes_total": 187, "training_iteration": 468, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-42-03", "timestamp": 1618148523, "time_this_iter_s": 21.254968404769897, "time_total_s": 9875.761160850525, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219ae90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9b90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9875.761160850525, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 60.56333333333334, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1804.0, "episode_reward_min": 1804.0, "episode_reward_mean": 1804.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1804.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.370485716150138, "mean_raw_obs_processing_ms": 0.1262368335077325, "mean_inference_ms": 1.632338844618565, "mean_action_processing_ms": 0.046377455892579585}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1876000, "timers": {"sample_time_ms": 8409.407, "sample_throughput": 475.658, "learn_time_ms": 12449.701, "learn_throughput": 321.293, "update_time_ms": 3.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4815464758611009, "cur_lr": 5e-05, "total_loss": 10.001246824860573, "policy_loss": -0.036767392040928826, "vf_loss": 10.032413080334663, "vf_explained_var": 0.5017814636230469, "kl": 0.011631170913460664, "entropy": 0.10233868518844247, "entropy_coeff": 0.0}}, "num_steps_sampled": 1876000, "num_steps_trained": 1876000}, "done": false, "episodes_total": 187, "training_iteration": 469, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-42-25", "timestamp": 1618148545, "time_this_iter_s": 21.694373846054077, "time_total_s": 9897.455534696579, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162fd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f24d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9897.455534696579, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 59.409677419354836, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37044224653505314, "mean_raw_obs_processing_ms": 0.12645549845279494, "mean_inference_ms": 1.6324830344217736, "mean_action_processing_ms": 0.04638026159711129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1880000, "timers": {"sample_time_ms": 8450.354, "sample_throughput": 473.353, "learn_time_ms": 12445.73, "learn_throughput": 321.395, "update_time_ms": 3.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4815464758611009, "cur_lr": 5e-05, "total_loss": 12.950585156679153, "policy_loss": -0.07819453935371712, "vf_loss": 12.987747997045517, "vf_explained_var": 0.5063730478286743, "kl": 0.08520832716021687, "entropy": 0.24028623243793845, "entropy_coeff": 0.0}}, "num_steps_sampled": 1880000, "num_steps_trained": 1880000}, "done": false, "episodes_total": 188, "training_iteration": 470, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-42-46", "timestamp": 1618148566, "time_this_iter_s": 21.405193090438843, "time_total_s": 9918.860727787018, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222df50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162cd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9918.860727787018, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 59.65483870967743, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37044224653505314, "mean_raw_obs_processing_ms": 0.12645549845279494, "mean_inference_ms": 1.6324830344217736, "mean_action_processing_ms": 0.04638026159711129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1884000, "timers": {"sample_time_ms": 8478.237, "sample_throughput": 471.796, "learn_time_ms": 12449.037, "learn_throughput": 321.31, "update_time_ms": 3.132}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.7223197137916513, "cur_lr": 5e-05, "total_loss": 5.257115617394447, "policy_loss": -0.004657634242903441, "vf_loss": 5.260371208190918, "vf_explained_var": 0.4656692445278168, "kl": 0.0019410086715652142, "entropy": 0.029674740508198738, "entropy_coeff": 0.0}}, "num_steps_sampled": 1884000, "num_steps_trained": 1884000}, "done": false, "episodes_total": 188, "training_iteration": 471, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-43-07", "timestamp": 1618148587, "time_this_iter_s": 20.959891080856323, "time_total_s": 9939.820618867874, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162190>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c21a6e50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9939.820618867874, "timesteps_since_restore": 0, "iterations_since_restore": 471, "perf": {"cpu_util_percent": 59.806666666666665, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37044224653505314, "mean_raw_obs_processing_ms": 0.12645549845279494, "mean_inference_ms": 1.6324830344217736, "mean_action_processing_ms": 0.04638026159711129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1888000, "timers": {"sample_time_ms": 8486.055, "sample_throughput": 471.362, "learn_time_ms": 12458.132, "learn_throughput": 321.075, "update_time_ms": 3.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.36115985689582564, "cur_lr": 5e-05, "total_loss": 8.655928328633308, "policy_loss": -0.0912077595712617, "vf_loss": 8.720491528511047, "vf_explained_var": 0.7141908407211304, "kl": 0.07377510541118681, "entropy": 0.19434051727876067, "entropy_coeff": 0.0}}, "num_steps_sampled": 1888000, "num_steps_trained": 1888000}, "done": false, "episodes_total": 188, "training_iteration": 472, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-43-28", "timestamp": 1618148608, "time_this_iter_s": 20.71218514442444, "time_total_s": 9960.532804012299, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22dcfd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162450>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9960.532804012299, "timesteps_since_restore": 0, "iterations_since_restore": 472, "perf": {"cpu_util_percent": 59.593103448275855, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 972.0, "episode_reward_min": 972.0, "episode_reward_mean": 972.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [972.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3693808010598102, "mean_raw_obs_processing_ms": 0.12676741410245956, "mean_inference_ms": 1.6324806700901797, "mean_action_processing_ms": 0.046377698094577084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1892000, "timers": {"sample_time_ms": 8484.566, "sample_throughput": 471.444, "learn_time_ms": 12447.118, "learn_throughput": 321.36, "update_time_ms": 3.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5417397853437385, "cur_lr": 5e-05, "total_loss": 8.145137295126915, "policy_loss": -0.0751681323745288, "vf_loss": 8.179201617836952, "vf_explained_var": 0.7902489304542542, "kl": 0.07587356877047569, "entropy": 0.17359666037373245, "entropy_coeff": 0.0}}, "num_steps_sampled": 1892000, "num_steps_trained": 1892000}, "done": false, "episodes_total": 189, "training_iteration": 473, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-43-49", "timestamp": 1618148629, "time_this_iter_s": 20.56989026069641, "time_total_s": 9981.102694272995, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280110>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9981.102694272995, "timesteps_since_restore": 0, "iterations_since_restore": 473, "perf": {"cpu_util_percent": 60.03, "ram_util_percent": 28.13333333333334}, "trial_id": "9be58_00000"}
{"episode_reward_max": 972.0, "episode_reward_min": 972.0, "episode_reward_mean": 972.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [972.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3693808010598102, "mean_raw_obs_processing_ms": 0.12676741410245956, "mean_inference_ms": 1.6324806700901797, "mean_action_processing_ms": 0.046377698094577084}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1896000, "timers": {"sample_time_ms": 8449.71, "sample_throughput": 473.389, "learn_time_ms": 12434.166, "learn_throughput": 321.694, "update_time_ms": 3.12}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.8126096780156077, "cur_lr": 5e-05, "total_loss": 9.651490196585655, "policy_loss": -0.011302686558337882, "vf_loss": 9.659363180398941, "vf_explained_var": 0.40641260147094727, "kl": 0.004220483999233693, "entropy": 0.07760245446115732, "entropy_coeff": 0.0}}, "num_steps_sampled": 1896000, "num_steps_trained": 1896000}, "done": false, "episodes_total": 189, "training_iteration": 474, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-44-09", "timestamp": 1618148649, "time_this_iter_s": 20.629332304000854, "time_total_s": 10001.732026576996, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2250>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162bd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10001.732026576996, "timesteps_since_restore": 0, "iterations_since_restore": 474, "perf": {"cpu_util_percent": 60.04827586206897, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1182.0, "episode_reward_min": 1182.0, "episode_reward_mean": 1182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3685518056695947, "mean_raw_obs_processing_ms": 0.1269670065405214, "mean_inference_ms": 1.6324887097316132, "mean_action_processing_ms": 0.046375994366718756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1900000, "timers": {"sample_time_ms": 8450.448, "sample_throughput": 473.348, "learn_time_ms": 12407.116, "learn_throughput": 322.396, "update_time_ms": 3.176}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.40630483900780384, "cur_lr": 5e-05, "total_loss": 10.892416760325432, "policy_loss": -0.06443530213437043, "vf_loss": 10.934934481978416, "vf_explained_var": 0.530601978302002, "kl": 0.053944097249768674, "entropy": 0.14731455291621387, "entropy_coeff": 0.0}}, "num_steps_sampled": 1900000, "num_steps_trained": 1900000}, "done": false, "episodes_total": 190, "training_iteration": 475, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-44-30", "timestamp": 1618148670, "time_this_iter_s": 20.480616331100464, "time_total_s": 10022.212642908096, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9150>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcb50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10022.212642908096, "timesteps_since_restore": 0, "iterations_since_restore": 475, "perf": {"cpu_util_percent": 58.765517241379314, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1182.0, "episode_reward_min": 1182.0, "episode_reward_mean": 1182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3685518056695947, "mean_raw_obs_processing_ms": 0.1269670065405214, "mean_inference_ms": 1.6324887097316132, "mean_action_processing_ms": 0.046375994366718756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1904000, "timers": {"sample_time_ms": 8557.528, "sample_throughput": 467.425, "learn_time_ms": 12419.51, "learn_throughput": 322.074, "update_time_ms": 3.22}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6094572585117057, "cur_lr": 5e-05, "total_loss": 10.73191998898983, "policy_loss": -0.023254234343767166, "vf_loss": 10.749308779835701, "vf_explained_var": 0.3876452147960663, "kl": 0.00962432415690273, "entropy": 0.09828267875127494, "entropy_coeff": 0.0}}, "num_steps_sampled": 1904000, "num_steps_trained": 1904000}, "done": false, "episodes_total": 190, "training_iteration": 476, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-44-52", "timestamp": 1618148692, "time_this_iter_s": 21.581257820129395, "time_total_s": 10043.793900728226, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d9910>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338ad50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10043.793900728226, "timesteps_since_restore": 0, "iterations_since_restore": 476, "perf": {"cpu_util_percent": 59.364516129032246, "ram_util_percent": 28.10000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1182.0, "episode_reward_min": 1182.0, "episode_reward_mean": 1182.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1182.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3685518056695947, "mean_raw_obs_processing_ms": 0.1269670065405214, "mean_inference_ms": 1.6324887097316132, "mean_action_processing_ms": 0.046375994366718756}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1908000, "timers": {"sample_time_ms": 8587.999, "sample_throughput": 465.766, "learn_time_ms": 12430.22, "learn_throughput": 321.796, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6094572585117057, "cur_lr": 5e-05, "total_loss": 11.21497431397438, "policy_loss": 0.00502397253876552, "vf_loss": 11.209748297929764, "vf_explained_var": 0.010804999619722366, "kl": 0.0003315309440168335, "entropy": 0.003346359384522657, "entropy_coeff": 0.0}}, "num_steps_sampled": 1908000, "num_steps_trained": 1908000}, "done": false, "episodes_total": 190, "training_iteration": 477, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-45-13", "timestamp": 1618148713, "time_this_iter_s": 21.00428581237793, "time_total_s": 10064.798186540604, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a16d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d9890>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10064.798186540604, "timesteps_since_restore": 0, "iterations_since_restore": 477, "perf": {"cpu_util_percent": 60.77, "ram_util_percent": 28.18333333333334}, "trial_id": "9be58_00000"}
{"episode_reward_max": 478.0, "episode_reward_min": 478.0, "episode_reward_mean": 478.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3679246256306918, "mean_raw_obs_processing_ms": 0.1273027074952685, "mean_inference_ms": 1.6327107359069697, "mean_action_processing_ms": 0.046381489809329005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1912000, "timers": {"sample_time_ms": 8561.413, "sample_throughput": 467.213, "learn_time_ms": 12418.66, "learn_throughput": 322.096, "update_time_ms": 3.233}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30472862925585287, "cur_lr": 5e-05, "total_loss": 2.273838270455599, "policy_loss": 0.004845107672736049, "vf_loss": 2.2689932584762573, "vf_explained_var": -0.000800030305981636, "kl": -2.475111646749184e-07, "entropy": 0.0010213781097263563, "entropy_coeff": 0.0}}, "num_steps_sampled": 1912000, "num_steps_trained": 1912000}, "done": false, "episodes_total": 191, "training_iteration": 478, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-45-33", "timestamp": 1618148733, "time_this_iter_s": 20.875952005386353, "time_total_s": 10085.67413854599, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22e0610>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10085.67413854599, "timesteps_since_restore": 0, "iterations_since_restore": 478, "perf": {"cpu_util_percent": 59.669999999999995, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 478.0, "episode_reward_min": 478.0, "episode_reward_mean": 478.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3679246256306918, "mean_raw_obs_processing_ms": 0.1273027074952685, "mean_inference_ms": 1.6327107359069697, "mean_action_processing_ms": 0.046381489809329005}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1916000, "timers": {"sample_time_ms": 8463.382, "sample_throughput": 472.624, "learn_time_ms": 12421.601, "learn_throughput": 322.02, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15236431462792643, "cur_lr": 5e-05, "total_loss": 0.4069368224591017, "policy_loss": 0.0008320722845382988, "vf_loss": 0.40610391180962324, "vf_explained_var": -0.003404896706342697, "kl": 5.506830717649791e-06, "entropy": 0.00126090057528927, "entropy_coeff": 0.0}}, "num_steps_sampled": 1916000, "num_steps_trained": 1916000}, "done": false, "episodes_total": 191, "training_iteration": 479, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-45-54", "timestamp": 1618148754, "time_this_iter_s": 20.746930360794067, "time_total_s": 10106.421068906784, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2b3d750>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10106.421068906784, "timesteps_since_restore": 0, "iterations_since_restore": 479, "perf": {"cpu_util_percent": 59.77666666666667, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36721425438818633, "mean_raw_obs_processing_ms": 0.12751132612163013, "mean_inference_ms": 1.6327593158571758, "mean_action_processing_ms": 0.04638085793263987}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1920000, "timers": {"sample_time_ms": 8412.209, "sample_throughput": 475.499, "learn_time_ms": 12421.35, "learn_throughput": 322.026, "update_time_ms": 3.416}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.07618215731396322, "cur_lr": 5e-05, "total_loss": 0.07352384380646981, "policy_loss": -0.003252594673540443, "vf_loss": 0.0767736213747412, "vf_explained_var": -0.0022884663194417953, "kl": 3.696057706292777e-05, "entropy": 0.0021428810941870324, "entropy_coeff": 0.0}}, "num_steps_sampled": 1920000, "num_steps_trained": 1920000}, "done": false, "episodes_total": 192, "training_iteration": 480, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-46-15", "timestamp": 1618148775, "time_this_iter_s": 20.886568307876587, "time_total_s": 10127.30763721466, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219afd0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d410>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10127.30763721466, "timesteps_since_restore": 0, "iterations_since_restore": 480, "perf": {"cpu_util_percent": 58.96551724137931, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36721425438818633, "mean_raw_obs_processing_ms": 0.12751132612163013, "mean_inference_ms": 1.6327593158571758, "mean_action_processing_ms": 0.04638085793263987}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1924000, "timers": {"sample_time_ms": 8417.964, "sample_throughput": 475.174, "learn_time_ms": 12407.479, "learn_throughput": 322.386, "update_time_ms": 3.323}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03809107865698161, "cur_lr": 5e-05, "total_loss": -0.004789897328009829, "policy_loss": -0.02364783367374912, "vf_loss": 0.012228094434249215, "vf_explained_var": -0.0012885034084320068, "kl": 0.1740523292683065, "entropy": 0.31712700705975294, "entropy_coeff": 0.0}}, "num_steps_sampled": 1924000, "num_steps_trained": 1924000}, "done": false, "episodes_total": 192, "training_iteration": 481, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-46-36", "timestamp": 1618148796, "time_this_iter_s": 20.877919673919678, "time_total_s": 10148.18555688858, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21b7550>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c219aa50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10148.18555688858, "timesteps_since_restore": 0, "iterations_since_restore": 481, "perf": {"cpu_util_percent": 60.44333333333332, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36721425438818633, "mean_raw_obs_processing_ms": 0.12751132612163013, "mean_inference_ms": 1.6327593158571758, "mean_action_processing_ms": 0.04638085793263987}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1928000, "timers": {"sample_time_ms": 8456.796, "sample_throughput": 472.992, "learn_time_ms": 12401.508, "learn_throughput": 322.541, "update_time_ms": 3.36}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05713661798547241, "cur_lr": 5e-05, "total_loss": 10.728942796587944, "policy_loss": -0.02951575900078751, "vf_loss": 10.75690644979477, "vf_explained_var": 0.4004916548728943, "kl": 0.02716216555563733, "entropy": 0.09280926105566323, "entropy_coeff": 0.0}}, "num_steps_sampled": 1928000, "num_steps_trained": 1928000}, "done": false, "episodes_total": 192, "training_iteration": 482, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-46-57", "timestamp": 1618148817, "time_this_iter_s": 21.041271448135376, "time_total_s": 10169.226828336716, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c33a9710>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dcc90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10169.226828336716, "timesteps_since_restore": 0, "iterations_since_restore": 482, "perf": {"cpu_util_percent": 60.80999999999999, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 792.0, "episode_reward_min": 792.0, "episode_reward_mean": 792.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [792.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3661114155650663, "mean_raw_obs_processing_ms": 0.1278348082368113, "mean_inference_ms": 1.6330728312945626, "mean_action_processing_ms": 0.04638350941052113}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1932000, "timers": {"sample_time_ms": 8464.047, "sample_throughput": 472.587, "learn_time_ms": 12420.316, "learn_throughput": 322.053, "update_time_ms": 3.339}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08570492697820861, "cur_lr": 5e-05, "total_loss": 7.507800295948982, "policy_loss": -0.020496618002653122, "vf_loss": 7.526999071240425, "vf_explained_var": 0.49174338579177856, "kl": 0.015143989759963006, "entropy": 0.07818194746505469, "entropy_coeff": 0.0}}, "num_steps_sampled": 1932000, "num_steps_trained": 1932000}, "done": false, "episodes_total": 193, "training_iteration": 483, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-47-18", "timestamp": 1618148838, "time_this_iter_s": 20.82621955871582, "time_total_s": 10190.053047895432, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2280a90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22dc150>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10190.053047895432, "timesteps_since_restore": 0, "iterations_since_restore": 483, "perf": {"cpu_util_percent": 59.99, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 792.0, "episode_reward_min": 792.0, "episode_reward_mean": 792.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [792.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3661114155650663, "mean_raw_obs_processing_ms": 0.1278348082368113, "mean_inference_ms": 1.6330728312945626, "mean_action_processing_ms": 0.04638350941052113}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1936000, "timers": {"sample_time_ms": 8591.9, "sample_throughput": 465.555, "learn_time_ms": 12433.108, "learn_throughput": 321.722, "update_time_ms": 3.362}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.08570492697820861, "cur_lr": 5e-05, "total_loss": 10.157876938581467, "policy_loss": -0.08297273691277951, "vf_loss": 10.235261857509613, "vf_explained_var": 0.5274893045425415, "kl": 0.06519525265321136, "entropy": 0.1389443688094616, "entropy_coeff": 0.0}}, "num_steps_sampled": 1936000, "num_steps_trained": 1936000}, "done": false, "episodes_total": 193, "training_iteration": 484, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-47-40", "timestamp": 1618148860, "time_this_iter_s": 22.032975673675537, "time_total_s": 10212.086023569107, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca210>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2280510>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10212.086023569107, "timesteps_since_restore": 0, "iterations_since_restore": 484, "perf": {"cpu_util_percent": 59.203125, "ram_util_percent": 28.228125}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1615.0, "episode_reward_min": 1615.0, "episode_reward_mean": 1615.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1615.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3677018967788814, "mean_raw_obs_processing_ms": 0.12804818988177763, "mean_inference_ms": 1.633171177154177, "mean_action_processing_ms": 0.04638637506365057}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1940000, "timers": {"sample_time_ms": 8950.903, "sample_throughput": 446.882, "learn_time_ms": 12432.727, "learn_throughput": 321.732, "update_time_ms": 3.312}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1285573904673129, "cur_lr": 5e-05, "total_loss": 6.840110495686531, "policy_loss": -0.024339354946278036, "vf_loss": 6.862891063094139, "vf_explained_var": 0.29629436135292053, "kl": 0.012125380744691938, "entropy": 0.0768478304380551, "entropy_coeff": 0.0}}, "num_steps_sampled": 1940000, "num_steps_trained": 1940000}, "done": false, "episodes_total": 194, "training_iteration": 485, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-48-04", "timestamp": 1618148884, "time_this_iter_s": 24.06586194038391, "time_total_s": 10236.151885509491, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22ca1d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e4d50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10236.151885509491, "timesteps_since_restore": 0, "iterations_since_restore": 485, "perf": {"cpu_util_percent": 59.29705882352941, "ram_util_percent": 28.229411764705883}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1615.0, "episode_reward_min": 1615.0, "episode_reward_mean": 1615.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1615.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3677018967788814, "mean_raw_obs_processing_ms": 0.12804818988177763, "mean_inference_ms": 1.633171177154177, "mean_action_processing_ms": 0.04638637506365057}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1944000, "timers": {"sample_time_ms": 8999.105, "sample_throughput": 444.489, "learn_time_ms": 12442.367, "learn_throughput": 321.482, "update_time_ms": 3.269}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1285573904673129, "cur_lr": 5e-05, "total_loss": 9.01916877925396, "policy_loss": -0.030049139284528792, "vf_loss": 9.04617327451706, "vf_explained_var": 0.42534399032592773, "kl": 0.02368386517628096, "entropy": 0.10522755410056561, "entropy_coeff": 0.0}}, "num_steps_sampled": 1944000, "num_steps_trained": 1944000}, "done": false, "episodes_total": 194, "training_iteration": 486, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-48-26", "timestamp": 1618148906, "time_this_iter_s": 22.15998077392578, "time_total_s": 10258.311866283417, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6050>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22cacd0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10258.311866283417, "timesteps_since_restore": 0, "iterations_since_restore": 486, "perf": {"cpu_util_percent": 59.578125, "ram_util_percent": 28.259375}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1615.0, "episode_reward_min": 1615.0, "episode_reward_mean": 1615.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1615.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3677018967788814, "mean_raw_obs_processing_ms": 0.12804818988177763, "mean_inference_ms": 1.633171177154177, "mean_action_processing_ms": 0.04638637506365057}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1948000, "timers": {"sample_time_ms": 9032.455, "sample_throughput": 442.847, "learn_time_ms": 12450.842, "learn_throughput": 321.263, "update_time_ms": 3.276}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19283608570096936, "cur_lr": 5e-05, "total_loss": 13.48047399520874, "policy_loss": -0.08021958326571621, "vf_loss": 13.544687360525131, "vf_explained_var": 0.42326581478118896, "kl": 0.08300468581728637, "entropy": 0.21206825273111463, "entropy_coeff": 0.0}}, "num_steps_sampled": 1948000, "num_steps_trained": 1948000}, "done": false, "episodes_total": 194, "training_iteration": 487, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-48-48", "timestamp": 1618148928, "time_this_iter_s": 21.423128604888916, "time_total_s": 10279.734994888306, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c21a6e50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc6b68c7c50>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10279.734994888306, "timesteps_since_restore": 0, "iterations_since_restore": 487, "perf": {"cpu_util_percent": 59.82333333333334, "ram_util_percent": 28.200000000000006}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1309.0, "episode_reward_min": 1309.0, "episode_reward_mean": 1309.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1309.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36805344974798543, "mean_raw_obs_processing_ms": 0.12837821667100713, "mean_inference_ms": 1.6334148164120001, "mean_action_processing_ms": 0.04639460334608418}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1952000, "timers": {"sample_time_ms": 9147.304, "sample_throughput": 437.287, "learn_time_ms": 12448.36, "learn_throughput": 321.327, "update_time_ms": 3.225}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.28925412855145405, "cur_lr": 5e-05, "total_loss": 9.235850244760513, "policy_loss": -0.028032917995005846, "vf_loss": 9.260290652513504, "vf_explained_var": 0.476846307516098, "kl": 0.01241970423143357, "entropy": 0.09856215363834053, "entropy_coeff": 0.0}}, "num_steps_sampled": 1952000, "num_steps_trained": 1952000}, "done": false, "episodes_total": 195, "training_iteration": 488, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-49-10", "timestamp": 1618148950, "time_this_iter_s": 21.998133182525635, "time_total_s": 10301.733128070831, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2b3de10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22cab10>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10301.733128070831, "timesteps_since_restore": 0, "iterations_since_restore": 488, "perf": {"cpu_util_percent": 59.606249999999996, "ram_util_percent": 28.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1309.0, "episode_reward_min": 1309.0, "episode_reward_mean": 1309.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1309.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36805344974798543, "mean_raw_obs_processing_ms": 0.12837821667100713, "mean_inference_ms": 1.6334148164120001, "mean_action_processing_ms": 0.04639460334608418}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1956000, "timers": {"sample_time_ms": 9270.718, "sample_throughput": 431.466, "learn_time_ms": 12450.645, "learn_throughput": 321.269, "update_time_ms": 3.241}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.28925412855145405, "cur_lr": 5e-05, "total_loss": 11.050441086292267, "policy_loss": -0.10655390622559935, "vf_loss": 11.120717465877533, "vf_explained_var": 0.5055110454559326, "kl": 0.1254171363543719, "entropy": 0.26488833082839847, "entropy_coeff": 0.0}}, "num_steps_sampled": 1956000, "num_steps_trained": 1956000}, "done": false, "episodes_total": 195, "training_iteration": 489, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-49-32", "timestamp": 1618148972, "time_this_iter_s": 22.001224040985107, "time_total_s": 10323.734352111816, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162f10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d07d0>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10323.734352111816, "timesteps_since_restore": 0, "iterations_since_restore": 489, "perf": {"cpu_util_percent": 60.32580645161289, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36840263748744845, "mean_raw_obs_processing_ms": 0.12860326798580113, "mean_inference_ms": 1.633557552143387, "mean_action_processing_ms": 0.04639934561532846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1960000, "timers": {"sample_time_ms": 9378.085, "sample_throughput": 426.526, "learn_time_ms": 12445.649, "learn_throughput": 321.397, "update_time_ms": 3.103}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4338811928271811, "cur_lr": 5e-05, "total_loss": 6.38105534017086, "policy_loss": -0.025277644279412925, "vf_loss": 6.402846172451973, "vf_explained_var": 0.3212428689002991, "kl": 0.00803643578547053, "entropy": 0.07651249680202454, "entropy_coeff": 0.0}}, "num_steps_sampled": 1960000, "num_steps_trained": 1960000}, "done": false, "episodes_total": 196, "training_iteration": 490, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-49-54", "timestamp": 1618148994, "time_this_iter_s": 21.906846523284912, "time_total_s": 10345.641198635101, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162690>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162250>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10345.641198635101, "timesteps_since_restore": 0, "iterations_since_restore": 490, "perf": {"cpu_util_percent": 59.49999999999999, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36840263748744845, "mean_raw_obs_processing_ms": 0.12860326798580113, "mean_inference_ms": 1.633557552143387, "mean_action_processing_ms": 0.04639934561532846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1964000, "timers": {"sample_time_ms": 9462.169, "sample_throughput": 422.736, "learn_time_ms": 12451.273, "learn_throughput": 321.252, "update_time_ms": 3.142}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.4338811928271811, "cur_lr": 5e-05, "total_loss": 8.951404854655266, "policy_loss": -0.032419130962807685, "vf_loss": 8.975036531686783, "vf_explained_var": 0.5708629488945007, "kl": 0.02025282141403295, "entropy": 0.09548880672082305, "entropy_coeff": 0.0}}, "num_steps_sampled": 1964000, "num_steps_trained": 1964000}, "done": false, "episodes_total": 196, "training_iteration": 491, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-50-16", "timestamp": 1618149016, "time_this_iter_s": 21.775084018707275, "time_total_s": 10367.416282653809, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2162c10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2162850>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10367.416282653809, "timesteps_since_restore": 0, "iterations_since_restore": 491, "perf": {"cpu_util_percent": 59.796774193548394, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1093.0, "episode_reward_min": 1093.0, "episode_reward_mean": 1093.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1093.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36840263748744845, "mean_raw_obs_processing_ms": 0.12860326798580113, "mean_inference_ms": 1.633557552143387, "mean_action_processing_ms": 0.04639934561532846}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1968000, "timers": {"sample_time_ms": 9476.117, "sample_throughput": 422.114, "learn_time_ms": 12457.28, "learn_throughput": 321.097, "update_time_ms": 3.13}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.6508217892407716, "cur_lr": 5e-05, "total_loss": 10.91576835513115, "policy_loss": -0.06476405047578737, "vf_loss": 10.949579447507858, "vf_explained_var": 0.4467288851737976, "kl": 0.04755986586678773, "entropy": 0.1607287572696805, "entropy_coeff": 0.0}}, "num_steps_sampled": 1968000, "num_steps_trained": 1968000}, "done": false, "episodes_total": 196, "training_iteration": 492, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-50-37", "timestamp": 1618149037, "time_this_iter_s": 21.24162006378174, "time_total_s": 10388.65790271759, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a1450>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302f90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10388.65790271759, "timesteps_since_restore": 0, "iterations_since_restore": 492, "perf": {"cpu_util_percent": 59.58709677419354, "ram_util_percent": 28.20000000000001}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1205.0, "episode_reward_min": 1205.0, "episode_reward_mean": 1205.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36837548451796404, "mean_raw_obs_processing_ms": 0.12894689337447127, "mean_inference_ms": 1.6338584120932658, "mean_action_processing_ms": 0.046406391106740955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1972000, "timers": {"sample_time_ms": 9593.855, "sample_throughput": 416.934, "learn_time_ms": 12479.455, "learn_throughput": 320.527, "update_time_ms": 3.159}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 9.72665984928608, "policy_loss": -0.02495304506737739, "vf_loss": 9.745987966656685, "vf_explained_var": 0.6223108768463135, "kl": 0.005761651082138997, "entropy": 0.08849322376772761, "entropy_coeff": 0.0}}, "num_steps_sampled": 1972000, "num_steps_trained": 1972000}, "done": false, "episodes_total": 197, "training_iteration": 493, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-50-59", "timestamp": 1618149059, "time_this_iter_s": 22.229472398757935, "time_total_s": 10410.887375116348, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22a17d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22d0610>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10410.887375116348, "timesteps_since_restore": 0, "iterations_since_restore": 493, "perf": {"cpu_util_percent": 60.153125, "ram_util_percent": 28.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1205.0, "episode_reward_min": 1205.0, "episode_reward_mean": 1205.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1205.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.36837548451796404, "mean_raw_obs_processing_ms": 0.12894689337447127, "mean_inference_ms": 1.6338584120932658, "mean_action_processing_ms": 0.046406391106740955}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1976000, "timers": {"sample_time_ms": 9800.315, "sample_throughput": 408.15, "learn_time_ms": 12475.26, "learn_throughput": 320.635, "update_time_ms": 3.149}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 8.089424267411232, "policy_loss": -0.026876472984440625, "vf_loss": 8.110743805766106, "vf_explained_var": 0.4808623194694519, "kl": 0.005692253515007906, "entropy": 0.08565462962724268, "entropy_coeff": 0.0}}, "num_steps_sampled": 1976000, "num_steps_trained": 1976000}, "done": false, "episodes_total": 197, "training_iteration": 494, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-51-23", "timestamp": 1618149083, "time_this_iter_s": 24.057597637176514, "time_total_s": 10434.944972753525, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c2302f90>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c338a090>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10434.944972753525, "timesteps_since_restore": 0, "iterations_since_restore": 494, "perf": {"cpu_util_percent": 59.53823529411765, "ram_util_percent": 28.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3705772583757173, "mean_raw_obs_processing_ms": 0.1291623036372581, "mean_inference_ms": 1.6339345485010277, "mean_action_processing_ms": 0.04640839682071806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1980000, "timers": {"sample_time_ms": 9721.417, "sample_throughput": 411.463, "learn_time_ms": 12494.836, "learn_throughput": 320.132, "update_time_ms": 3.287}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 7.342990413308144, "policy_loss": -0.03144746946054511, "vf_loss": 7.366175532341003, "vf_explained_var": 0.34527087211608887, "kl": 0.008463623533316422, "entropy": 0.08112686884123832, "entropy_coeff": 0.0}}, "num_steps_sampled": 1980000, "num_steps_trained": 1980000}, "done": false, "episodes_total": 198, "training_iteration": 495, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-51-47", "timestamp": 1618149107, "time_this_iter_s": 23.475394010543823, "time_total_s": 10458.420366764069, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22f2810>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c2302790>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10458.420366764069, "timesteps_since_restore": 0, "iterations_since_restore": 495, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 28.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3705772583757173, "mean_raw_obs_processing_ms": 0.1291623036372581, "mean_inference_ms": 1.6339345485010277, "mean_action_processing_ms": 0.04640839682071806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1984000, "timers": {"sample_time_ms": 9905.828, "sample_throughput": 403.803, "learn_time_ms": 12488.854, "learn_throughput": 320.286, "update_time_ms": 3.375}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 7.887222111225128, "policy_loss": -0.03126629037433304, "vf_loss": 7.905855596065521, "vf_explained_var": 0.3292163610458374, "kl": 0.012940494612848852, "entropy": 0.09580604161601514, "entropy_coeff": 0.0}}, "num_steps_sampled": 1984000, "num_steps_trained": 1984000}, "done": false, "episodes_total": 198, "training_iteration": 496, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-52-11", "timestamp": 1618149131, "time_this_iter_s": 23.94815444946289, "time_total_s": 10482.368521213531, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222db10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10482.368521213531, "timesteps_since_restore": 0, "iterations_since_restore": 496, "perf": {"cpu_util_percent": 59.81428571428572, "ram_util_percent": 28.200000000000003}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1263.0, "episode_reward_min": 1263.0, "episode_reward_mean": 1263.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1263.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.3705772583757173, "mean_raw_obs_processing_ms": 0.1291623036372581, "mean_inference_ms": 1.6339345485010277, "mean_action_processing_ms": 0.04640839682071806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1988000, "timers": {"sample_time_ms": 10113.01, "sample_throughput": 395.53, "learn_time_ms": 12487.411, "learn_throughput": 320.323, "update_time_ms": 3.393}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 7.948706462979317, "policy_loss": -0.01871422433760017, "vf_loss": 7.961353808641434, "vf_explained_var": 0.2243068814277649, "kl": 0.006214536901097745, "entropy": 0.07610464876051992, "entropy_coeff": 0.0}}, "num_steps_sampled": 1988000, "num_steps_trained": 1988000}, "done": false, "episodes_total": 198, "training_iteration": 497, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-52-34", "timestamp": 1618149154, "time_this_iter_s": 23.47976040840149, "time_total_s": 10505.848281621933, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c219a310>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c222d310>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10505.848281621933, "timesteps_since_restore": 0, "iterations_since_restore": 497, "perf": {"cpu_util_percent": 59.74545454545454, "ram_util_percent": 28.2}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1530.0, "episode_reward_min": 1530.0, "episode_reward_mean": 1530.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37284741358160994, "mean_raw_obs_processing_ms": 0.12948327238155088, "mean_inference_ms": 1.6340583725940787, "mean_action_processing_ms": 0.046409930132316826}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1992000, "timers": {"sample_time_ms": 10085.282, "sample_throughput": 396.618, "learn_time_ms": 12493.542, "learn_throughput": 320.165, "update_time_ms": 3.405}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 7.703013718128204, "policy_loss": -0.01427667960524559, "vf_loss": 7.711667150259018, "vf_explained_var": 0.44331350922584534, "kl": 0.005760089035902638, "entropy": 0.0922371402848512, "entropy_coeff": 0.0}}, "num_steps_sampled": 1992000, "num_steps_trained": 1992000}, "done": false, "episodes_total": 199, "training_iteration": 498, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-52-56", "timestamp": 1618149176, "time_this_iter_s": 21.783071041107178, "time_total_s": 10527.63135266304, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c222de50>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22f2d90>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10527.63135266304, "timesteps_since_restore": 0, "iterations_since_restore": 498, "perf": {"cpu_util_percent": 59.80322580645161, "ram_util_percent": 28.264516129032245}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1530.0, "episode_reward_min": 1530.0, "episode_reward_mean": 1530.0, "episode_len_mean": 10000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37284741358160994, "mean_raw_obs_processing_ms": 0.12948327238155088, "mean_inference_ms": 1.6340583725940787, "mean_action_processing_ms": 0.046409930132316826}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 1996000, "timers": {"sample_time_ms": 9975.237, "sample_throughput": 400.993, "learn_time_ms": 12478.389, "learn_throughput": 320.554, "update_time_ms": 3.37}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 9.299293115735054, "policy_loss": -0.024042876437306404, "vf_loss": 9.318278282880783, "vf_explained_var": 0.4609466791152954, "kl": 0.005180709616979584, "entropy": 0.09014433959964663, "entropy_coeff": 0.0}}, "num_steps_sampled": 1996000, "num_steps_trained": 1996000}, "done": false, "episodes_total": 199, "training_iteration": 499, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-53-17", "timestamp": 1618149197, "time_this_iter_s": 20.75612497329712, "time_total_s": 10548.387477636337, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d2b10>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5690>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10548.387477636337, "timesteps_since_restore": 0, "iterations_since_restore": 499, "perf": {"cpu_util_percent": 59.88333333333333, "ram_util_percent": 28.299999999999994}, "trial_id": "9be58_00000"}
{"episode_reward_max": 1137.0, "episode_reward_min": 1137.0, "episode_reward_mean": 1137.0, "episode_len_mean": 10000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1137.0], "episode_lengths": [10000]}, "sampler_perf": {"mean_env_wait_ms": 0.37246073005038144, "mean_raw_obs_processing_ms": 0.12968623460012765, "mean_inference_ms": 1.6340640490339546, "mean_action_processing_ms": 0.046408899587031226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 2000000, "timers": {"sample_time_ms": 9912.889, "sample_throughput": 403.515, "learn_time_ms": 12491.705, "learn_throughput": 320.212, "update_time_ms": 3.34}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9762326838611575, "cur_lr": 5e-05, "total_loss": 7.355945274233818, "policy_loss": -0.04443760006688535, "vf_loss": 7.370066553354263, "vf_explained_var": 0.6362842917442322, "kl": 0.031054295104695484, "entropy": 0.1484136136714369, "entropy_coeff": 0.0}}, "num_steps_sampled": 2000000, "num_steps_trained": 2000000}, "done": true, "episodes_total": 200, "training_iteration": 500, "experiment_id": "d0517975b2294f17b02fc265a3bcc331", "date": "2021-04-11_13-53-38", "timestamp": 1618149218, "time_this_iter_s": 21.416754961013794, "time_total_s": 10569.804232597351, "pid": 713, "hostname": "4d02db151ac8", "node_ip": "172.28.0.2", "config": {"num_workers": 1, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 2], [512, [3, 3], 1]], "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 11, "grayscale": false, "zero_mean": true, "custom_model": "my_model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": 10000.0, "soft_horizon": true, "no_done_at_end": false, "env_config": {"reproducible_seed": 2, "sim_config": "<jbw.simulator.SimulatorConfig object at 0x7fc5c22d22d0>", "reward_fn": "<bound method cyclic_reward_schedule.reward of <custom_environments.cyclic_reward_schedule object at 0x7fc5c22e5550>>", "render": false}, "env": "JBW-cycle-1e6-v3", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 2, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10569.804232597351, "timesteps_since_restore": 0, "iterations_since_restore": 500, "perf": {"cpu_util_percent": 59.59032258064516, "ram_util_percent": 28.203225806451623}, "trial_id": "9be58_00000"}
